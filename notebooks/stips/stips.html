
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>STIPS Tutorial &#8212; STScI Roman Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/stips/stips';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="STPSF Tutorial" href="../stpsf/stpsf.html" />
    <link rel="prev" title="The Roman Interactive Sensitivity Tool (RIST)" href="../rist/rist.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI Roman Notebooks - Home"/>
    <script>document.write(`<img src="../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI Roman Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Nancy Grace Roman Space Telescope Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../data_discovery_and_access/data_discovery_and_access.html">Roman Research Nexus Data Discovery and Access in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_asdf/working_with_asdf.html">How to Open Roman Data Files (ASDF)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../romanisim/romanisim.html">Simulating WFI Imaging Data with Roman I-Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exposure_pipeline/exposure_pipeline.html">Calibrating WFI Exposures with RomanCal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ground_test_analysis/wfi_tvac_brightstar.html">Diving Into WFI TVAC Bright Star Test Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aperture_photometry/aperture_photometry.html">Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../measuring_galaxy_shapes/measuring_galaxy_shapes.html">Measuring Galaxy Shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../grism_spectral_extraction/grism_spectral_extraction.html">Roman Spectroscopy: Grism Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rist/rist.html">The Roman Interactive Sensitivity Tool (RIST)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">STIPS Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stpsf/stpsf.html">STPSF Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../synphot/synphot.html">Roman WFI Synthetic Photometry with synphot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pandeia/pandeia.html">Pandeia Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../footprint_visualization/footprint_visualization.html">Visualization of Roman APT products</a></li>

<li class="toctree-l1"><a class="reference internal" href="../background_visualization_tool/RBVT.html">The Roman Background Visualization Tool (RBVT)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/roman_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/roman_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/stips/stips.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/stips/stips.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>STIPS Tutorial</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-information-and-read-only-status">Kernel Information and Read-Only Status</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-report">Environment report</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-stips-usage">Basic STIPS Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-simple-astronomical-scene">Create a Simple Astronomical Scene</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-an-image">Simulate an Image</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-scenes-using-stips-built-in-functions">Generate Scenes Using STIPS Built-In Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-stellar-population">Create a Stellar Population</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-galactic-population">Create a Galactic Population</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-an-observation-first-pointing">Set up an Observation (First Pointing)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-an-observation-by-adding-a-second-pointing">Modify an Observation (by Adding a Second Pointing)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-an-artifical-point-source-to-an-observation">Add an Artifical Point Source to an Observation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="stips-tutorial">
<h1>STIPS Tutorial<a class="headerlink" href="#stips-tutorial" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<section id="kernel-information-and-read-only-status">
<h2>Kernel Information and Read-Only Status<a class="headerlink" href="#kernel-information-and-read-only-status" title="Link to this heading">#</a></h2>
<p>To run this notebook, please select the “Roman Calibration” kernel at the top right of your window.</p>
<p>This notebook is read-only. You can run cells and make edits, but you must save changes to a different location. We recommend saving the notebook within your home directory, or to a new folder within your home (e.g. <span style="font-variant:small-caps;">file &gt; save notebook as &gt; my-nbs/nb.ipynb</span>). Note that a directory must exist before you attempt to add a notebook to it.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p><strong>STIPS</strong>, or the Space Telescope Imaging Product Simulator, is a tool developed by STScI for simulating observations of astronomical scenes with the Roman Wide Field Instrument (WFI). Detailed documentation of the tool is available on the <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/stips-space-telescope-imaging-product-simulator">RDox pages</a>.</p>
<p>STIPS can generate images of the entire WFI array, which consists of 18 detectors, also called Sensor Chip Assemblies (SCAs). For more information on the WFI detectors and focal plane array please see the <a class="reference external" href="https://roman-docs.stsci.edu/roman-instruments-home/wfi-imaging-mode-user-guide/wfi-detectors">RDox documentation</a>. STIPS depends on the <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/roman-wfi-exposure-time-calculator/pandeia-for-roman">Pandeia Exposure time calculator</a> and the <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/stpsf-for-roman">STPSF point spread function (PSF) generator</a> to create these simulations. Tutorial notebooks for both <a class="reference internal" href="../pandeia/pandeia.html"><span class="std std-doc">Pandeia</span></a> and <a class="reference internal" href="../stpsf/stpsf.html"><span class="std std-doc">STPSF</span></a> are also available. Users can choose to simulate between 1 and 18 SCAs in any of the WFI imaging filters, insert any number of point or extended sources, and specify a sky background estimate. STIPS will scale input fluxes to observed values, retrieve appropriate PSFs (interpolated to the positions of the sources), and add in additional noise terms.</p>
<p>As described in the <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/stips-space-telescope-imaging-product-simulator/caveats-of-using-stips-for-roman">Caveats to Using STIPS for Roman</a>, neither pixel saturation nor non-linearity residuals are currently supported.</p>
<p>This notebook is a starter guide to simulating and manipulating scenes with STIPS.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<p>Besides the STIPS-related imports, the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> imports will help visualize simulated images and <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> will help write a FITS table on the fly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">stips</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">stips.astro_image</span><span class="w"> </span><span class="kn">import</span> <span class="n">AstroImage</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">stips.observation_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObservationModule</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">stips.scene_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">SceneModule</span>
</pre></div>
</div>
</div>
</div>
<section id="environment-report">
<h3>Environment report<a class="headerlink" href="#environment-report" title="Link to this heading">#</a></h3>
<p>To verify the existing STIPS installation alongside its associated data files and dependencies, run the cell below. (Find the current software requirements <a class="reference external" href="https://stips.readthedocs.io/en/latest/installation.html#stips-requirements">in the STIPS documentation</a>.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stips</span><span class="o">.</span><span class="n">__env__report__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>STIPS Version 2.3 with Data Version 1.0.10 at /home/runner/refdata/stips_data.
	STIPS Grid Generated with 1.1.0
Pandeia Version 2025.9 with Data Version 2025.9 at /home/runner/refdata/pandeia_data-2025.9-roman.
stpsf Version 2.1.0 with Data Version 2.1.0 at /home/runner/refdata/stpsf-data.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<section id="basic-stips-usage">
<h3>Basic STIPS Usage<a class="headerlink" href="#basic-stips-usage" title="Link to this heading">#</a></h3>
<p>This tutorial builds on the concepts introduced in the <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/stips-space-telescope-imaging-product-simulator/overview-of-stips">STIPS Overview</a> article and is designed to walk through the phases of using STIPS at the most introductory level: creating a small scene, designing an observation, and generating a simulated image.</p>
<p>At its most fundamental level, STIPS takes a dictionary of observation and instrument parameters and a source catalog in order to return a simulated image. The source catalog can be either a user-defined input catalog in FITS format or it can be simulated using the STIPS <code class="docutils literal notranslate"><span class="pre">SceneModule</span></code> class (see below).</p>
<p>In this example, we start by specifying an <strong>observation dictionary</strong> for an image taken with the F129 filter, using the Detector 1 (WFI01), and with an exposure time of 300 seconds.</p>
<p><strong>Note:</strong> We first need to update the path to the PSF cache using a YAML configuration file. A patch to fix the setting of this path in STIPS module calls will be released in the near future.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;psf_cache_location&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;HOME&quot;</span><span class="p">]}</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;./stips_config.yaml&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">fix</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we set up the observation dictionary:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;instrument&#39;</span><span class="p">:</span> <span class="s1">&#39;WFI&#39;</span><span class="p">,</span> <span class="s1">&#39;filters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F129&#39;</span><span class="p">],</span> <span class="s1">&#39;detectors&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
       <span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="s1">&#39;pandeia&#39;</span><span class="p">,</span> <span class="s1">&#39;observations_id&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;exptime&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
       <span class="s1">&#39;offsets&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;offset_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;offset_centre&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;offset_ra&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                    <span class="s1">&#39;offset_dec&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;offset_pa&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">}]</span>
       <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Then we feed the dictionary to an instance of the <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> class, while also specifying the central coordinates (90 degrees right ascension and 30 degrees declination) and position angle (0 degrees) as keyword arguments.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm</span> <span class="o">=</span> <span class="n">ObservationModule</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pa</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">cores</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,171 INFO: Got offsets as [{&#39;offset_id&#39;: 1, &#39;offset_centre&#39;: False, &#39;offset_ra&#39;: 0.0, &#39;offset_dec&#39;: 0.0, &#39;offset_pa&#39;: 0.0}]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,200 INFO: Adding observation with filter F129 and offset (0.0,0.0,0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,201 INFO: Added 1 observations
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,390 INFO: WFI with 1 detectors. Central offset (np.float64(2.065830864204697e-13), np.float64(-8.945310041616143e-14), 0)
</pre></div>
</div>
</div>
</div>
<section id="create-a-simple-astronomical-scene">
<h4>Create a Simple Astronomical Scene<a class="headerlink" href="#create-a-simple-astronomical-scene" title="Link to this heading">#</a></h4>
<p>The other requirement is an input source catalog. In this case, we generate and input a user-defined catalog. STIPS accepts <a class="reference external" href="https://stips.readthedocs.io/en/latest/using_stips/catalogue_formats.html#stips-table-formats">several types of tables and catalogs</a> in either the IPAC text or FITS BinTable format. This example uses a Mixed Catalog, which requires the following columns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code>: Object ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ra</span></code>: Right ascension (RA), in degrees</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dec</span></code>: Declination (DEC), in degrees</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flux</span></code>: Flux, in <code class="docutils literal notranslate"><span class="pre">units</span></code> (defined below)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: Approximation used to profile a source. Options are <code class="docutils literal notranslate"><span class="pre">'sersic'</span></code> (for extended sources) or <code class="docutils literal notranslate"><span class="pre">point</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>: Sersic profile index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phi</span></code>: Position angle of the Sersic profle’s major axis, in degrees</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ratio</span></code>: Ratio of the Sersic profile’s major and minor axes</p>
<ul>
<li><p>Since <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">phi</span></code>, <code class="docutils literal notranslate"><span class="pre">ratio</span></code> only apply to extended sources, they are ignored in rows where <code class="docutils literal notranslate"><span class="pre">type</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'point'</span></code>.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">notes</span></code>: Optional per-source comments</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">units</span></code>: One of <code class="docutils literal notranslate"><span class="pre">‘p’</span></code> for photons/s, <code class="docutils literal notranslate"><span class="pre">‘e’</span></code> for electrons/s, <code class="docutils literal notranslate"><span class="pre">‘j’</span></code> for Jansky, or <code class="docutils literal notranslate"><span class="pre">‘c’</span></code> for counts/s</p></li>
</ul>
<p>Below, we create a catalog containing two sources located near the central coordinates specified in the <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mf">90.02</span><span class="p">,</span> <span class="mf">90.03</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;dec&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mf">29.98</span><span class="p">,</span> <span class="mf">29.97</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;flux&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mf">0.00023</span><span class="p">,</span> <span class="mf">0.0004</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;point&#39;</span><span class="p">,</span> <span class="s1">&#39;point&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;8A&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;re&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;phi&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ratio&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;notes&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;8A&#39;</span><span class="p">),</span>
    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;units&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;j&#39;</span><span class="p">,</span> <span class="s1">&#39;j&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;8A&#39;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we save the columns as a FITS table in the BinTable format and assign header keys that specify the filter and catalog type:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdut</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
<span class="n">hdut</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;TYPE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mixed&#39;</span>
<span class="n">hdut</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;FILTER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;F129&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>And we save the catalog locally:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_file</span> <span class="o">=</span> <span class="s1">&#39;catalog.fits&#39;</span>
<span class="n">hdut</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="n">cat_file</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="simulate-an-image">
<h4>Simulate an Image<a class="headerlink" href="#simulate-an-image" title="Link to this heading">#</a></h4>
<p>With the observation module and source catalog in tow, STIPS can take over the image simulation process. First, we trigger the initialization of a new observation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm</span><span class="o">.</span><span class="n">nextObservation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,418 INFO: Initializing Observation 0 of 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,418 INFO: Observation Filter is F129
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,419 INFO: Observation (RA,DEC) = (90.0,30.0) with PA=0.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,420 INFO: Resetting
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,756 INFO: Returning background 0.6433085243497264 for &#39;pandeia&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,757 INFO: Creating Detector WFI01 with (RA,DEC,PA) = (90.0,30.0,0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,757 INFO: Creating Detector WFI01 with offset (0.0,0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,767 INFO: Creating Instrument with Configuration {&#39;aperture&#39;: &#39;imaging&#39;, &#39;detector&#39;: &#39;wfi01&#39;, &#39;disperser&#39;: None, &#39;filter&#39;: &#39;f129&#39;, &#39;instrument&#39;: &#39;wfi&#39;, &#39;mode&#39;: &#39;imaging&#39;}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,797 INFO: WFI01: (RA, DEC, PA) := (90.0, 30.0, 0.0), detected as (90.0, 30.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,798 INFO: Detector WFI01 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,798 INFO: Reset Instrument
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating pandeia instrument roman.wfi.imaging
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Next, we simulate an image containing the sources from the catalog we created earlier. Then, we add error residuals to the image:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_name</span> <span class="o">=</span> <span class="n">obm</span><span class="o">.</span><span class="n">addCatalogue</span><span class="p">(</span><span class="n">cat_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,806 INFO: Running catalogue catalog.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,806 INFO: Adding catalogue catalog.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,814 INFO: Converting mixed catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,815 INFO: Preparing output table
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,829 INFO: Converting chunk 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,837 INFO: Finished converting catalogue to internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,838 INFO: Adding catalogue to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,838 INFO: Adding catalogue catalog_42_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,857 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,858 INFO: Keeping 2 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,859 INFO: Writing 2 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,859 INFO: Adding 2 point sources to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,865 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:22,866 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,677 INFO: Adding point source 1 to AstroImage 2631.9672457028046,1410.503966182148
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,688 INFO: Adding point source 2 to AstroImage 2915.5365753799083,1083.2929624680437
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,710 INFO: Added catalogue catalog_42_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,711 INFO: Finished catalogue catalog.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm</span><span class="o">.</span><span class="n">addError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,716 INFO: Adding Error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,716 INFO: Adding residual error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,745 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,983 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:23,984 INFO: Created AstroImage WFI01 and imported data from FITS file err_flat_wfi.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,013 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,247 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,248 INFO: Created AstroImage WFI01 and imported data from FITS file err_rdrk_wfi.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,252 INFO: Adding error to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,253 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,446 INFO: Returning background 0.6433085243497264 for &#39;pandeia&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,447 INFO: Background is 0.6433085243497264 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,628 INFO: Returning background 0.6433085243497264 for &#39;pandeia&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,628 INFO: Added background of 0.6433085243497264 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,675 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,679 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,679 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,680 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,691 INFO: WFI01: (RA, DEC, PA) := (90.0, 30.0, 0.0), detected as (90.0, 30.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:24,695 INFO: Adding poisson noise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,156 INFO: Adding Poisson Noise with mean 0.0008605307221340754 and standard deviation 13.897467648762612
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,158 INFO: Adding readnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,562 INFO: Adding readnoise with mean 0.0006565025541931391 and STDEV 12.00109577178955
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,563 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,600 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,601 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,639 INFO: Adding Dark residual with mean 0.20807769894599915 and standard deviation 1.1006208658218384
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:25,639 INFO: Adding cosmic ray residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,601 INFO: Adding Cosmic Ray residual with mean 0.0847659632563591 and standard deviation 1.9229004383087158
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,609 INFO: Finished adding error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,611 INFO: Finished Adding Error
</pre></div>
</div>
</div>
</div>
<p>We finish by saving the outputs to a FITS file. The <code class="docutils literal notranslate"><span class="pre">finalize()</span></code> method of the <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> object can also return a full field of view mosaic and a list of the simulation’s initial parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits_file_1</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">params_1</span> <span class="o">=</span> <span class="n">obm</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">mosaic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output FITS file is </span><span class="si">{</span><span class="n">fits_file_1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,616 INFO: Converting to FITS file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,616 INFO: Converting detector WFI01 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,617 INFO: Creating Extension HDU from AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,619 INFO: Created Extension HDU from AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,680 INFO: Created FITS file /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/sim_42_0.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Output FITS file is /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/sim_42_0.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">prm</span> <span class="ow">in</span> <span class="n">params_1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">prm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Instrument: WFI
Filters: F129
Pixel Scale: (0.110,0.110) arcsec/pix
Pivot Wavelength: 1.290 um
Background Type: Pandeia background rate
Exposure Time: 300.0s
Input Unit: counts/s
Added Flatfield Residual: True
Added Dark Current Residual: True
Added Cosmic Ray Residual: True
Added Readnoise: True
Added Poisson Noise: True
Detector X size: 4088
Detector Y size: 4088
Random Seed: 42
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">fits_file_1</span><span class="p">)[</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1500</span><span class="p">,</span> <span class="mi">2500</span><span class="p">:</span><span class="mi">3000</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f9361ee6cf0&gt;
</pre></div>
</div>
<img alt="../../_images/39e03b1603d11d8cdb22a33008a4547e475517338e006d69d03dc26a47459a0e.png" src="../../_images/39e03b1603d11d8cdb22a33008a4547e475517338e006d69d03dc26a47459a0e.png" />
</div>
</div>
</section>
</section>
<section id="generate-scenes-using-stips-built-in-functions">
<h3>Generate Scenes Using STIPS Built-In Functions<a class="headerlink" href="#generate-scenes-using-stips-built-in-functions" title="Link to this heading">#</a></h3>
<p>STIPS can simulate scenes by importing pre-existing catalogs (as in the first example) or by using built-in functionality that generates collections of stars or galaxies based on user-specified parameters. Below, we will use the STIPS <code class="docutils literal notranslate"><span class="pre">SceneModule</span></code> to generate a stellar population and a galactic population.</p>
<p>First, we specify a set of parameters that will be used in both scenes (RA, DEC, ID) and initialize two <code class="docutils literal notranslate"><span class="pre">SceneModule</span></code> instances, one for the stellar population and one for the galaxy population:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_prefix_1</span> <span class="o">=</span> <span class="s1">&#39;notebook_example1&#39;</span>
<span class="n">obs_ra</span> <span class="o">=</span> <span class="mf">150.0</span>
<span class="n">obs_dec</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span>

<span class="n">scm_stellar</span> <span class="o">=</span> <span class="n">SceneModule</span><span class="p">(</span><span class="n">out_prefix</span><span class="o">=</span><span class="n">obs_prefix_1</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="n">obs_ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">obs_dec</span><span class="p">)</span>
<span class="n">scm_galactic</span> <span class="o">=</span> <span class="n">SceneModule</span><span class="p">(</span><span class="n">out_prefix</span><span class="o">=</span><span class="n">obs_prefix_1</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="n">obs_ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">obs_dec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log level: INFO
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Log level: INFO
</pre></div>
</div>
</div>
</div>
<section id="create-a-stellar-population">
<h4>Create a Stellar Population<a class="headerlink" href="#create-a-stellar-population" title="Link to this heading">#</a></h4>
<p>Now we create a dictionary containing the parameters of the desired stellar population to pass to the <code class="docutils literal notranslate"><span class="pre">SceneModule</span></code> instance’s <code class="docutils literal notranslate"><span class="pre">CreatePopulation()</span></code> method. The following parameters are needed to define a stellar population:</p>
<ul class="simple">
<li><p>Number of point sources</p></li>
<li><p>Upper and lower limit of the age of the stars (in years)</p></li>
<li><p>Upper and lower limit of the metallicity of the stars</p></li>
<li><p>Initial Mass Function</p></li>
<li><p>Binary fraction</p></li>
<li><p>Clustering (True/False)</p></li>
<li><p>Distribution type (Uniform, Inverse power-law)</p></li>
<li><p>Total radius of the population</p></li>
<li><p>Distance from the population</p></li>
<li><p>Offset RA and DEC from the center of the scene being created</p></li>
</ul>
<p>A full accounting of each dictionary entry’s meaning can be found in the docstring of the <code class="docutils literal notranslate"><span class="pre">CreatePopulation()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>scm_stellar.CreatePopulation<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stellar_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_stars&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;age_low&#39;</span><span class="p">:</span> <span class="mf">7.5e12</span><span class="p">,</span> <span class="s1">&#39;age_high&#39;</span><span class="p">:</span> <span class="mf">7.5e12</span><span class="p">,</span>
                      <span class="s1">&#39;z_low&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;z_high&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;imf&#39;</span><span class="p">:</span> <span class="s1">&#39;salpeter&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.35</span><span class="p">,</span> <span class="s1">&#39;binary_fraction&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                      <span class="s1">&#39;distribution&#39;</span><span class="p">:</span> <span class="s1">&#39;invpow&#39;</span><span class="p">,</span> <span class="s1">&#39;clustered&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                      <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span> <span class="s1">&#39;radius_units&#39;</span><span class="p">:</span> <span class="s1">&#39;pc&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;distance_low&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;distance_high&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
                      <span class="s1">&#39;offset_ra&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;offset_dec&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
                      <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We pass the dictionary to the stellar <code class="docutils literal notranslate"><span class="pre">SceneModule</span></code> instance’s <code class="docutils literal notranslate"><span class="pre">CreatePopulation()</span></code> method. Running the method will save the newly-generated population locally.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stellar_cat_file</span> <span class="o">=</span> <span class="n">scm_stellar</span><span class="o">.</span><span class="n">CreatePopulation</span><span class="p">(</span><span class="n">stellar_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Stellar population saved to file </span><span class="si">{</span><span class="n">stellar_cat_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,942 INFO: Creating catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,942 INFO: Creating age and metallicity numbers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,942 INFO: Created age and metallicity numbers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,943 INFO: Creating stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,943 INFO: Age 1.35e+10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,944 INFO: Metallicity -2.000000
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:26,945 INFO: Creating 100 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,250 INFO: Creating 100 objects, max radius 100.0, function invpow, scale 2.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,304 INFO: Chunk 1: 106 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,316 INFO: Done creating catalogue
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Stellar population saved to file /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-galactic-population">
<h4>Create a Galactic Population<a class="headerlink" href="#create-a-galactic-population" title="Link to this heading">#</a></h4>
<p>Repeat the population generation process, now by creating a dictionary containing parameters of a desired <em>galactic</em> population. The following paramters are needed to define a galaxy population:</p>
<ul class="simple">
<li><p>Number of galaxies</p></li>
<li><p>Upper and lower limit of the redshift</p></li>
<li><p>Upper and lower limit of the galactic radii</p></li>
<li><p>Range of V-band surface brightness magnitudes</p></li>
<li><p>Clustering (True/False)</p></li>
<li><p>Distribution type (Uniform, Inverse power-law)</p></li>
<li><p>Radius of the distribution</p></li>
<li><p>Offset RA and DEC from the center of the scene being created</p></li>
</ul>
<p>A full accounting of each dictionary entry’s meaning can be found in the docstring of the <code class="docutils literal notranslate"><span class="pre">CreateGalaxies()</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>scm_galactic.CreateGalaxies<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<p>We pass the dictionary to the galaxy <code class="docutils literal notranslate"><span class="pre">SceneModule</span></code> instance’s <code class="docutils literal notranslate"><span class="pre">CreateGalaxies()</span></code> method, and save the result locally:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">galaxy_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_gals&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;z_low&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;z_high&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                     <span class="s1">&#39;rad_low&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;rad_high&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
                     <span class="s1">&#39;sb_v_low&#39;</span><span class="p">:</span> <span class="mf">30.0</span><span class="p">,</span> <span class="s1">&#39;sb_v_high&#39;</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
                     <span class="s1">&#39;distribution&#39;</span><span class="p">:</span> <span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;clustered&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                     <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mf">200.0</span><span class="p">,</span> <span class="s1">&#39;radius_units&#39;</span><span class="p">:</span> <span class="s1">&#39;arcsec&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;offset_ra&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;offset_dec&#39;</span><span class="p">:</span> <span class="mf">0.0</span>
                     <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">galaxy_cat_file</span> <span class="o">=</span> <span class="n">scm_galactic</span><span class="o">.</span><span class="n">CreateGalaxies</span><span class="p">(</span><span class="n">galaxy_parameters</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Galaxy population saved to file </span><span class="si">{</span><span class="n">galaxy_cat_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,331 INFO: Creating catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,332 INFO: Wrote preamble
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,332 INFO: Parameters are: {&#39;n_gals&#39;: 10, &#39;z_low&#39;: 0.0, &#39;z_high&#39;: 0.2, &#39;rad_low&#39;: 0.01, &#39;rad_high&#39;: 2.0, &#39;sb_v_low&#39;: 30.0, &#39;sb_v_high&#39;: 25.0, &#39;distribution&#39;: &#39;uniform&#39;, &#39;clustered&#39;: False, &#39;radius&#39;: 200.0, &#39;radius_units&#39;: &#39;arcsec&#39;, &#39;offset_ra&#39;: 0.0, &#39;offset_dec&#39;: 0.0}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,334 INFO: Making Co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,334 INFO: Creating 10 objects, max radius 200.0, function uniform, scale 2.8
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,335 INFO: Converting Co-ordinates into RA,DEC
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,345 INFO: Done creating catalogue
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Galaxy population saved to file /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-up-an-observation-first-pointing">
<h4>Set up an Observation (First Pointing)<a class="headerlink" href="#set-up-an-observation-first-pointing" title="Link to this heading">#</a></h4>
<p>Once we’ve created a scene, we can use STIPS to simulate as many exposures of it in as many orientations as we’d like. In STIPS, a single telescope pointing is called an <em>offset</em>, and a collection of exposures is an <em>observation</em>.</p>
<p>We start this subsection by creating a single <em>offset</em> that is dithered by 2 degrees in right ascension and rotated by 0.5 degrees in position angle from the center of the scene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset_1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;offset_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;offset_centre&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="c1"># True would center each detector on the same on-sky point</span>
            <span class="s1">&#39;offset_ra&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span> <span class="s1">&#39;offset_dec&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;offset_pa&#39;</span><span class="p">:</span> <span class="mf">0.5</span>
            <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>The offset information is contained within an <em>observation</em> that is taken with the F129 filter, uses detectors WFI01 through WFI03, and has an exposure time of 1500 seconds. We also apply distortion and specify a sky background of 0.24 counts/s/pixel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observation_parameters_1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;instrument&#39;</span><span class="p">:</span> <span class="s1">&#39;WFI&#39;</span><span class="p">,</span> <span class="s1">&#39;filters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F129&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;detectors&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;distortion&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="mf">0.24</span><span class="p">,</span> <span class="s1">&#39;observations_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="s1">&#39;exptime&#39;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span> <span class="s1">&#39;offsets&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">offset_1</span><span class="p">]</span>
                            <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>STIPS can also apply various types of error residuals to the observation. Here, we only include residuals from flat-fields and the dark current.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals_1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;residual_flat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;residual_dark&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
               <span class="s1">&#39;residual_cosmic&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;residual_poisson&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s1">&#39;residual_readnoise&#39;</span><span class="p">:</span> <span class="kc">False</span>
               <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we feed the observation dictionary to an instance of the <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> class, alongside the observation ID, right ascension, and declination specified earlier in this example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm_1</span> <span class="o">=</span> <span class="n">ObservationModule</span><span class="p">(</span><span class="n">observation_parameters_1</span><span class="p">,</span> <span class="n">residual</span><span class="o">=</span><span class="n">residuals_1</span><span class="p">,</span>
                          <span class="n">out_prefix</span><span class="o">=</span><span class="n">obs_prefix_1</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="n">obs_ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">obs_dec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,365 INFO: Got offsets as [{&#39;offset_id&#39;: 1, &#39;offset_centre&#39;: False, &#39;offset_ra&#39;: 2.0, &#39;offset_dec&#39;: 0.0, &#39;offset_pa&#39;: 0.5}]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,386 INFO: Adding observation with filter F129 and offset (2.0,0.0,0.5)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,386 INFO: Added 1 observations
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,516 INFO: WFI with 3 detectors. Central offset (np.float64(1.7907664211548176e-13), np.float64(-8.945310041616143e-14), 0)
</pre></div>
</div>
</div>
</div>
<p>We call the <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> object’s <code class="docutils literal notranslate"><span class="pre">nextObservation()</span></code> method to move to the first offset/filter combination (<code class="docutils literal notranslate"><span class="pre">offset_1</span></code> and F129) contained in the object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm_1</span><span class="o">.</span><span class="n">nextObservation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,521 INFO: Initializing Observation 0 of 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,522 INFO: Observation Filter is F129
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,522 INFO: Observation (RA,DEC) = (150.00055555555556,-2.5) with PA=0.5
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,522 INFO: Resetting
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,523 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,523 INFO: Creating Detector WFI01 with (RA,DEC,PA) = (150.00055555555556,-2.5,0.5)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,525 INFO: Creating Detector WFI01 with offset (0.0,0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,535 INFO: Creating Instrument with Configuration {&#39;aperture&#39;: &#39;imaging&#39;, &#39;detector&#39;: &#39;wfi01&#39;, &#39;disperser&#39;: None, &#39;filter&#39;: &#39;f129&#39;, &#39;instrument&#39;: &#39;wfi&#39;, &#39;mode&#39;: &#39;imaging&#39;}
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating pandeia instrument roman.wfi.imaging
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,566 INFO: WFI01: (RA, DEC, PA) := (150.00055555555556, -2.5, 0.5), detected as (150.00055555555556, -2.5, 0.5000000000001229)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,567 INFO: Detector WFI01 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,567 INFO: Creating Detector WFI02 with (RA,DEC,PA) = (150.00063361633363,-2.6463679052675504,0.5)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,568 INFO: Creating Detector WFI02 with offset (7.806077806812047e-05,-0.1463679052675503)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,577 INFO: WFI02: (RA, DEC, PA) := (150.00063361633363, -2.6463679052675504, 0.5), detected as (150.00063361633363, -2.6463679052675504, 0.5000000000001229)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,578 INFO: Detector WFI02 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,578 INFO: Creating Detector WFI03 with (RA,DEC,PA) = (150.00076976694686,-2.777285221181246,0.5)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,579 INFO: Creating Detector WFI03 with offset (0.00021421139128143576,-0.2772852211812461)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,588 INFO: WFI03: (RA, DEC, PA) := (150.00076976694686, -2.777285221181246, 0.5), detected as (150.00076976694686, -2.777285221181246, 0.5000000000001229)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,589 INFO: Detector WFI03 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,589 INFO: Reset Instrument
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Now that the observation is fully set up, we add the stellar and galactic populations to it. (Please note that each population may take about a minute to load.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_stellar_catalogs_1</span> <span class="o">=</span> <span class="n">obm_1</span><span class="o">.</span><span class="n">addCatalogue</span><span class="p">(</span><span class="n">stellar_cat_file</span><span class="p">)</span>
<span class="n">output_galaxy_catalogs_1</span> <span class="o">=</span> <span class="n">obm_1</span><span class="o">.</span><span class="n">addCatalogue</span><span class="p">(</span><span class="n">galaxy_cat_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output Catalogs are </span><span class="si">{</span><span class="n">output_stellar_catalogs_1</span><span class="si">}</span><span class="s2"> and &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_galaxy_catalogs_1</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,595 INFO: Running catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,596 INFO: Adding catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,607 INFO: Converting phoenix catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,607 INFO: Preparing output table
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,626 INFO: Converting chunk 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,627 INFO: Converting Phoenix Table to Internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,627 INFO: 1 datasets
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,945 INFO: Finished converting catalogue to internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,945 INFO: Adding catalogue to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,946 INFO: Adding catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,965 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,966 INFO: Keeping 68 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,967 INFO: Writing 68 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,967 INFO: Adding 68 point sources to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,973 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:27,973 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,804 INFO: Adding point source 1 to AstroImage 2051.9592530481987,2094.064485517686
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,815 INFO: Adding point source 2 to AstroImage 2063.5292969720063,2108.9634332180967
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,827 INFO: Adding point source 3 to AstroImage 2008.4657206935929,2086.012070661093
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,837 INFO: Adding point source 4 to AstroImage 2100.97814294416,2248.6458027895037
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,849 INFO: Adding point source 5 to AstroImage 2191.293152297035,2175.7823819775813
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,860 INFO: Adding point source 6 to AstroImage 2083.0380990589165,2127.3596638883623
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,871 INFO: Adding point source 7 to AstroImage 2276.619646389378,1992.3611657061085
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,882 INFO: Adding point source 8 to AstroImage 2001.6457518250488,2041.3978841733444
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,894 INFO: Adding point source 9 to AstroImage 2046.836178495134,2065.1585094272887
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,905 INFO: Adding point source 10 to AstroImage 2268.1366225519564,2034.119902433617
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,916 INFO: Adding point source 11 to AstroImage 1851.3101816785643,2085.7610679210925
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,927 INFO: Adding point source 12 to AstroImage 2286.79778068381,2297.663683503372
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,938 INFO: Adding point source 13 to AstroImage 2415.4361879856833,1934.5172552160648
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,949 INFO: Adding point source 14 to AstroImage 1629.5562614514035,2118.5885837011165
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,960 INFO: Adding point source 15 to AstroImage 1891.625529262597,1658.0425796302811
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,972 INFO: Adding point source 16 to AstroImage 2265.446758053793,1599.2745735503431
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,983 INFO: Adding point source 17 to AstroImage 2607.3925747710437,2081.8311518837354
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:28,994 INFO: Adding point source 18 to AstroImage 1767.1743138224438,1543.1138775130185
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,005 INFO: Adding point source 19 to AstroImage 1787.6166661540942,2261.4106899545623
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,016 INFO: Adding point source 20 to AstroImage 2055.4176391353717,2067.3447583100583
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,027 INFO: Adding point source 21 to AstroImage 2210.7531833698167,2665.114986250673
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,038 INFO: Adding point source 22 to AstroImage 1551.0663562681912,2043.605243848407
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,050 INFO: Adding point source 23 to AstroImage 1748.6491115064064,2452.2532690529442
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,061 INFO: Adding point source 24 to AstroImage 1420.8655635088307,1960.4703648118273
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,072 INFO: Adding point source 25 to AstroImage 684.1752298675092,1750.5785949506335
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,083 INFO: Adding point source 26 to AstroImage 1284.8114328773163,3289.5441323588084
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,095 INFO: Adding point source 27 to AstroImage 1314.4733368099478,2620.4991313444984
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,106 INFO: Adding point source 28 to AstroImage 3085.370600702894,1269.651617082362
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,117 INFO: Adding point source 29 to AstroImage 2214.415513641475,3356.073580318342
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,128 INFO: Adding point source 30 to AstroImage 1699.8869868040765,479.0362359771111
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,140 INFO: Adding point source 31 to AstroImage 2514.496724457362,1295.77545192024
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,151 INFO: Adding point source 32 to AstroImage 2408.5085135780255,397.4433648048839
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,162 INFO: Adding point source 33 to AstroImage 1627.9563537016138,1283.3366167262259
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,173 INFO: Adding point source 34 to AstroImage 936.5642241363157,1882.9557271753595
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,184 INFO: Adding point source 35 to AstroImage 962.4366119100412,1452.0267104850045
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,196 INFO: Adding point source 36 to AstroImage 1022.1815640687742,2371.1118113241346
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,207 INFO: Adding point source 37 to AstroImage 3588.817757783024,3397.4738657086355
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,218 INFO: Adding point source 38 to AstroImage 3289.312259363949,2664.385836726294
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,229 INFO: Adding point source 39 to AstroImage 1109.6800177120324,3924.7653688008295
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,241 INFO: Adding point source 40 to AstroImage 960.1443251338669,343.65338102728765
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,252 INFO: Adding point source 41 to AstroImage 2633.089204594625,907.0201157815497
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,263 INFO: Adding point source 42 to AstroImage 3930.9372496441483,2291.496735800102
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,274 INFO: Adding point source 43 to AstroImage 2844.614488009348,1527.7395581399403
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,285 INFO: Adding point source 44 to AstroImage 2946.8944025108685,2062.2045092620237
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,296 INFO: Adding point source 45 to AstroImage 2889.236605946333,2118.4094473120117
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,307 INFO: Adding point source 46 to AstroImage 371.1478973433234,2991.0352134788923
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,319 INFO: Adding point source 47 to AstroImage 761.3504976478564,1886.9552523202656
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,329 INFO: Adding point source 48 to AstroImage 658.6095893511908,2955.140039754186
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,340 INFO: Adding point source 49 to AstroImage 1578.755270942256,2527.2750253404874
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,352 INFO: Adding point source 50 to AstroImage 560.2225093956627,3118.9882099641627
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,363 INFO: Adding point source 51 to AstroImage 2619.9410365974554,1773.3663128221324
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,374 INFO: Adding point source 52 to AstroImage 2501.8478192705143,2169.236886700989
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,385 INFO: Adding point source 53 to AstroImage 560.1859270163109,4020.800873377771
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,396 INFO: Adding point source 54 to AstroImage 2290.629722404064,672.7040791453305
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,407 INFO: Adding point source 55 to AstroImage 3460.842084657641,2506.213331221199
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,418 INFO: Adding point source 56 to AstroImage 2067.18247151246,2136.64568964294
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,429 INFO: Adding point source 57 to AstroImage 2630.756279957798,2517.181991700866
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,440 INFO: Adding point source 58 to AstroImage 2511.051633999866,2063.285763742242
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,451 INFO: Adding point source 59 to AstroImage 2069.135052290299,2644.2318929978805
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,462 INFO: Adding point source 60 to AstroImage 2310.835921996443,2254.5200968256067
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,473 INFO: Adding point source 61 to AstroImage 2380.973824245339,1928.3684472482753
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,484 INFO: Adding point source 62 to AstroImage 127.53876968617101,2589.5071222990837
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,496 INFO: Adding point source 63 to AstroImage 1755.565251987182,948.1805923721963
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,507 INFO: Adding point source 64 to AstroImage 2563.8979823513864,3273.719636812945
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,518 INFO: Adding point source 65 to AstroImage 2596.6224493045943,1100.4587065775504
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,529 INFO: Adding point source 66 to AstroImage 3997.5957173452425,1954.9889631144767
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,541 INFO: Adding point source 67 to AstroImage 3610.1309683316213,3983.774135570806
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,552 INFO: Adding point source 68 to AstroImage 2498.554759955907,3989.444584566704
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,576 INFO: Added catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,576 INFO: Adding catalogue to detector WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,577 INFO: Adding catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,599 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,600 INFO: Keeping 2 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,601 INFO: Writing 2 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,601 INFO: Adding 2 point sources to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,607 INFO: PSF File psf_WFI_2.3_F129_wfi02.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:29,608 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi02.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,443 INFO: Adding point source 1 to AstroImage 1468.8568861624813,4098.232361312826
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,454 INFO: Adding point source 2 to AstroImage 504.74260462765915,3087.7087517314126
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,478 INFO: Added catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,478 INFO: Adding catalogue to detector WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,479 INFO: Adding catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,491 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,492 INFO: Keeping 0 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,493 INFO: Added catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,494 INFO: Finished catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,494 INFO: Running catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,495 INFO: Adding catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,503 INFO: Converting bc95 catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,504 INFO: Preparing output table
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,519 INFO: Converting chunk 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,520 INFO: Converting BC95 Catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,520 INFO: Normalization Bandpass is johnson,v (&lt;class &#39;str&#39;&gt;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,521 INFO: Normalization Bandpass is johnson,v
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,531 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,560 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,587 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,615 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,643 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,670 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,697 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,724 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,751 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,778 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,803 INFO: Finished converting catalogue to internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,804 INFO: Adding catalogue to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,804 INFO: Adding catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,824 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,825 INFO: Keeping 10 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,826 INFO: Writing 10 galaxies
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,826 INFO: Starting Sersic Profiles at Thu Dec 11 19:37:30 2025
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:30,827 INFO: Index is 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:33,854 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:33,855 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:36,798 INFO: Finished Galaxy 1 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:36,799 INFO: Index is 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 0 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9722 seconds, Running total: 5.9722 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:39,855 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:39,856 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:42,774 INFO: Finished Galaxy 2 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:42,775 INFO: Index is 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 1 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9755 seconds, Running total: 11.9478 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:45,806 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:45,807 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:48,694 INFO: Finished Galaxy 3 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:48,695 INFO: Index is 3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 2 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9206 seconds, Running total: 17.8685 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:51,728 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:51,729 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:54,633 INFO: Finished Galaxy 4 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:54,634 INFO: Index is 4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 3 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9385 seconds, Running total: 23.8071 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:57,258 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:37:57,258 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:00,154 INFO: Finished Galaxy 5 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:00,155 INFO: Index is 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 4 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.5208 seconds, Running total: 29.3280 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:02,845 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:02,846 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:05,746 INFO: Finished Galaxy 6 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:05,746 INFO: Index is 6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 5 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.5917 seconds, Running total: 34.9197 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:08,796 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:08,797 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:11,700 INFO: Finished Galaxy 7 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:11,701 INFO: Index is 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 6 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9542 seconds, Running total: 40.8740 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:14,757 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:14,757 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:17,663 INFO: Finished Galaxy 8 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:17,664 INFO: Index is 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 7 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9629 seconds, Running total: 46.8369 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:20,719 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:20,720 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:23,649 INFO: Finished Galaxy 9 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:23,650 INFO: Index is 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 8 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9863 seconds, Running total: 52.8233 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:26,714 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:26,715 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,578 INFO: Finished Galaxy 10 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,579 INFO: Finishing Sersic Profiles at Thu Dec 11 19:38:29 2025
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,592 INFO: Added catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,592 INFO: Adding catalogue to detector WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,593 INFO: Adding catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,606 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,606 INFO: Keeping 0 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,608 INFO: Added catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,608 INFO: Adding catalogue to detector WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,609 INFO: Adding catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,621 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,622 INFO: Keeping 0 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,624 INFO: Added catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,624 INFO: Finished catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 9 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9290 seconds, Running total: 58.7523 seconds
Output Catalogs are [&#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129_observed_WFI01.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129_observed_WFI02.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129_observed_WFI03.fits&#39;] and [&#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129_observed_WFI01.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129_observed_WFI02.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129_observed_WFI03.fits&#39;].
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm_1</span><span class="o">.</span><span class="n">addError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,629 INFO: Adding Error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,630 INFO: Adding residual error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,658 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,899 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,900 INFO: Created AstroImage WFI01 and imported data from FITS file err_flat_wfi.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:29,929 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,165 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,166 INFO: Created AstroImage WFI01 and imported data from FITS file err_rdrk_wfi.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,170 INFO: Adding error to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,171 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,171 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,171 INFO: Background is 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,172 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,172 INFO: Added background of 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,185 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,189 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,190 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,190 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,202 INFO: WFI01: (RA, DEC, PA) := (150.00055555555556, -2.5, 0.5000000000001229), detected as (150.00055555555556, -2.5, 0.5000000000001104)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,207 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,245 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,246 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,285 INFO: Adding Dark residual with mean 1.0403887033462524 and standard deviation 5.5031046867370605
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,289 INFO: Adding error to detector WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,290 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,290 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,290 INFO: Background is 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,291 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,291 INFO: Added background of 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,334 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,338 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,338 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,339 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,350 INFO: WFI02: (RA, DEC, PA) := (150.00063361633363, -2.6463679052675504, 0.5000000000001229), detected as (150.00063361633363, -2.6463679052675504, 0.5000000000001104)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,355 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,393 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,394 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,433 INFO: Adding Dark residual with mean 1.0403887033462524 and standard deviation 5.5031046867370605
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,437 INFO: Adding error to detector WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,438 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,438 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,438 INFO: Background is 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,439 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,439 INFO: Added background of 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,491 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,495 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,496 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,497 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,508 INFO: WFI03: (RA, DEC, PA) := (150.00076976694686, -2.777285221181246, 0.5000000000001229), detected as (150.00076976694686, -2.777285221181246, 0.5000000000001104)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,513 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,551 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,552 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,590 INFO: Adding Dark residual with mean 1.0403887033462524 and standard deviation 5.5031046867370605
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,594 INFO: Finished adding error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,596 INFO: Finished Adding Error
</pre></div>
</div>
</div>
</div>
<p>As before, finish by saving the simulated image to a FITS file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits_file_1</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">params_1</span> <span class="o">=</span> <span class="n">obm_1</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">mosaic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output FITS file is </span><span class="si">{</span><span class="n">fits_file_1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,601 INFO: Converting to FITS file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,602 INFO: Converting detector WFI01 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,602 INFO: Creating Extension HDU from AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,605 INFO: Created Extension HDU from AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,606 INFO: Converting detector WFI02 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,606 INFO: Creating Extension HDU from AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,608 INFO: Created Extension HDU from AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,609 INFO: Converting detector WFI03 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,610 INFO: Creating Extension HDU from AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,611 INFO: Created Extension HDU from AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:30,791 INFO: Created FITS file /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_1_0.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Output FITS file is /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_1_0.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">fits_file_1</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f935dcd3610&gt;
</pre></div>
</div>
<img alt="../../_images/4bce8bc790cc9d9d267e67377b48335c4e89c53ba483ec31ac324f8f0afbbdc9.png" src="../../_images/4bce8bc790cc9d9d267e67377b48335c4e89c53ba483ec31ac324f8f0afbbdc9.png" />
</div>
</div>
</section>
<section id="modify-an-observation-by-adding-a-second-pointing">
<h4>Modify an Observation (by Adding a Second Pointing)<a class="headerlink" href="#modify-an-observation-by-adding-a-second-pointing" title="Link to this heading">#</a></h4>
<p>To observe the same scene under different conditions, we make a new <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> object that takes updated versions of the input observation parameter and residual dictionaries. The collection of resulting <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> objects can be thought of as a dithered set of observations.</p>
<p>For the second observation, we assume an offset of 10 degrees in right ascension and rotated by 27 degrees in position angle from the center of the scene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offset_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;offset_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;offset_centre&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="c1"># True centers each detector on same point</span>
            <span class="s1">&#39;offset_ra&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;offset_dec&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;offset_pa&#39;</span><span class="p">:</span> <span class="mi">27</span>
            <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>The second observation is identical to the first (F129 filter, detectors WFI01 through WFI03, exposure time of 1500 seconds, distortion, and a sky background of 0.24 counts/s/pixel) with the exception of the offset parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observation_parameters_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;instrument&#39;</span><span class="p">:</span> <span class="s1">&#39;WFI&#39;</span><span class="p">,</span> <span class="s1">&#39;filters&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;F129&#39;</span><span class="p">],</span>
                            <span class="s1">&#39;detectors&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;distortion&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                            <span class="s1">&#39;background&#39;</span><span class="p">:</span> <span class="mf">0.24</span><span class="p">,</span> <span class="s1">&#39;observations_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="s1">&#39;exptime&#39;</span><span class="p">:</span> <span class="mi">1500</span><span class="p">,</span> <span class="s1">&#39;offsets&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">offset_2</span><span class="p">]</span>
                            <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>This time, we include residuals from the flat-field and read noise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">residuals_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;residual_flat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;residual_dark&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s1">&#39;residual_cosmic&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;residual_poisson&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
               <span class="s1">&#39;residual_readnoise&#39;</span><span class="p">:</span> <span class="kc">True</span>
               <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>We create the new <code class="docutils literal notranslate"><span class="pre">ObservationModule</span></code> object and initialize it for a simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_prefix_2</span> <span class="o">=</span> <span class="s1">&#39;notebook_example2&#39;</span>
<span class="n">obm_2</span> <span class="o">=</span> <span class="n">ObservationModule</span><span class="p">(</span><span class="n">observation_parameters_2</span><span class="p">,</span> <span class="n">residuals</span><span class="o">=</span><span class="n">residuals_2</span><span class="p">,</span>
                          <span class="n">out_prefix</span><span class="o">=</span><span class="n">obs_prefix_2</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="n">obs_ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">obs_dec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:32,909 INFO: Got offsets as [{&#39;offset_id&#39;: 1, &#39;offset_centre&#39;: False, &#39;offset_ra&#39;: 10.0, &#39;offset_dec&#39;: 0.0, &#39;offset_pa&#39;: 27}]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:32,939 INFO: Adding observation with filter F129 and offset (10.0,0.0,27)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:32,939 INFO: Added 1 observations
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,069 INFO: WFI with 3 detectors. Central offset (np.float64(1.7907664211548176e-13), np.float64(-8.945310041616143e-14), 0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm_2</span><span class="o">.</span><span class="n">nextObservation</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,074 INFO: Initializing Observation 0 of 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,075 INFO: Observation Filter is F129
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,075 INFO: Observation (RA,DEC) = (150.00277777777777,-2.5) with PA=27.0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,076 INFO: Resetting
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,076 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,077 INFO: Creating Detector WFI01 with (RA,DEC,PA) = (150.00277777777777,-2.5,27.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,078 INFO: Creating Detector WFI01 with offset (0.0,0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,089 INFO: Creating Instrument with Configuration {&#39;aperture&#39;: &#39;imaging&#39;, &#39;detector&#39;: &#39;wfi01&#39;, &#39;disperser&#39;: None, &#39;filter&#39;: &#39;f129&#39;, &#39;instrument&#39;: &#39;wfi&#39;, &#39;mode&#39;: &#39;imaging&#39;}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,119 INFO: WFI01: (RA, DEC, PA) := (150.00277777777777, -2.5, 27.0), detected as (150.00277777777777, -2.5, 27.000000000000913)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,120 INFO: Detector WFI01 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,120 INFO: Creating Detector WFI02 with (RA,DEC,PA) = (150.00285583855583,-2.6463679052675504,27.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,121 INFO: Creating Detector WFI02 with offset (7.806077806812047e-05,-0.1463679052675503)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,130 INFO: WFI02: (RA, DEC, PA) := (150.00285583855583, -2.6463679052675504, 27.0), detected as (150.00285583855583, -2.6463679052675504, 27.000000000000913)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,131 INFO: Detector WFI02 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,131 INFO: Creating Detector WFI03 with (RA,DEC,PA) = (150.00299198916906,-2.777285221181246,27.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,132 INFO: Creating Detector WFI03 with offset (0.00021421139128143576,-0.2772852211812461)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,142 INFO: WFI03: (RA, DEC, PA) := (150.00299198916906, -2.777285221181246, 27.0), detected as (150.00299198916906, -2.777285221181246, 27.000000000000913)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,142 INFO: Detector WFI03 created
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,143 INFO: Reset Instrument
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Creating pandeia instrument roman.wfi.imaging
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Add the stellar and galactic populations to the new observation along with the sources of error chosen above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_stellar_catalogs_2</span> <span class="o">=</span> <span class="n">obm_2</span><span class="o">.</span><span class="n">addCatalogue</span><span class="p">(</span><span class="n">stellar_cat_file</span><span class="p">)</span>
<span class="n">output_galaxy_catalogs_2</span> <span class="o">=</span> <span class="n">obm_2</span><span class="o">.</span><span class="n">addCatalogue</span><span class="p">(</span><span class="n">galaxy_cat_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output Catalogs are </span><span class="si">{</span><span class="n">output_stellar_catalogs_2</span><span class="si">}</span><span class="s2"> and &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_galaxy_catalogs_2</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,149 INFO: Running catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,150 INFO: Adding catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,160 INFO: Converting phoenix catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,161 INFO: Preparing output table
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,181 INFO: Converting chunk 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,181 INFO: Converting Phoenix Table to Internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,182 INFO: 1 datasets
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,497 INFO: Finished converting catalogue to internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,497 INFO: Adding catalogue to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,498 INFO: Adding catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,519 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,520 INFO: Keeping 70 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,520 INFO: Writing 70 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,521 INFO: Adding 70 point sources to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,527 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:33,527 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,332 INFO: Adding point source 1 to AstroImage 2001.5590167447203,2129.81557260575
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,343 INFO: Adding point source 2 to AstroImage 2018.5613106964738,2137.986653317021
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,355 INFO: Adding point source 3 to AstroImage 1959.0421694844104,2142.015837014853
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,365 INFO: Adding point source 4 to AstroImage 2114.401354391386,2246.2837744824774
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,377 INFO: Adding point source 5 to AstroImage 2162.716038858599,2140.777517452041
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,388 INFO: Adding point source 6 to AstroImage 2044.2287528218064,2145.745330844443
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,399 INFO: Adding point source 7 to AstroImage 2157.235846701601,1938.5550646565189
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,410 INFO: Adding point source 8 to AstroImage 1933.0320548903424,2105.132079635419
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,421 INFO: Adding point source 9 to AstroImage 1984.076457847524,2106.232496410012
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,432 INFO: Adding point source 10 to AstroImage 2168.2766845424394,1979.7115182462671
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,443 INFO: Adding point source 11 to AstroImage 1818.2861614114845,2211.9134262942434
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,454 INFO: Adding point source 12 to AstroImage 2302.5694694711756,2207.239562130453
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,465 INFO: Adding point source 13 to AstroImage 2255.657904738561,1824.8490919265112
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,476 INFO: Adding point source 14 to AstroImage 1634.4783042572046,2340.237703313579
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,487 INFO: Adding point source 15 to AstroImage 1663.5193747119042,1811.1445704453592
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,499 INFO: Adding point source 16 to AstroImage 1971.8430546057355,1591.7533721306488
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,510 INFO: Adding point source 17 to AstroImage 2493.177328236657,1871.0352423596826
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,521 INFO: Adding point source 18 to AstroImage 1500.8628481358423,1763.8205097633445
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,532 INFO: Adding point source 19 to AstroImage 1839.6588088132344,2397.528253534064
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,543 INFO: Adding point source 20 to AstroImage 1992.7318045024767,2104.3600313239713
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,554 INFO: Adding point source 21 to AstroImage 2398.4699005286943,2570.0154538628212
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,565 INFO: Adding point source 22 to AstroImage 1530.777641266569,2308.1543845881806
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,576 INFO: Adding point source 23 to AstroImage 1889.9386284636971,2585.7071596042274
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,587 INFO: Adding point source 24 to AstroImage 1377.1619007840764,2291.849174178154
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,598 INFO: Adding point source 25 to AstroImage 624.2188883669965,2432.7181664178474
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,609 INFO: Adding point source 26 to AstroImage 1848.4300838742743,3541.990832707236
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,620 INFO: Adding point source 27 to AstroImage 1576.4501556430655,2930.0039239597836
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,631 INFO: Adding point source 28 to AstroImage 2558.5451399768785,930.9152509375376
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,643 INFO: Adding point source 29 to AstroImage 2710.0506153464075,3186.744444233833
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,654 INFO: Adding point source 30 to AstroImage 965.8575457889665,841.5634102249442
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,665 INFO: Adding point source 31 to AstroImage 2059.3064300093424,1209.0161829396648
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,676 INFO: Adding point source 32 to AstroImage 1563.6214088996635,452.3588026292289
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,687 INFO: Adding point source 33 to AstroImage 1260.3601506093132,1593.455252653775
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,698 INFO: Adding point source 34 to AstroImage 909.1568629896396,2438.572073810691
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,709 INFO: Adding point source 35 to AstroImage 740.0320356709592,2041.3743908734536
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,720 INFO: Adding point source 36 to AstroImage 1203.5922736629825,2837.2379639308792
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,732 INFO: Adding point source 37 to AstroImage 3958.5240445980007,2610.5418048760293
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,743 INFO: Adding point source 38 to AstroImage 3363.3849172692135,2088.113845195484
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,754 INFO: Adding point source 39 to AstroImage 243.4284987807505,1050.4749630062015
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,765 INFO: Adding point source 40 to AstroImage 1991.977813489255,808.1898618657672
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,776 INFO: Adding point source 41 to AstroImage 3771.2158827419134,1468.11162149656
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,788 INFO: Adding point source 42 to AstroImage 2458.241928549419,1269.311687983551
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,799 INFO: Adding point source 43 to AstroImage 2788.252092297896,1701.9862160230336
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,810 INFO: Adding point source 44 to AstroImage 2761.730542101335,1778.0126825497946
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,821 INFO: Adding point source 45 to AstroImage 897.566888820123,3682.5180393196647
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,833 INFO: Adding point source 46 to AstroImage 818.4142402134075,58.69352043107415
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,844 INFO: Adding point source 47 to AstroImage 754.1365112300155,2520.3311091724945
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,855 INFO: Adding point source 48 to AstroImage 3590.0167432112103,447.0584842415401
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,866 INFO: Adding point source 49 to AstroImage 1138.8101719477902,3522.129830413646
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,877 INFO: Adding point source 50 to AstroImage 1771.369092683112,2728.652770033859
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,888 INFO: Adding point source 51 to AstroImage 1123.8685639240016,3712.663271732572
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,899 INFO: Adding point source 52 to AstroImage 2366.771519015063,1589.3801515606326
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,910 INFO: Adding point source 53 to AstroImage 2437.721737043403,1996.3513816223806
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,921 INFO: Adding point source 54 to AstroImage 3605.7731994582646,3844.45022414836
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,932 INFO: Adding point source 55 to AstroImage 1580.9478499728461,751.2963571452542
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,943 INFO: Adding point source 56 to AstroImage 4002.6246283356127,673.2047526127178
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,954 INFO: Adding point source 57 to AstroImage 3446.3169877961523,1870.0237484174365
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,965 INFO: Adding point source 58 to AstroImage 2034.1823852582784,2161.130443747393
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,976 INFO: Adding point source 59 to AstroImage 92.92409175074181,3834.081305975894
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,987 INFO: Adding point source 60 to AstroImage 2708.338259463355,2250.2211940775815
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:34,998 INFO: Adding point source 61 to AstroImage 2398.6835553487936,1897.4252938429531
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,009 INFO: Adding point source 62 to AstroImage 2262.412903938523,2614.515927801918
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,020 INFO: Adding point source 63 to AstroImage 2304.8315374157287,2157.9031218199316
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,032 INFO: Adding point source 64 to AstroImage 2222.0727502247382,1834.7232866708177
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,043 INFO: Adding point source 65 to AstroImage 500.3921556598939,3431.873939152217
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,055 INFO: Adding point source 66 to AstroImage 1225.016459017171,1236.5737376570985
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,066 INFO: Adding point source 67 to AstroImage 2986.0687168991712,2957.105218227983
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,077 INFO: Adding point source 68 to AstroImage 2045.6540163172772,997.5761779235411
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,088 INFO: Adding point source 69 to AstroImage 3680.722364562438,1137.2162510191388
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,100 INFO: Adding point source 70 to AstroImage 3246.9445947574904,3626.7885077402134
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,125 INFO: Added catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,126 INFO: Adding catalogue to detector WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,126 INFO: Adding catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,146 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,146 INFO: Keeping 1 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,148 INFO: Writing 1 stars
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,148 INFO: Adding 1 point sources to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,154 INFO: PSF File psf_WFI_2.3_F129_wfi02.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,154 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi02.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:35,980 INFO: Adding point source 1 to AstroImage 1060.2681380772267,3709.421233050434
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,004 INFO: Added catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,004 INFO: Adding catalogue to detector WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,005 INFO: Adding catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,018 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,018 INFO: Keeping 0 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,020 INFO: Added catalogue notebook_example1_stars_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,020 INFO: Finished catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,021 INFO: Running catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,021 INFO: Adding catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,029 INFO: Converting bc95 catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,030 INFO: Preparing output table
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,045 INFO: Converting chunk 2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,045 INFO: Converting BC95 Catalogue
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,046 INFO: Normalization Bandpass is johnson,v (&lt;class &#39;str&#39;&gt;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,046 INFO: Normalization Bandpass is johnson,v
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,056 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,082 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,109 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,136 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,163 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,191 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,217 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,244 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,272 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,298 WARNING: DataConfigurationError: Error loading normalization bandpass: johnson_v EngineInputError(&quot;Invalid keys provided: [&#39;johnson_v&#39;] (&#39;johnson_v&#39;)&quot;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,328 INFO: Finished converting catalogue to internal format
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,328 INFO: Adding catalogue to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,329 INFO: Adding catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,350 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,351 INFO: Keeping 10 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,352 INFO: Writing 10 galaxies
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,353 INFO: Starting Sersic Profiles at Thu Dec 11 19:38:36 2025
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:36,353 INFO: Index is 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:39,359 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:39,359 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:42,286 INFO: Finished Galaxy 1 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:42,287 INFO: Index is 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 0 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9337 seconds, Running total: 5.9338 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:45,291 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:45,292 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:48,218 INFO: Finished Galaxy 2 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:48,219 INFO: Index is 2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 1 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9323 seconds, Running total: 11.8661 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:51,270 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:51,271 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:54,205 INFO: Finished Galaxy 3 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:54,205 INFO: Index is 3
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 2 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9861 seconds, Running total: 17.8522 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:57,253 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:38:57,254 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:00,164 INFO: Finished Galaxy 4 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:00,165 INFO: Index is 4
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 3 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9595 seconds, Running total: 23.8118 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:02,791 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:02,791 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:05,675 INFO: Finished Galaxy 5 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:05,676 INFO: Index is 5
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 4 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.5107 seconds, Running total: 29.3226 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:08,334 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:08,334 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:11,224 INFO: Finished Galaxy 6 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:11,224 INFO: Index is 6
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 5 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.5487 seconds, Running total: 34.8713 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:14,239 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:14,240 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:17,128 INFO: Finished Galaxy 7 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:17,129 INFO: Index is 7
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 6 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9043 seconds, Running total: 40.7757 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:20,140 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:20,141 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:23,027 INFO: Finished Galaxy 8 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:23,027 INFO: Index is 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 7 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.8986 seconds, Running total: 46.6744 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:26,071 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:26,071 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:28,954 INFO: Finished Galaxy 9 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:28,955 INFO: Index is 9
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 8 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9272 seconds, Running total: 52.6017 seconds
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:31,993 INFO: PSF File psf_WFI_2.3_F129_wfi01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:31,993 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,893 INFO: Finished Galaxy 10 of 10
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,894 INFO: Finishing Sersic Profiles at Thu Dec 11 19:39:34 2025
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,908 INFO: Added catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,909 INFO: Adding catalogue to detector WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,909 INFO: Adding catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,921 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,922 INFO: Keeping 0 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,923 INFO: Added catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,924 INFO: Adding catalogue to detector WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,924 INFO: Adding catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,937 INFO: Determining pixel co-ordinates
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,938 INFO: Keeping 0 items
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,939 INFO: Added catalogue notebook_example1_gals_000_01_conv_F129.fits to AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,940 INFO: Finished catalogue /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step 9 duration in WFI01 with fast_galaxy=False and convolve_galaxy=True: 5.9390 seconds, Running total: 58.5408 seconds
Output Catalogs are [&#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129_observed_WFI01.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129_observed_WFI02.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_stars_000_01_conv_F129_observed_WFI03.fits&#39;] and [&#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129_observed_WFI01.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129_observed_WFI02.fits&#39;, &#39;/home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example1_gals_000_01_conv_F129_observed_WFI03.fits&#39;].
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obm_2</span><span class="o">.</span><span class="n">addError</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,944 INFO: Adding Error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,945 INFO: Adding residual error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:34,973 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,223 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,224 INFO: Created AstroImage WFI01 and imported data from FITS file err_flat_wfi.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,253 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,501 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,501 INFO: Created AstroImage WFI01 and imported data from FITS file err_rdrk_wfi.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,505 INFO: Adding error to detector WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,506 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,506 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,507 INFO: Background is 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,507 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,508 INFO: Added background of 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,518 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,522 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,523 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,523 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,534 INFO: WFI01: (RA, DEC, PA) := (150.00277777777777, -2.5, 27.000000000000913), detected as (150.00277777777777, -2.5, 26.999999999999638)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:35,540 INFO: Adding poisson noise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,004 INFO: Adding Poisson Noise with mean 0.005759307419619904 and standard deviation 19.015451719366883
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,006 INFO: Adding readnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,413 INFO: Adding readnoise with mean 0.0035705575719475746 and STDEV 11.99705696105957
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,414 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,453 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,454 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,493 INFO: Adding Dark residual with mean 1.0403887033462524 and standard deviation 5.5031046867370605
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:36,493 INFO: Adding cosmic ray residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,244 INFO: Adding Cosmic Ray residual with mean 0.4174855649471283 and standard deviation 4.254983901977539
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,253 INFO: Adding error to detector WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,253 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,254 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,254 INFO: Background is 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,254 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,255 INFO: Added background of 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,318 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,322 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,323 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,323 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,334 INFO: WFI02: (RA, DEC, PA) := (150.00285583855583, -2.6463679052675504, 27.000000000000913), detected as (150.00285583855583, -2.6463679052675504, 26.999999999999638)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,339 INFO: Adding poisson noise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,801 INFO: Adding Poisson Noise with mean 0.0056458809575566015 and standard deviation 18.96906220880454
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:38,803 INFO: Adding readnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:39,207 INFO: Adding readnoise with mean 0.0035705575719475746 and STDEV 11.99705696105957
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:39,208 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:39,245 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:39,245 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:39,283 INFO: Adding Dark residual with mean 1.0403887033462524 and standard deviation 5.5031046867370605
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:39,284 INFO: Adding cosmic ray residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,016 INFO: Adding Cosmic Ray residual with mean 0.4174855649471283 and standard deviation 4.254983901977539
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,025 INFO: Adding error to detector WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,025 INFO: Adding background
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,026 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,026 INFO: Background is 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,026 INFO: Returning background 0.24.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,027 INFO: Added background of 0.24 counts/s/pixel
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,070 INFO: Inserting correct exposure time
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,074 INFO: Cropping Down to base Detector Size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,075 INFO: Cropping convolved image down to detector size
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,075 INFO: Taking [22:4110, 22:4110]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,086 INFO: WFI03: (RA, DEC, PA) := (150.00299198916906, -2.777285221181246, 27.000000000000913), detected as (150.00299198916906, -2.777285221181246, 26.999999999999638)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,091 INFO: Adding poisson noise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,553 INFO: Adding Poisson Noise with mean 0.0056455466768935035 and standard deviation 18.969012473786897
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,555 INFO: Adding readnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,960 INFO: Adding readnoise with mean 0.0035705575719475746 and STDEV 11.99705696105957
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:41,961 INFO: Adding flatfield residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:42,001 INFO: Adding Flatfield residual with mean 1.0097910165786743 and standard deviation 0.0006765797734260559
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:42,001 INFO: Adding dark residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:42,039 INFO: Adding Dark residual with mean 1.0403887033462524 and standard deviation 5.5031046867370605
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:42,040 INFO: Adding cosmic ray residual
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,768 INFO: Adding Cosmic Ray residual with mean 0.4174855649471283 and standard deviation 4.254983901977539
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,778 INFO: Finished adding error
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,779 INFO: Finished Adding Error
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fits_file_2</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">params_2</span> <span class="o">=</span> <span class="n">obm_2</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="n">mosaic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output FITS file is </span><span class="si">{</span><span class="n">fits_file_2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,784 INFO: Converting to FITS file
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,785 INFO: Converting detector WFI01 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,786 INFO: Creating Extension HDU from AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,789 INFO: Created Extension HDU from AstroImage WFI01
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,789 INFO: Converting detector WFI02 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,790 INFO: Creating Extension HDU from AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,792 INFO: Created Extension HDU from AstroImage WFI02
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,792 INFO: Converting detector WFI03 to FITS extension
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,792 INFO: Creating Extension HDU from AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,794 INFO: Created Extension HDU from AstroImage WFI03
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:43,974 INFO: Created FITS file /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example2_1_0.fits
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Output FITS file is /home/runner/work/roman_notebooks/roman_notebooks/notebooks/stips/notebook_example2_1_0.fits
</pre></div>
</div>
</div>
</div>
<p>Below, we visualize two pointings side by side:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">fits_file_2</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig_2</span><span class="p">,</span> <span class="n">ax_2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
<span class="n">ax_2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f935eb2ee90&gt;
</pre></div>
</div>
<img alt="../../_images/b0f78e32cc825e8cc791a9727f240389329c23c5b548fb6c56a3d65bf56c5d33.png" src="../../_images/b0f78e32cc825e8cc791a9727f240389329c23c5b548fb6c56a3d65bf56c5d33.png" />
</div>
</div>
</section>
</section>
<section id="add-an-artifical-point-source-to-an-observation">
<h3>Add an Artifical Point Source to an Observation<a class="headerlink" href="#add-an-artifical-point-source-to-an-observation" title="Link to this heading">#</a></h3>
<p>With the STIPS <code class="docutils literal notranslate"><span class="pre">makePSF</span></code> utility, users can “clip” a PSF from a given detector pixel position in a scene and inject it elsewhere.</p>
<p>This is achieved by first applying a bi-linear interpolation of a 3x3 array from the STIPS PSF library to compute the best PSF at the specified integer SCA pixels, and then by performing bicubic interpolations over the PSF’s supersampled pixel grid to fill out its sub-pixel positions. The resulting PSF can then be injected in an existing scene or used to create new scenes.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">make_epsf_array()</span></code> method from STIPS’ <code class="docutils literal notranslate"><span class="pre">AstroImage</span></code> class to create an example PSF from the library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ai</span> <span class="o">=</span> <span class="n">AstroImage</span><span class="p">()</span>

<span class="n">ai</span><span class="o">.</span><span class="n">detector</span> <span class="o">=</span> <span class="s1">&#39;SCA01&#39;</span>
<span class="n">ai</span><span class="o">.</span><span class="n">filter</span> <span class="o">=</span> <span class="s1">&#39;F129&#39;</span>
<span class="n">test_psf</span> <span class="o">=</span> <span class="n">ai</span><span class="o">.</span><span class="n">make_epsf_array</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:48,003 INFO: WFI01: (RA, DEC, PA) := (0.0, 0.0, 0.0), detected as (0.0, 0.0, 0.0)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:48,008 INFO: PSF File psf_WFI_2.3_F129_sca01.fits to be put at /home/runner/psf_cache
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:48,009 INFO: PSF File is /home/runner/psf_cache/psf_WFI_2.3_F129_sca01.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:39:48,220 INFO: WFI01: Starting 3x3 PSF Grid creation at Thu Dec 11 19:39:48 2025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running instrument: WFI, filter: F129
  Running detector: WFI01
    Position 1/9: (0, 0) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 0) which is outside the range of the reference data; approximating to nearest interpolated point (31.993143027288347, 0.015652222616090228)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 1/9 centroid: (np.float64(87.68541919417059), np.float64(88.03481459910967))
    Position 2/9: (0, 2048) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 2048) which is outside the range of the reference data; approximating to nearest interpolated point (30.9911863199469, 2048.0151620285324)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 2/9 centroid: (np.float64(87.63328382510608), np.float64(88.02733538122686))
    Position 3/9: (0, 4095) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (0, 4095) which is outside the range of the reference data; approximating to nearest input grid point
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 3/9 centroid: (np.float64(87.58301233203386), np.float64(88.01899212396057))
    Position 4/9: (2048, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 4/9 centroid: (np.float64(87.69119843725669), np.float64(88.12253423286828))
    Position 5/9: (2048, 2048) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 5/9 centroid: (np.float64(87.63549224663767), np.float64(88.1306506582468))
    Position 6/9: (2048, 4095) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (2048, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (2048.0050174304056, 4074.4937619323296)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 6/9 centroid: (np.float64(87.60856529394864), np.float64(88.16422780816005))
    Position 7/9: (4095, 0) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 7/9 centroid: (np.float64(87.69736545139544), np.float64(88.21119913102282))
    Position 8/9: (4095, 2048) pixels
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 8/9 centroid: (np.float64(87.66556138528847), np.float64(88.26217961693057))
    Position 9/9: (4095, 4095) pixels
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attempted to get aberrations at field point (4095, 4095) which is outside the range of the reference data; approximating to nearest interpolated point (4095.004894881753, 4074.994618276213)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-12-11 19:40:40,925 INFO: WFI01: Finished PSF Grid creation at Thu Dec 11 19:40:40 2025
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Position 9/9 centroid: (np.float64(87.63478098231859), np.float64(88.3115054278644))
  Saving file: /home/runner/psf_cache/psf_WFI_2.3_F129_wfi01.fits
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">test_psf</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f935ea10b90&gt;
</pre></div>
</div>
<img alt="../../_images/022c9066b1486e06cea7e5f3aea1f3a9320d7b2b2c97fb627f88888709c5999e.png" src="../../_images/022c9066b1486e06cea7e5f3aea1f3a9320d7b2b2c97fb627f88888709c5999e.png" />
</div>
</div>
<p>Specify the pixel coordinates of the source’s center (which are just the center of the PSF in this case) and the pixel length of the intended cutout (1/8th of the full example PSF’s pixel length).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psf_mid_pixel</span> <span class="o">=</span> <span class="p">(</span><span class="n">test_psf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
<span class="n">boxsize</span> <span class="o">=</span> <span class="n">test_psf</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">//</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
<p>Inject the source at pixel (2000, 2000) with an arbitrary flux of 3000 DN/sec in a copy of the simulated image from the second observation simulated above. Can you see the newly injected PSF in the comparison plot?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_3</span> <span class="o">=</span> <span class="n">img_2</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">xpix</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">ypix</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">flux</span> <span class="o">=</span> <span class="mi">3000</span>

<span class="n">img_3_inj</span> <span class="o">=</span> <span class="n">stips</span><span class="o">.</span><span class="n">utilities</span><span class="o">.</span><span class="n">makePSF</span><span class="o">.</span><span class="n">place_source</span><span class="p">(</span><span class="n">xpix</span><span class="p">,</span> <span class="n">ypix</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">img_3</span><span class="p">,</span>
                                                 <span class="n">test_psf</span><span class="p">,</span> <span class="n">boxsize</span><span class="o">=</span><span class="n">boxsize</span><span class="p">,</span>
                                                 <span class="n">psf_center</span><span class="o">=</span><span class="n">psf_mid_pixel</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_3</span><span class="p">,</span> <span class="n">ax_3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_2</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>
<span class="n">ax_3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_3_inj</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bone&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ax_3</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">xpix</span><span class="p">,</span> <span class="n">ypix</span><span class="p">),</span> <span class="mi">75</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.7</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/bf30c6260a32e48fa5fba2224ffd4036d9d4d4f8c384c759e6871343490a493d.png" src="../../_images/bf30c6260a32e48fa5fba2224ffd4036d9d4d4f8c384c759e6871343490a493d.png" />
</div>
</div>
</section>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The Roman User Documentation’s <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/stips-space-telescope-imaging-product-simulator/overview-of-stips">“STIPS Overview”</a> page and associated tutorials.</p></li>
<li><p>The latest version of the <a class="reference external" href="https://stips.readthedocs.io/en/latest/">STIPS documentation</a> on ReadTheDocs.</p></li>
<li><p>The <a class="reference external" href="https://roman-docs.stsci.edu/roman-help-desk-at-stsci">Roman Help Desk</a>, an official outlet for user questions about STIPS.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p><strong>Author:</strong> Justin Otor, Eunkyu Han<br />
<strong>Updated On:</strong> 2025-01-08</p>
<table width="100%" style="border:none; border-collapse:collapse;">
  <tr style="border:none;">
    <td style="border:none; width:180px; white-space:nowrap;">
       <a href="#top" style="text-decoration:none; color:#0066cc;">↑ Top of page</a> 
    </td>
    <td style="border:none; text-align:center;">
       <img src="../../roman_logo.png" width="50">
    </td>
    <td style="border:none; text-align:right;">
       <img src="../../stsci_logo2.png" width="90">
    </td>
  </tr>
</table></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/roman_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "roman-cal"
        },
        kernelOptions: {
            name: "roman-cal",
            path: "./notebooks/stips"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'roman-cal'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../rist/rist.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">The Roman Interactive Sensitivity Tool (RIST)</p>
      </div>
    </a>
    <a class="right-next"
       href="../stpsf/stpsf.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">STPSF Tutorial</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-information-and-read-only-status">Kernel Information and Read-Only Status</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#environment-report">Environment report</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-stips-usage">Basic STIPS Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-simple-astronomical-scene">Create a Simple Astronomical Scene</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simulate-an-image">Simulate an Image</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-scenes-using-stips-built-in-functions">Generate Scenes Using STIPS Built-In Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-stellar-population">Create a Stellar Population</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-galactic-population">Create a Galactic Population</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up-an-observation-first-pointing">Set up an Observation (First Pointing)</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modify-an-observation-by-adding-a-second-pointing">Modify an Observation (by Adding a Second Pointing)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#add-an-artifical-point-source-to-an-observation">Add an Artifical Point Source to an Observation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>