
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How to Open Roman Data Files (ASDF) &#8212; STScI Roman Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/working_with_asdf/working_with_asdf';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Roman WFI Synthetic Photometry with synphot" href="../synphot/synphot.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/stsci_logo2.png" class="logo__image only-light" alt="STScI Roman Notebooks - Home"/>
    <script>document.write(`<img src="../../_static/stsci_logo2.png" class="logo__image only-dark" alt="STScI Roman Notebooks - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    Nancy Grace Roman Space Telescope Notebooks
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../aperture_photometry/aperture_photometry.html">Aperture Photometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../background_visualization_tool/RBVT.html">The Roman Background Visualization Tool (RBVT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_discovery_and_access/data_discovery_and_access.html">Roman Research Nexus Data Discovery and Access in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../exposure_pipeline/exposure_pipeline.html">Calibrating WFI Exposures with RomanCal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../footprint_visualization/footprint_visualization.html">Visualization of Roman APT products</a></li>

<li class="toctree-l1"><a class="reference internal" href="../grism_spectral_extraction/grism_spectral_extraction.html">Roman Spectroscopy: Grism Spectral Extraction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../measuring_galaxy_shapes/measuring_galaxy_shapes.html">Measuring Galaxy Shapes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rist/rist.html">The Roman Interactive Sensitivity Tool (RIST)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../romanisim/romanisim.html">Simulating WFI Imaging Data with Roman I-Sim</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stips/stips.html">STIPS Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stpsf/stpsf.html">STPSF Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../synphot/synphot.html">Roman WFI Synthetic Photometry with synphot</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">How to Open Roman Data Files (ASDF)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/spacetelescope/roman_notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/spacetelescope/roman_notebooks/issues/new?title=Issue%20on%20page%20%2Fnotebooks/working_with_asdf/working_with_asdf.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/working_with_asdf/working_with_asdf.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>How to Open Roman Data Files (ASDF)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-information-and-read-only-status">Kernel Information and Read-Only Status</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-start">Quick start</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-metadata">Exploring metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#taking-advantage-of-astropy-time-time-objects-in-the-metadata">Taking advantage of <code class="docutils literal notranslate"><span class="pre">astropy.time.Time</span></code> objects in the metadata</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-wcs-information">Accessing WCS Information</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-roman-data-using-the-asdf-library">Reading Roman data using the ASDF library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="how-to-open-roman-data-files-asdf">
<h1>How to Open Roman Data Files (ASDF)<a class="headerlink" href="#how-to-open-roman-data-files-asdf" title="Link to this heading">#</a></h1>
<hr class="docutils" />
<section id="kernel-information-and-read-only-status">
<h2>Kernel Information and Read-Only Status<a class="headerlink" href="#kernel-information-and-read-only-status" title="Link to this heading">#</a></h2>
<p>To run this notebook, please select the “Roman Calibration” kernel at the top right of your window.</p>
<p>This notebook is read-only. You can run cells and make edits, but you must save changes to a different location. We recommend saving the notebook within your home directory, or to a new folder within your home (e.g. <span style="font-variant:small-caps;">file &gt; save notebook as &gt; my-nbs/nb.ipynb</span>). Note that a directory must exist before you attempt to add a notebook to it.</p>
</section>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><em>numpy</em> for array operations</p></li>
<li><p><em>asdf</em> for ASDF input/output</p></li>
<li><p><em>roman_datamodels</em> to handle input/output and validation of data models</p></li>
<li><p><em>matplotlib.pyplot</em> for plotting data</p></li>
<li><p><em>astropy.units</em> to handle units</p></li>
<li><p><em>astropy.time</em> to handle time</p></li>
<li><p><em>astropy.coordinates</em> to handle celestial coordinates</p></li>
<li><p><em>pprint</em> for enhanced printing</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asdf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">roman_datamodels</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rdm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">roman_datamodels.dqflags</span><span class="w"> </span><span class="kn">import</span> <span class="n">pixel</span> <span class="k">as</span> <span class="n">dqflags</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.coordinates</span><span class="w"> </span><span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pprint</span><span class="w"> </span><span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">s3fs</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>The main goal of this notebook is to illustrate how to open and handle Roman Wide Field Instrument (WFI) data. WFI data are stored in <a class="reference external" href="https://asdf-standard.readthedocs.io/">Advanced Scientific Data Format (ASDF)</a> files, which combine human-readable hierarchical metadata structure with binary array data. ASDF files are self-validating using pre-defined schema.</p>
<p>There are tools to interact with ASDF files in Python, Julia, C/C++, and IDL. In this example we focus on the Python interface.</p>
<p>Roman ASDF files can be opened and manipulated using two main approaches:</p>
<ol class="arabic simple">
<li><p>using the <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code> library, and</p></li>
<li><p>using the <code class="docutils literal notranslate"><span class="pre">asdf</span></code> library.</p></li>
</ol>
<p>Using <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code> offers the advantage of loading different data blocks as <code class="docutils literal notranslate"><span class="pre">stnode</span></code>-based objects, providing access to their methods. In contrast, the <code class="docutils literal notranslate"><span class="pre">asdf</span></code> library loads the data blocks as they were serialized on disk. While this approach loses some of the <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code> capabilities, it also provides more flexibility. In this notebook, we illustrate both approaches, starting with loading data via <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code>.</p>
<p>Additional information about Roman ASDF files can be found in the <a class="reference external" href="https://roman-docs.stsci.edu/data-handbook-home/wfi-data-format/introduction-to-asdf">Introduction to ASDF</a> article on RDox.</p>
</section>
<hr class="docutils" />
<section id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Link to this heading">#</a></h2>
<p>All Roman data products conform to one of the datamodels described by the <a class="reference external" href="https://roman-datamodels.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code></a> package. This package wraps the <code class="docutils literal notranslate"><span class="pre">asdf</span></code> library and provides utilities to read and save data conforming to the official data models. We illustrate how to use <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code> to load data from an ASDF file containing simulated Roman data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asdf_dir_uri</span> <span class="o">=</span> <span class="s1">&#39;s3://stpubdata/roman/nexus/soc_simulations/tutorial_data/&#39;</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">s3fs</span><span class="o">.</span><span class="n">S3FileSystem</span><span class="p">(</span><span class="n">anon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">asdf_file_uri_l2</span> <span class="o">=</span> <span class="n">asdf_dir_uri</span> <span class="o">+</span> <span class="s1">&#39;r0003201001001001004_0001_wfi01_f106_cal.asdf&#39;</span>

<span class="k">with</span> <span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">asdf_file_uri_l2</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="n">af</span> <span class="o">=</span> <span class="n">asdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">rdm</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">af</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that we used the <code class="docutils literal notranslate"><span class="pre">asdf.open()</span></code> command to open the byte stream, and then passed that object to <code class="docutils literal notranslate"><span class="pre">roman_datamodels.open()</span></code>. This is necessary at present as <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code> does not allow for reading of a byte stream in this manner.</p>
<p>A high-level summary of the file can be retrieved by using the <code class="docutils literal notranslate"><span class="pre">info()</span></code> method. We have limited the number of rows printed to 30, but if you want to see all rows, you can change that number to your liking or to <code class="docutils literal notranslate"><span class="pre">None</span></code> in order to see all rows. There is a similar option for <code class="docutils literal notranslate"><span class="pre">max_cols</span></code> if you want to change the horizontal cutoff per line. The default number of rows and columns is 24 and 120, respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">max_rows</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root (AsdfObject)
├─asdf_library (Software)
│ ├─author (str): The ASDF Developers
│ ├─homepage (str): http://github.com/asdf-format/asdf
│ ├─name (str): asdf
│ └─version (str): 4.1.0
├─history (dict)
│ └─extensions (list)
│   ├─[0] (ExtensionMetadata) ...
│   ├─[1] (ExtensionMetadata) ...
│   ├─[2] (ExtensionMetadata) ...
│   └─4 not shown
└─roman (WfiImage) # Level 2 (L2) Calibrated Roman Wide Field Instrument (WFI) Rate Image.
  ├─meta (dict) ...
  ├─data (ndarray) # Science Data (DN/s) or (MJy/sr) ...
  ├─dq (ndarray) # Data Quality ...
  ├─err (ndarray) # Error (DN / s) or (MJy / sr) ...
  ├─var_poisson (ndarray) # Poisson Variance (DN^2/s^2) or (MJy^2/sr^2) ...
  ├─var_rnoise (ndarray) # Read Noise Variance (DN^2/s^2) or (MJy^2/sr^2) ...
  ├─var_flat (ndarray) # Flat Field Variance (DN^2/s^2) or (MJy^2/sr^2) ...
  ├─amp33 (ndarray) # Amplifier 33 Reference Pixel Data (DN) ...
  ├─border_ref_pix_left (ndarray) # Left-Edge Border Reference Pixels (DN) ...
  ├─border_ref_pix_right (ndarray) # Right-Edge Border Reference Pixels (DN) ...
  ├─border_ref_pix_top (ndarray) # Border Reference Pixels on the Top of the Detector (DN) ...
  ├─border_ref_pix_bottom (ndarray) # Bottom-Edge Border Reference Pixels (DN) ...
  ├─dq_border_ref_pix_left (ndarray) # Left-Edge Border Reference Pixel Data Quality (DN) ...
  ├─dq_border_ref_pix_right (ndarray) # Right-Edge Border Reference Pixel Data Quality (DN) ...
  ├─dq_border_ref_pix_top (ndarray) # Border Reference Pixel Data Quality on the Top of the Detector (DN) ...
  └─dq_border_ref_pix_bottom (ndarray) # Bottom-Edge Border Reference Pixel Data Quality (DN) ...
Some nodes not shown.
</pre></div>
</div>
</div>
</div>
<p>Note that, by default, the <code class="docutils literal notranslate"><span class="pre">open()</span></code> method does not load the data in memory unless told to do so explicitly, which makes opening ASDF files a quick operation.</p>
<p>At this point, we have information about the names and types of the different data blocks, but we don’t have access to the data until we load them, which we can do by using them. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.3828592 , 0.7190066 , 0.57954526, ..., 0.82491654, 0.54798466,
        0.7596621 ],
       [0.48790407, 0.5191181 , 0.68121314, ..., 0.8290943 , 0.7378703 ,
        0.31645823],
       [0.65960026, 0.62473404, 0.7867249 , ..., 0.63130987, 0.67372173,
        0.56940955],
       ...,
       [0.69034207, 1.0855403 , 0.6050965 , ..., 0.75234616, 0.7595161 ,
        0.77993363],
       [0.66153103, 0.7590605 , 0.6202591 , ..., 0.6739805 , 0.33642223,
        0.6299567 ],
       [0.6038647 , 0.9196994 , 0.8665242 , ..., 0.        , 0.        ,
        0.55580723]], shape=(4088, 4088), dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>An ASDF object can be used, effectively, like a nested dictionary. Each block can be explored via the <code class="docutils literal notranslate"><span class="pre">.keys()</span></code> attribute. For example, we can retrieve the list of keys in a Level 2 calibrated rate image file as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>meta
data
dq
err
var_poisson
var_rnoise
var_flat
amp33
border_ref_pix_left
border_ref_pix_right
border_ref_pix_top
border_ref_pix_bottom
dq_border_ref_pix_left
dq_border_ref_pix_right
dq_border_ref_pix_top
dq_border_ref_pix_bottom
</pre></div>
</div>
</div>
</div>
<p>We can also find all of the keys within one of these blocks, such as the metadata. Note that here we are using the dot syntax notation (i.e., <code class="docutils literal notranslate"><span class="pre">f.meta</span></code>) to retrieve the metadata. You can also use brackets to subscript the datamodel (e.g., <code class="docutils literal notranslate"><span class="pre">f['meta']</span></code>). Dot syntax is allowed by datamodel objects in <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code>, whereas ASDF objects (shown later in the tutorial) can only use the bracket subscript notation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>asn
cal_logs
cal_step
calibration_software_name
calibration_software_version
coordinates
ephemeris
exposure
exptype
file_date
filename
group_id
guide_star
instrument
model_type
observation
origin
photometry
pointing
prd_version
product_type
program
rcs
ref_file
sdf_software_version
source_catalog
telescope
velocity_aberration
visit
wcs
wcs_fit_results
wcsinfo
</pre></div>
</div>
</div>
</div>
<p>We focus on the data block, containing the science image of interest. First, how do we know which array in the file is the primary data array? It could have any name, for example “data” or “science.” If we are not sure, we can ask the file itself:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">get_primary_array_name</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data&#39;
</pre></div>
</div>
</div>
</div>
<p>The creators of the datamodel have told us explicitly that the primary array name in this case is “data.” This may not be true for all Roman WFI ASDF files (e.g., calibration reference files), so it is always worth checking if you are not sure. Next, let’s look at the type of the <code class="docutils literal notranslate"><span class="pre">data</span></code> block:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numpy.ndarray
</pre></div>
</div>
</div>
</div>
<p>Note that Roman images are expressed as <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> objects. The units are available in the schema descriptions for the arrays (see below), but quickly the data arrays are:</p>
<ul class="simple">
<li><p>Level 1 (L1; uncalibrated 3-D ramp cubes) are in units of Data Numbers (DN)</p></li>
<li><p>Level 2 (L2; calibrated 2-D rate images) are in units of DNs per second (DN/s)</p></li>
<li><p>Level 3 (L3; 2-D mosaic co-adds) are in units of megaJanskys per steradian (MJy/sr)</p></li>
</ul>
<p>Error arrays are in the same units as data, and variance arrays are the same units squared (e.g., DN^2 / s^2).</p>
<p>Let’s take a look at the size of our image and some sample values in a small 3x3 cutout from the bottom-left corner of the array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Size of f.data: &#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Exploring the values of f.data: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Size of f.data:  (4088, 4088)

Exploring the values of f.data: 
 [[0.3828592  0.7190066  0.57954526]
 [0.48790407 0.5191181  0.68121314]
 [0.65960026 0.62473404 0.7867249 ]]
</pre></div>
</div>
</div>
</div>
<p>Since we have image data, let’s also take a quick look at what the image actually contains. This is quite simple, and a more detailed explanation about visualizing Roman ASDF files can be found in the <a class="reference internal" href="#../data_visualization/data_visualization.ipynb"><span class="xref myst">Data Visualization</span></a> tutorial. Below is a 1,000 x 1,000 pixel section of the data array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="p">[:</span><span class="mi">1000</span><span class="p">,</span> <span class="p">:</span><span class="mi">1000</span><span class="p">],</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/39de337161e123b3e22089b2443bd669136e60fd357782cb71fb347bfc457714.png" src="../../_images/39de337161e123b3e22089b2443bd669136e60fd357782cb71fb347bfc457714.png" />
</div>
</div>
<p>As with array data stored in other file types, we can perform analyses on the arrays in memory. For example, we can check the image content by building a 1-D histogram of the its values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixel Value&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;N / 1000&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4e79a8ce49fdff389414f6c53dd83ecce88765684e9d5b7319076840ba4f96fe.png" src="../../_images/4e79a8ce49fdff389414f6c53dd83ecce88765684e9d5b7319076840ba4f96fe.png" />
</div>
</div>
<p>We can explore other data blocks such as the data quality (DQ) array. The values of the DQ array are the bitwise sum of the individual flags representing specific effects. These flags are defined in the <a class="reference external" href="https://roman-pipeline.readthedocs.io/en/latest/roman/references_general/references_general.html#data-quality-flags">RomanCal documentation</a>. These can also be retrieved from <code class="docutils literal notranslate"><span class="pre">roman_datamodels.dqflags.pixel()</span></code>. As a reminder, we aliased <code class="docutils literal notranslate"><span class="pre">roman_datamodels.dqflags.pixel()</span></code> in our import statement at the start of the tutorial as <code class="docutils literal notranslate"><span class="pre">dqflags()</span></code>. Let’s start by making a list of all of the unique values in the DQ array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">unique_dq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">unique_dq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[       0        1        4     1025     1027     1029     8192     8195
     8196     8197     9217     9219     9221    65536    65537    65539
    65540    66561    66563    66565    73728    73729    73732    74753
    74757  1048576  1048577  1049601  1056768  1056769  1057793  1114112
  1114113  1115137  1122304  1122305  1123329 33554432 33554433 33554436
 33554437 33555457 33555459 33555461 33562624 33562625 33562627 33562628
 33562629 33563649 33563651 33563653 33619968 33619969 33619971 33619972
 33619973 33620993 33620995 33620997 33628160 33628161 33628163 33628164
 33628165 33629185 33629187 33629189 34603008 34603009 34604033 34604035
 34604037 34611200 34611201 34611203 34612225 34612227 34612229 34668544
 34668545 34669569 34669571 34676736 34676737 34676739 34677761 34677763]
</pre></div>
</div>
</div>
</div>
<p>Now that we have the list of unique DQ values, we can decompose the values into individual flags and print the number of pixels with each unique DQ value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="p">)</span>

<span class="c1"># Number of good pixels</span>
<span class="n">npix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="o">==</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Flag 0 (affected pixels = </span><span class="si">{</span><span class="n">npix</span><span class="si">}</span><span class="s1">; </span><span class="si">{</span><span class="n">npix</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">size</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">))&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;0: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">dqflags</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Pixels with non-zero DQ flags</span>
<span class="k">for</span> <span class="n">uu</span> <span class="ow">in</span> <span class="n">unique_dq</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="n">br</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">binary_repr</span><span class="p">(</span><span class="n">uu</span><span class="p">)</span>
    <span class="n">npix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="o">==</span><span class="n">uu</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Flag </span><span class="si">{</span><span class="n">uu</span><span class="si">}</span><span class="s1"> (affected pixels = </span><span class="si">{</span><span class="n">npix</span><span class="si">}</span><span class="s1">; </span><span class="si">{</span><span class="n">npix</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">size</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">cc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">br</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">2</span><span class="o">**</span><span class="n">ii</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">dqflags</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">ii</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 0 (affected pixels = 16045479; 96.01%))
0: GOOD
------------
Flag 1 (affected pixels = 4; 0.00%)
1: DO_NOT_USE
------------
Flag 4 (affected pixels = 4446; 0.03%)
4: JUMP_DET
------------
Flag 1025 (affected pixels = 1439; 0.01%)
1: DO_NOT_USE
1024: DEAD
------------
Flag 1027 (affected pixels = 33; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
------------
Flag 1029 (affected pixels = 92; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
------------
Flag 8192 (affected pixels = 642834; 3.85%)
8192: LOW_QE
------------
Flag 8195 (affected pixels = 1; 0.00%)
1: DO_NOT_USE
2: SATURATED
8192: LOW_QE
------------
Flag 8196 (affected pixels = 188; 0.00%)
4: JUMP_DET
8192: LOW_QE
------------
Flag 8197 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
8192: LOW_QE
------------
Flag 9217 (affected pixels = 182; 0.00%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
------------
Flag 9219 (affected pixels = 4; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
8192: LOW_QE
------------
Flag 9221 (affected pixels = 14; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
8192: LOW_QE
------------
Flag 65536 (affected pixels = 183; 0.00%)
65536: NONLINEAR
------------
Flag 65537 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
65536: NONLINEAR
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 65539 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
2: SATURATED
65536: NONLINEAR
------------
Flag 65540 (affected pixels = 4; 0.00%)
4: JUMP_DET
65536: NONLINEAR
------------
Flag 66561 (affected pixels = 121; 0.00%)
1: DO_NOT_USE
1024: DEAD
65536: NONLINEAR
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 66563 (affected pixels = 5; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
65536: NONLINEAR
------------
Flag 66565 (affected pixels = 21; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
65536: NONLINEAR
------------
Flag 73728 (affected pixels = 96; 0.00%)
8192: LOW_QE
65536: NONLINEAR
------------
Flag 73729 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
65536: NONLINEAR
------------
Flag 73732 (affected pixels = 2; 0.00%)
4: JUMP_DET
8192: LOW_QE
65536: NONLINEAR
------------
Flag 74753 (affected pixels = 88; 0.00%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
------------
Flag 74757 (affected pixels = 3; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
------------
Flag 1048576 (affected pixels = 213; 0.00%)
1048576: NO_LIN_CORR
------------
Flag 1048577 (affected pixels = 161; 0.00%)
1: DO_NOT_USE
1048576: NO_LIN_CORR
------------
Flag 1049601 (affected pixels = 80; 0.00%)
1: DO_NOT_USE
1024: DEAD
1048576: NO_LIN_CORR
------------
Flag 1056768 (affected pixels = 38; 0.00%)
8192: LOW_QE
1048576: NO_LIN_CORR
------------
Flag 1056769 (affected pixels = 33; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
1048576: NO_LIN_CORR
------------
Flag 1057793 (affected pixels = 8; 0.00%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
1048576: NO_LIN_CORR
------------
Flag 1114112 (affected pixels = 37; 0.00%)
65536: NONLINEAR
1048576: NO_LIN_CORR
------------
Flag 1114113 (affected pixels = 28; 0.00%)
1: DO_NOT_USE
65536: NONLINEAR
1048576: NO_LIN_CORR
------------
Flag 1115137 (affected pixels = 15; 0.00%)
1: DO_NOT_USE
1024: DEAD
65536: NONLINEAR
1048576: NO_LIN_CORR
------------
Flag 1122304 (affected pixels = 20; 0.00%)
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 1122305 (affected pixels = 8; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
------------
Flag 1123329 (affected pixels = 9; 0.00%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
------------
Flag 33554432 (affected pixels = 1217; 0.01%)
33554432: UNRELIABLE_FLAT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 33554433 (affected pixels = 16; 0.00%)
1: DO_NOT_USE
33554432: UNRELIABLE_FLAT
------------
Flag 33554436 (affected pixels = 135; 0.00%)
4: JUMP_DET
33554432: UNRELIABLE_FLAT
------------
Flag 33554437 (affected pixels = 33; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
33554432: UNRELIABLE_FLAT
------------
Flag 33555457 (affected pixels = 1067; 0.01%)
1: DO_NOT_USE
1024: DEAD
33554432: UNRELIABLE_FLAT
------------
Flag 33555459 (affected pixels = 51; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
33554432: UNRELIABLE_FLAT
------------
Flag 33555461 (affected pixels = 126; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
33554432: UNRELIABLE_FLAT
------------
Flag 33562624 (affected pixels = 254; 0.00%)
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33562625 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33562627 (affected pixels = 10; 0.00%)
1: DO_NOT_USE
2: SATURATED
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33562628 (affected pixels = 108; 0.00%)
4: JUMP_DET
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33562629 (affected pixels = 46; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33563649 (affected pixels = 24; 0.00%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33563651 (affected pixels = 208; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33563653 (affected pixels = 13; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
8192: LOW_QE
33554432: UNRELIABLE_FLAT
------------
Flag 33619968 (affected pixels = 274; 0.00%)
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33619969 (affected pixels = 9; 0.00%)
1: DO_NOT_USE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33619971 (affected pixels = 9; 0.00%)
1: DO_NOT_USE
2: SATURATED
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33619972 (affected pixels = 20; 0.00%)
4: JUMP_DET
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 33619973 (affected pixels = 7; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33620993 (affected pixels = 47; 0.00%)
1: DO_NOT_USE
1024: DEAD
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33620995 (affected pixels = 6; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 33620997 (affected pixels = 8; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33628160 (affected pixels = 20; 0.00%)
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33628161 (affected pixels = 3; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33628163 (affected pixels = 4; 0.00%)
1: DO_NOT_USE
2: SATURATED
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33628164 (affected pixels = 6; 0.00%)
4: JUMP_DET
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33628165 (affected pixels = 7; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33629185 (affected pixels = 14; 0.00%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33629187 (affected pixels = 4; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 33629189 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
33554432: UNRELIABLE_FLAT
------------
Flag 34603008 (affected pixels = 127; 0.00%)
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34603009 (affected pixels = 5; 0.00%)
1: DO_NOT_USE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34604033 (affected pixels = 1248; 0.01%)
1: DO_NOT_USE
1024: DEAD
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34604035 (affected pixels = 1665; 0.01%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34604037 (affected pixels = 1; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34611200 (affected pixels = 33; 0.00%)
8192: LOW_QE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34611201 (affected pixels = 3; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34611203 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
2: SATURATED
8192: LOW_QE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34612225 (affected pixels = 1519; 0.01%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 34612227 (affected pixels = 668; 0.00%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
8192: LOW_QE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34612229 (affected pixels = 1; 0.00%)
1: DO_NOT_USE
4: JUMP_DET
1024: DEAD
8192: LOW_QE
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34668544 (affected pixels = 34; 0.00%)
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------------
Flag 34668545 (affected pixels = 21; 0.00%)
1: DO_NOT_USE
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34669569 (affected pixels = 447; 0.00%)
1: DO_NOT_USE
1024: DEAD
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34669571 (affected pixels = 2298; 0.01%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34676736 (affected pixels = 153; 0.00%)
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34676737 (affected pixels = 35; 0.00%)
1: DO_NOT_USE
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34676739 (affected pixels = 2; 0.00%)
1: DO_NOT_USE
2: SATURATED
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34677761 (affected pixels = 943; 0.01%)
1: DO_NOT_USE
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
------------
Flag 34677763 (affected pixels = 2892; 0.02%)
1: DO_NOT_USE
2: SATURATED
1024: DEAD
8192: LOW_QE
65536: NONLINEAR
1048576: NO_LIN_CORR
33554432: UNRELIABLE_FLAT
</pre></div>
</div>
</div>
</div>
<p>If we want to get a report of how many pixels are impacted by specific DQ flags (e.g., all saturated pixels) regardless of other flags set, we can do that, too using the Python <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> operator (bitwise AND) and the bitwise left shift <code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code> operator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bit</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">definition</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dqflags</span><span class="p">(</span><span class="n">bit</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">n_pix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bit</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Bit value </span><span class="si">{</span><span class="n">bit</span><span class="si">}</span><span class="s1"> corresponds to </span><span class="si">{</span><span class="n">definition</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of </span><span class="si">{</span><span class="n">definition</span><span class="si">}</span><span class="s1"> pixels: </span><span class="si">{</span><span class="n">n_pix</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">n_pix</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">f</span><span class="o">.</span><span class="n">dq</span><span class="o">.</span><span class="n">size</span><span class="si">:</span><span class="s1">.2%</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bit value 2 corresponds to SATURATED
Number of SATURATED pixels: 5,285 (0.03%)
</pre></div>
</div>
</div>
</div>
</section>
<section id="exploring-metadata">
<h2>Exploring metadata<a class="headerlink" href="#exploring-metadata" title="Link to this heading">#</a></h2>
<p>One of the advantages of ASDF is its extensibility, and the ability to store human-readable hierarchical metadata. Let’s further explore the metadata.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;meta&#39;</span><span class="p">]</span>
<span class="nb">type</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict
</pre></div>
</div>
</div>
</div>
<p>As we can see, <code class="docutils literal notranslate"><span class="pre">meta</span></code> is a dictionary type object. What if instead of using the bracket notation we use the dot notation discussed previously?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">meta</span>
<span class="nb">type</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>roman_datamodels.stnode._node.DNode
</pre></div>
</div>
</div>
</div>
<p>Suddenly it’s a <code class="docutils literal notranslate"><span class="pre">roman_datamodels.stnode._node.DNode</span></code> object! Despite this difference in object type, we can treat both this and a dictionary the same in most ways. However, an advantage of the dot syntax and the <code class="docutils literal notranslate"><span class="pre">roman_datamodels.stnode._node.DNode</span></code> object is that we retain information about the schema, which we lose if we convert the metadata to a dictionary object. We previously showed how to get the list of keys in the metadata, but as a reminder let’s do it again here for easy reference:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">meta</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>asn
cal_logs
cal_step
calibration_software_name
calibration_software_version
coordinates
ephemeris
exposure
exptype
file_date
filename
group_id
guide_star
instrument
model_type
observation
origin
photometry
pointing
prd_version
product_type
program
rcs
ref_file
sdf_software_version
source_catalog
telescope
velocity_aberration
visit
wcs
wcs_fit_results
wcsinfo
</pre></div>
</div>
</div>
</div>
<p>Printing the whole of the metadata is quite long, so we will instead print a small subsection:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">instrument</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;detector&#39;: &#39;WFI01&#39;, &#39;optical_element&#39;: &#39;F106&#39;, &#39;name&#39;: &#39;WFI&#39;}
</pre></div>
</div>
</div>
</div>
<p>As shown above, the <code class="docutils literal notranslate"><span class="pre">meta</span></code> data block contains a lot of useful metadata information. Two of the most typical keys, for example, are the <code class="docutils literal notranslate"><span class="pre">wcs</span></code> key, containing information about the World Coordinate System (WCS; see below), and also the <code class="docutils literal notranslate"><span class="pre">photometry</span></code> key, containing information about how to transform units from instrumental (DN/s) to physical (MJy/sr).</p>
<p>Let’s take a look at the schema information for <code class="docutils literal notranslate"><span class="pre">meta.instrument</span></code>. Note that this can be quite difficult to read, but is very rich in information about the contents, data types, allowed values, and mapping to other information (e.g., the storage location of a metadata field in the MAST Archive Catalog database) for every component of Roman WFI ASDF files. Also notice that we use the <code class="docutils literal notranslate"><span class="pre">pprint()</span></code> function (instead of <code class="docutils literal notranslate"><span class="pre">print()</span></code>) to better display the text.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">instrument</span><span class="o">.</span><span class="n">get_schema</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;$schema&#39;: &#39;asdf://stsci.edu/datamodels/roman/schemas/rad_schema-1.0.0&#39;,
 &#39;flowStyle&#39;: &#39;block&#39;,
 &#39;id&#39;: &#39;asdf://stsci.edu/datamodels/roman/schemas/wfi_mode-1.0.0&#39;,
 &#39;properties&#39;: {&#39;detector&#39;: {&#39;allOf&#39;: [{&#39;$schema&#39;: &#39;asdf://stsci.edu/datamodels/roman/schemas/rad_schema-1.0.0&#39;,
                                        &#39;enum&#39;: [&#39;WFI01&#39;,
                                                 &#39;WFI02&#39;,
                                                 &#39;WFI03&#39;,
                                                 &#39;WFI04&#39;,
                                                 &#39;WFI05&#39;,
                                                 &#39;WFI06&#39;,
                                                 &#39;WFI07&#39;,
                                                 &#39;WFI08&#39;,
                                                 &#39;WFI09&#39;,
                                                 &#39;WFI10&#39;,
                                                 &#39;WFI11&#39;,
                                                 &#39;WFI12&#39;,
                                                 &#39;WFI13&#39;,
                                                 &#39;WFI14&#39;,
                                                 &#39;WFI15&#39;,
                                                 &#39;WFI16&#39;,
                                                 &#39;WFI17&#39;,
                                                 &#39;WFI18&#39;],
                                        &#39;id&#39;: &#39;asdf://stsci.edu/datamodels/roman/schemas/wfi_detector-1.0.0&#39;,
                                        &#39;title&#39;: &#39;WFI Detector Name&#39;,
                                        &#39;type&#39;: &#39;string&#39;}],
                             &#39;archive_catalog&#39;: {&#39;datatype&#39;: &#39;nvarchar(10)&#39;,
                                                 &#39;destination&#39;: [&#39;WFIExposure.detector&#39;,
                                                                 &#39;GuideWindow.detector&#39;,
                                                                 &#39;WFICommon.detector&#39;]},
                             &#39;description&#39;: &#39;Name of the Wide Field Instrument &#39;
                                            &#39;(WFI) detector used\n&#39;
                                            &#39;to take the science data in this &#39;
                                            &#39;file.\n&#39;,
                             &#39;maxLength&#39;: 10,
                             &#39;sdf&#39;: {&#39;source&#39;: {&#39;origin&#39;: &#39;TBD&#39;},
                                     &#39;special_processing&#39;: &#39;VALUE_REQUIRED&#39;},
                             &#39;title&#39;: &#39;Wide Field Instrument (WFI) Detector &#39;
                                      &#39;Identifier&#39;},
                &#39;name&#39;: {&#39;archive_catalog&#39;: {&#39;datatype&#39;: &#39;nvarchar(5)&#39;,
                                             &#39;destination&#39;: [&#39;WFIExposure.instrument_name&#39;,
                                                             &#39;GuideWindow.instrument_name&#39;,
                                                             &#39;WFICommon.instrument_name&#39;]},
                         &#39;description&#39;: &#39;Name of the instrument used to &#39;
                                        &#39;acquire the science\n&#39;
                                        &#39;data.\n&#39;,
                         &#39;enum&#39;: [&#39;WFI&#39;],
                         &#39;maxLength&#39;: 5,
                         &#39;sdf&#39;: {&#39;source&#39;: {&#39;origin&#39;: &#39;TBD&#39;},
                                 &#39;special_processing&#39;: &#39;VALUE_REQUIRED&#39;},
                         &#39;title&#39;: &#39;Instrument Name&#39;,
                         &#39;type&#39;: &#39;string&#39;},
                &#39;optical_element&#39;: {&#39;allOf&#39;: [{&#39;$schema&#39;: &#39;asdf://stsci.edu/datamodels/roman/schemas/rad_schema-1.0.0&#39;,
                                               &#39;description&#39;: &#39;Name of the &#39;
                                                              &#39;filter element &#39;
                                                              &#39;used. See the &#39;
                                                              &#39;RDox Optical &#39;
                                                              &#39;Element page &#39;
                                                              &#39;for more\n&#39;
                                                              &#39;details on &#39;
                                                              &#39;available &#39;
                                                              &#39;optical &#39;
                                                              &#39;elements and &#39;
                                                              &#39;their &#39;
                                                              &#39;properties.\n&#39;,
                                               &#39;enum&#39;: [&#39;F062&#39;,
                                                        &#39;F087&#39;,
                                                        &#39;F106&#39;,
                                                        &#39;F129&#39;,
                                                        &#39;F146&#39;,
                                                        &#39;F158&#39;,
                                                        &#39;F184&#39;,
                                                        &#39;F213&#39;,
                                                        &#39;GRISM&#39;,
                                                        &#39;PRISM&#39;,
                                                        &#39;DARK&#39;],
                                               &#39;id&#39;: &#39;asdf://stsci.edu/datamodels/roman/schemas/wfi_optical_element-1.0.0&#39;,
                                               &#39;title&#39;: &#39;Optical Element&#39;,
                                               &#39;type&#39;: &#39;string&#39;}],
                                    &#39;archive_catalog&#39;: {&#39;datatype&#39;: &#39;nvarchar(20)&#39;,
                                                        &#39;destination&#39;: [&#39;WFIExposure.optical_element&#39;,
                                                                        &#39;GuideWindow.optical_element&#39;,
                                                                        &#39;WFICommon.optical_element&#39;]},
                                    &#39;description&#39;: &#39;Name of the optical &#39;
                                                   &#39;element used to take the &#39;
                                                   &#39;science\n&#39;
                                                   &#39;data.\n&#39;,
                                    &#39;maxLength&#39;: 20,
                                    &#39;sdf&#39;: {&#39;source&#39;: {&#39;origin&#39;: &#39;TBD&#39;},
                                            &#39;special_processing&#39;: &#39;VALUE_REQUIRED&#39;},
                                    &#39;title&#39;: &#39;Wide Field Instrument (WFI) &#39;
                                             &#39;Optical Element&#39;}},
 &#39;propertyOrder&#39;: [&#39;detector&#39;, &#39;optical_element&#39;, &#39;name&#39;],
 &#39;required&#39;: [&#39;detector&#39;, &#39;optical_element&#39;, &#39;name&#39;],
 &#39;title&#39;: &#39;Wide Field Instrument (WFI) Configuration Information&#39;,
 &#39;type&#39;: &#39;object&#39;}
</pre></div>
</div>
</div>
</div>
<p>We can also use this to get the description of a specific metadata field:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">meta</span><span class="o">.</span><span class="n">instrument</span><span class="o">.</span><span class="n">get_schema</span><span class="p">()[</span><span class="s1">&#39;properties&#39;</span><span class="p">][</span><span class="s1">&#39;detector&#39;</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Name of the Wide Field Instrument (WFI) detector used
to take the science data in this file.
</pre></div>
</div>
</div>
</div>
<p>This can be alternatively written as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">schema_info</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;roman.meta.instrument.detector&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;description&#39;: Name of the Wide Field Instrument (WFI) detector used
to take the science data in this file.
}
</pre></div>
</div>
</div>
</div>
<section id="taking-advantage-of-astropy-time-time-objects-in-the-metadata">
<h3>Taking advantage of <code class="docutils literal notranslate"><span class="pre">astropy.time.Time</span></code> objects in the metadata<a class="headerlink" href="#taking-advantage-of-astropy-time-time-objects-in-the-metadata" title="Link to this heading">#</a></h3>
<p>Another feature in WFI ASDF metadata is the storage of times as <code class="docutils literal notranslate"><span class="pre">astropy.time.Time</span></code> objects, which provide numerous convenient methods for converting to different reference systems and formats. Here we illustrate a few examples. For a more comprehensive view of <code class="docutils literal notranslate"><span class="pre">astropy.time</span></code> please check the <a class="reference external" href="https://docs.astropy.org/en/stable/time/">astropy.time</a> documentation. Note that, unless otherwise noted, WFI times are stored in Coordinated Universal Time (UTC), which is indicated in the schema descriptions for any time-related fields. However, be sure to check the field descriptions if you are unsure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Start time of the exposure:&#39;</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="s1">&#39;; datatype:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">start_time</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Start time of the exposure: 2026-10-31T00:00:00.000 ; datatype: &lt;class &#39;astropy.time.core.Time&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>We can convert the format of this start time to a modified Julian date (MJD) very easily:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span><span class="o">.</span><span class="n">mjd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(61344.0)
</pre></div>
</div>
</div>
</div>
<p>If instead we want to convert the scale of the time (i.e., from UTC to International Atomic Time (TAI)), we can do that, too:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span><span class="o">.</span><span class="n">tai</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Time object: scale=&#39;tai&#39; format=&#39;isot&#39; value=2026-10-31T00:00:37.000&gt;
</pre></div>
</div>
</div>
</div>
<p>Notice that the time changed by 37 seconds when we converted from UTC to TAI. This offset is expected and is part of the TAI definition. We can combine the scale change with the format change as well:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span><span class="o">.</span><span class="n">tai</span><span class="o">.</span><span class="n">mjd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float64(61344.00042824074)
</pre></div>
</div>
</div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">Time</span></code> objects and operate with them. For example, if we want to know the difference in time between the start and end times of the exposure (this creates a <code class="docutils literal notranslate"><span class="pre">astropy.time.TimeDelta</span></code> object):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">end_time</span> <span class="o">=</span> <span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">end_time</span>
<span class="n">exp_delta</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
</pre></div>
</div>
</div>
</div>
<p>And then express the exposure length in different units:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exposure length in seconds:&#39;</span><span class="p">,</span> <span class="n">exp_delta</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exposure length in days:&#39;</span><span class="p">,</span> <span class="n">exp_delta</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">day</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Exposure length in years:&#39;</span><span class="p">,</span> <span class="n">exp_delta</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">year</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exposure length in seconds: 51.67999999999324 s
Exposure length in days: 0.0005981481481480699 d
Exposure length in years: 1.637640378228802e-06 yr
</pre></div>
</div>
</div>
</div>
</section>
<section id="accessing-wcs-information">
<h3>Accessing WCS Information<a class="headerlink" href="#accessing-wcs-information" title="Link to this heading">#</a></h3>
<p>Roman uses Generalized World Coordinate System standard (<a class="reference external" href="https://gwcs.readthedocs.io">GWCS</a>). The WCS can be found in the <code class="docutils literal notranslate"><span class="pre">wcs</span></code> key within the <code class="docutils literal notranslate"><span class="pre">meta</span></code> block.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gwcs</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">gwcs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;gwcs.wcs._wcs.WCS&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>If we use the pretty-print (<code class="docutils literal notranslate"><span class="pre">pprint()</span></code>) function, we can see the full contents of the WCS object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">gwcs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;WCS(output_frame=world, input_frame=detector, forward_transform=Model: CompoundModel
Inputs: (&#39;x0&#39;, &#39;x1&#39;)
Outputs: (&#39;lon&#39;, &#39;lat&#39;)
Model set size: 1
Expression: [0] &amp; [1] | [2] &amp; [3] | [4] | [5] &amp; [6] | [7] | [8] &amp; [9] | [10] &amp; [11] | [12] | [13] &amp; [14] | [15] | [16] | [17] / [18] | [19] | [20] | [21] | [22] &amp; [23] | [24] | [25] | [26] &amp; [27] | [28] &amp; [29] | [30] | [31] | [32]
Components: 
    [0]: &lt;Shift(offset=1.)&gt;

    [1]: &lt;Shift(offset=1.)&gt;

    [2]: &lt;Shift(offset=-2044.5)&gt;

    [3]: &lt;Shift(offset=-2044.5)&gt;

    [4]: &lt;Mapping((0, 1, 0, 1))&gt;

    [5]: &lt;Polynomial2D(5, c0_0=0., c1_0=0.11034133, c2_0=-0.00000003, c3_0=-0., c4_0=0., c5_0=-0., c0_1=0.00034168, c0_2=-0.00000001, c0_3=-0., c0_4=-0., c0_5=0., c1_1=0.00000014, c1_2=-0., c1_3=0., c1_4=0., c2_1=0., c2_2=-0., c2_3=-0., c3_1=0., c3_2=-0., c4_1=-0.)&gt;

    [6]: &lt;Polynomial2D(5, c0_0=0., c1_0=0.00031436, c2_0=0.00000007, c3_0=0., c4_0=0., c5_0=-0., c0_1=0.10828278, c0_2=0.00000021, c0_3=-0., c0_4=0., c0_5=0., c1_1=-0.00000002, c1_2=-0., c1_3=-0., c1_4=0., c2_1=-0., c2_2=-0., c2_3=0., c3_1=-0., c3_2=-0., c4_1=-0.)&gt;

    [7]: &lt;Mapping((0, 1, 0, 1))&gt;

    [8]: &lt;Polynomial2D(1, c0_0=0., c1_0=-0.5, c0_1=-0.8660254)&gt;

    [9]: &lt;Polynomial2D(1, c0_0=0., c1_0=-0.8660254, c0_1=0.5)&gt;

    [10]: &lt;Shift(offset=1312.94914525)&gt;

    [11]: &lt;Shift(offset=-1040.78537268)&gt;

    [12]: &lt;Identity(2)&gt;

    [13]: &lt;Scale(factor=0.00027778, name=&#39;arcsec_to_deg_1D&#39;)&gt;

    [14]: &lt;Scale(factor=0.00027778, name=&#39;arcsec_to_deg_1D&#39;)&gt;

    [15]: &lt;SphericalToCartesian(name=&#39;s2c&#39;)&gt;

    [16]: &lt;RotationSequence3D(angles=[ 0.3647081 ,  0.28910705, 59.99991239], name=&#39;det_to_optic_axis&#39;)&gt;

    [17]: &lt;Mapping((0, 1, 2), name=&#39;xyz&#39;)&gt;

    [18]: &lt;Mapping((0, 0, 0), name=&#39;xxx&#39;)&gt;

    [19]: &lt;Mapping((1, 2), name=&#39;xtyt&#39;)&gt;

    [20]: &lt;AffineTransformation2D(matrix=[[ 1.        , -0.00000007], [ 0.00000007,  1.        ]], translation=[-0., -0.], name=&#39;tp_affine&#39;)&gt;

    [21]: &lt;Mapping((0, 0, 1), name=&#39;xtyt2xyz&#39;)&gt;

    [22]: &lt;Const1D(amplitude=1., name=&#39;one&#39;)&gt;

    [23]: &lt;Identity(2, name=&#39;I(2D)&#39;)&gt;

    [24]: &lt;RotationSequence3D(angles=[-59.99991239,  -0.28910705,  -0.3647081 ], name=&#39;optic_axis_to_det&#39;)&gt;

    [25]: &lt;CartesianToSpherical(name=&#39;c2s&#39;)&gt;

    [26]: &lt;Scale(factor=3600., name=&#39;deg_to_arcsec_1D&#39;)&gt;

    [27]: &lt;Scale(factor=3600., name=&#39;deg_to_arcsec_1D&#39;)&gt;

    [28]: &lt;Scale(factor=0.00027778)&gt;

    [29]: &lt;Scale(factor=0.00027778)&gt;

    [30]: &lt;SphericalToCartesian()&gt;

    [31]: &lt;RotationSequence3D(angles=[   0.3647081 ,    0.28910705,   59.99991239,   -0.1643995 , -270.87197664])&gt;

    [32]: &lt;CartesianToSpherical()&gt;
Parameters:
    offset_0 offset_1 ...                angles_31                
    -------- -------- ... ----------------------------------------
         1.0      1.0 ... 0.3647080959023555 .. -270.8719766359773)&gt;
</pre></div>
</div>
</div>
</div>
<p>If instead we use the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function, we get a summary of the transforms available:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gwcs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   From                   Transform                
---------- ----------------------------------------
  detector                            CompoundModel
      v2v3                                 Identity
v2v3vacorr JWST tangent-plane linear correction. v1
  v2v3corr                                 v23tosky
     world                                     None
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">gwcs</span></code> object can be used to convert between image pixel and sky coordinates.</p>
<p><strong>Important note:</strong> the <code class="docutils literal notranslate"><span class="pre">gwcs</span></code> object uses Python 0-indexing, therefore the center of the first pixel in Python is (0, 0), while the formal definition of the WFI science coordinate system uses FITS-style 1-indexing (i.e., the center of the bottom-left pixel is (1, 1)). More information about the Roman coordinate systems can be found in the <a class="reference external" href="https://roman-docs.stsci.edu/simulation-tools-handbook-home/simulation-development-utilities/pysiaf-for-roman">PySIAF for Roman</a> article on RDox. <strong>All</strong> archived L1-4 data products (e.g., WCS transforms, catalogs, etc.) will use the Python 0-indexed system.</p>
<p>In this example, let’s convert the central pixel position of the detector to the corresponding right ascension and declination on the sky. The center of the L2 image array in the zero-indexed science coordinate frame is (x, y) = (2043.5, 2043.5) pixels. Note that the 4-pixel reference border was removed during processing, and thus the total L2 image size is 4088 rows x 4088 columns. Since the center of the first pixel in Python is (0, 0) and the array size is even, the center of the detector is (x, y) = (2043.5, 2043.5). Also note that GWCS assumes inputs in the order (x, y) and not the Pythonic form (y, x).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gwcs</span><span class="p">(</span><span class="mf">2043.5</span><span class="p">,</span> <span class="mf">2043.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(270.8719765816213, -0.16439951042879608)
</pre></div>
</div>
</div>
</div>
<p>Likewise, we can convert from celestial coordinates to pixel coordinates using the inverse transform via the <code class="docutils literal notranslate"><span class="pre">.invert()</span></code> method. For example, using a slightly different position still within this detector:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">gwcs</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="mf">270.8719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.164399</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2045.998524527189, 2043.5097306351731]
</pre></div>
</div>
</div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">gwcs</span></code> assumed our inputs were the right ascension and declination, respectively, in degrees. If we want to be more specific, then the <code class="docutils literal notranslate"><span class="pre">gwcs</span></code> object can also take as input an <code class="docutils literal notranslate"><span class="pre">astropy.coordinates.SkyCoord</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cdt</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">270.8719</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.164399</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gwcs</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">cdt</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2045.998524527189, 2043.5097306351731]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="reading-roman-data-using-the-asdf-library">
<h2>Reading Roman data using the ASDF library<a class="headerlink" href="#reading-roman-data-using-the-asdf-library" title="Link to this heading">#</a></h2>
<p>We now illustrate how to read Roman WFI data using the basic <code class="docutils literal notranslate"><span class="pre">asdf</span></code> library.</p>
<p>The main avenue to read a generic ASDF file is via the <code class="docutils literal notranslate"><span class="pre">open</span></code> method in the <code class="docutils literal notranslate"><span class="pre">asdf</span></code> package. This returns an <code class="docutils literal notranslate"><span class="pre">AsdfObject</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asdf_dir_uri</span> <span class="o">=</span> <span class="s1">&#39;s3://stpubdata/roman/nexus/soc_simulations/tutorial_data/&#39;</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">s3fs</span><span class="o">.</span><span class="n">S3FileSystem</span><span class="p">(</span><span class="n">anon</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">asdf_file_uri_l2</span> <span class="o">=</span> <span class="n">asdf_dir_uri</span> <span class="o">+</span> <span class="s1">&#39;r0003201001001001004_0001_wfi01_f106_cal.asdf&#39;</span>

<span class="k">with</span> <span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">asdf_file_uri_l2</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">asdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Another useful method to explore the contents of an ASDF file is the <code class="docutils literal notranslate"><span class="pre">.tree</span></code> attribute:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">tree</span><span class="p">)</span> <span class="c1"># This cell will print a lot of information, please feel free to skim or skip</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;asdf_library&#39;: {&#39;author&#39;: &#39;The ASDF Developers&#39;,
                  &#39;homepage&#39;: &#39;http://github.com/asdf-format/asdf&#39;,
                  &#39;name&#39;: &#39;asdf&#39;,
                  &#39;version&#39;: &#39;4.1.0&#39;},
 &#39;history&#39;: {&#39;extensions&#39;: [{&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/core/extensions/core-1.6.0&#39;,
                             &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_standard&#39;,
                                                   &#39;version&#39;: &#39;1.1.1&#39;},
                             &#39;software&#39;: {&#39;name&#39;: &#39;asdf&#39;, &#39;version&#39;: &#39;4.1.0&#39;}},
                            {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://stsci.edu/datamodels/roman/extensions/datamodels-1.0&#39;,
                             &#39;manifest_software&#39;: {&#39;name&#39;: &#39;rad&#39;,
                                                   &#39;version&#39;: &#39;0.23.1&#39;},
                             &#39;software&#39;: {&#39;name&#39;: &#39;roman_datamodels&#39;,
                                          &#39;version&#39;: &#39;0.23.1&#39;}},
                            {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/astronomy/gwcs/extensions/gwcs-1.3.0&#39;,
                             &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_wcs_schemas&#39;,
                                                   &#39;version&#39;: &#39;0.4.0&#39;},
                             &#39;software&#39;: {&#39;name&#39;: &#39;gwcs&#39;, &#39;version&#39;: &#39;0.22.1&#39;}},
                            {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://astropy.org/astropy/extensions/units-1.0.0&#39;,
                             &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;,
                                          &#39;version&#39;: &#39;0.7.1&#39;}},
                            {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/transform/extensions/transform-1.6.0&#39;,
                             &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_transform_schemas&#39;,
                                                   &#39;version&#39;: &#39;0.5.0&#39;},
                             &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;,
                                          &#39;version&#39;: &#39;0.7.1&#39;}},
                            {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/astronomy/coordinates/extensions/coordinates-1.0.0&#39;,
                             &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_coordinates_schemas&#39;,
                                                   &#39;version&#39;: &#39;0.3.0&#39;},
                             &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;,
                                          &#39;version&#39;: &#39;0.7.1&#39;}},
                            {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
                             &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/astronomy/extensions/astronomy-1.0.0&#39;,
                             &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_standard&#39;,
                                                   &#39;version&#39;: &#39;1.1.1&#39;},
                             &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;,
                                          &#39;version&#39;: &#39;0.7.1&#39;}}]},
 &#39;roman&#39;: {&#39;meta&#39;: {&#39;asn&#39;: {}, &#39;cal_logs&#39;: [&quot;2025-05-28T19:55:41.095Z :: stpipe.ExposurePipeline :: INFO :: Step ExposurePipeline running with args (&#39;r0003201001001001004_0001_wfi01_f106_uncal.asdf&#39;,).&quot;, &quot;2025-05-28T19:55:41.106Z :: stpipe.ExposurePipeline :: INFO :: Step ExposurePipeline parameters are:\n  pre_hooks: []\n  post_hooks: []\n  output_file: None\n  output_dir: None\n  output_ext: .asdf\n  output_use_model: False\n  output_use_index: True\n  save_results: True\n  skip: False\n  suffix: cal\n  search_output_file: True\n  input_dir: &#39;&#39;\n  steps:\n    dq_init:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n    saturation:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n    refpix:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n      remove_offset: True\n      remove_trends: True\n      cosine_interpolate: True\n      fft_interpolate: True\n    linearity:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n    dark_current:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n      dark_output: None\n    rampfit:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: rampfit\n      search_output_file: True\n      input_dir: &#39;&#39;\n      algorithm: ols_cas22\n      save_opt: False\n      use_ramp_jump_detection: True\n      threshold_intercept: None\n      threshold_constant: None\n    assign_wcs:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n    flatfield:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n    photom:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n    source_catalog:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: False\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: cat\n      search_output_file: True\n      input_dir: &#39;&#39;\n      bkg_boxsize: 1000\n      kernel_fwhm: 2.0\n      snr_threshold: 3.0\n      npixels: 25\n      deblend: False\n      aperture_ee1: 30\n      aperture_ee2: 50\n      aperture_ee3: 70\n      ci1_star_threshold: 2.0\n      ci2_star_threshold: 1.8\n      fit_psf: True\n      forced_segmentation: &#39;&#39;\n    tweakreg:\n      pre_hooks: []\n      post_hooks: []\n      output_file: None\n      output_dir: None\n      output_ext: .asdf\n      output_use_model: True\n      output_use_index: True\n      save_results: False\n      skip: False\n      suffix: None\n      search_output_file: True\n      input_dir: &#39;&#39;\n      use_custom_catalogs: False\n      catalog_format: ascii.ecsv\n      catfile: &#39;&#39;\n      catalog_path: &#39;&#39;\n      enforce_user_order: False\n      expand_refcat: False\n      minobj: 15\n      searchrad: 2.0\n      use2dhist: True\n      separation: 1.0\n      tolerance: 0.7\n      fitgeometry: rshift\n      nclip: 3\n      sigma: 3.0\n      abs_refcat: GAIADR3\n      save_abs_catalog: False\n      abs_minobj: 15\n      abs_searchrad: 6.0\n      abs_use2dhist: True\n      abs_separation: 1.0\n      abs_tolerance: 0.7\n      abs_fitgeometry: rshift\n      abs_nclip: 3\n      abs_sigma: 3.0\n      update_source_catalog_coordinates: False&quot;, &#39;2025-05-28T19:55:41.107Z :: stpipe.ExposurePipeline :: INFO :: First argument r0003201001001001004_0001_wfi01_f106_uncal.asdf does not appear to be a model&#39;, &#39;2025-05-28T19:55:41.107Z :: stpipe.ExposurePipeline :: INFO :: Starting Roman exposure calibration pipeline ...&#39;, &#39;2025-05-28T19:55:41.270Z :: stpipe.ExposurePipeline.dq_init :: INFO :: Step dq_init running with args (&lt;roman_datamodels.datamodels._datamodels.ScienceRawModel object at 0x1201db6b0&gt;,).&#39;, &#39;2025-05-28T19:55:44.054Z :: stpipe.ExposurePipeline.dq_init :: INFO :: Flagging rows from: -999999 to -999983 as affected by guide window read&#39;, &#39;2025-05-28T19:55:44.076Z :: stpipe.ExposurePipeline.dq_init :: DEBUG :: Using MASK ref file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_mask_0030.asdf&#39;, &#39;2025-05-28T19:55:44.104Z :: stpipe.ExposurePipeline.dq_init :: INFO :: Step dq_init done&#39;, &#39;2025-05-28T19:55:44.189Z :: stpipe.ExposurePipeline.saturation :: INFO :: Step saturation running with args (&lt;roman_datamodels.datamodels._datamodels.RampModel object at 0x12000a450&gt;,).&#39;, &#39;2025-05-28T19:55:44.192Z :: stpipe.ExposurePipeline.saturation :: INFO :: Using SATURATION reference file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_saturation_0031.asdf&#39;, &#39;2025-05-28T19:55:45.327Z :: stpipe.ExposurePipeline.saturation :: INFO :: Detected 73498 saturated pixels&#39;, &#39;2025-05-28T19:55:45.353Z :: stpipe.ExposurePipeline.saturation :: INFO :: Detected 66525 A/D floor pixels&#39;, &#39;2025-05-28T19:55:45.362Z :: stpipe.ExposurePipeline.saturation :: INFO :: Step saturation done&#39;, &#39;2025-05-28T19:55:45.509Z :: stpipe.ExposurePipeline.refpix :: INFO :: Step refpix running with args (&lt;roman_datamodels.datamodels._datamodels.RampModel object at 0x12000a450&gt;,).&#39;, &#39;2025-05-28T19:55:45.510Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Opening the science data: &lt;roman_datamodels.datamodels._datamodels.RampModel object at 0x12000a450&gt;&#39;, &#39;2025-05-28T19:55:45.513Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Opening the reference file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_refpix_0013.asdf&#39;, &#39;2025-05-28T19:55:45.537Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Running the reference pixel correction&#39;, &#39;2025-05-28T19:55:45.537Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Reading data from datamodel into single array&#39;, &#39;2025-05-28T19:55:45.619Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Removed the general offset from data, to be re-applied later.&#39;, &#39;2025-05-28T19:55:45.941Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Removed boundary trends (in time) from data.&#39;, &#39;2025-05-28T19:55:46.049Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Cosine interpolated the reference pixels.&#39;, &#39;2025-05-28T19:55:46.240Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: FFT interpolated the reference pixel pads.&#39;, &#39;2025-05-28T19:55:47.932Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Applied reference pixel correction&#39;, &#39;2025-05-28T19:55:47.958Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Re-applied the general offset (if removed) to the data.&#39;, &#39;2025-05-28T19:55:47.964Z :: stpipe.ExposurePipeline.refpix :: DEBUG :: Updated the datamodel with the corrected data.&#39;, &#39;2025-05-28T19:55:47.969Z :: stpipe.ExposurePipeline.refpix :: INFO :: Step refpix done&#39;, &#39;2025-05-28T19:55:48.053Z :: stpipe.ExposurePipeline.linearity :: INFO :: Step linearity running with args (&lt;roman_datamodels.datamodels._datamodels.RampModel object at 0x12000a450&gt;,).&#39;, &#39;2025-05-28T19:55:48.057Z :: stpipe.ExposurePipeline.linearity :: INFO :: Using LINEARITY reference file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_linearity_0003.asdf&#39;, &#39;2025-05-28T19:55:49.554Z :: stpipe.ExposurePipeline.linearity :: INFO :: Step linearity done&#39;, &#39;2025-05-28T19:55:49.633Z :: stpipe.ExposurePipeline.dark_current :: INFO :: Step dark_current running with args (&lt;roman_datamodels.datamodels._datamodels.RampModel object at 0x12000a450&gt;,).&#39;, &#39;2025-05-28T19:55:49.636Z :: stpipe.ExposurePipeline.dark_current :: INFO :: Using DARK reference file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_dark_0444.asdf&#39;, &#39;2025-05-28T19:55:51.070Z :: stpipe.ExposurePipeline.dark_current :: INFO :: Step dark_current done&#39;, &#39;2025-05-28T19:55:51.149Z :: stpipe.ExposurePipeline.rampfit :: INFO :: Step rampfit running with args (&lt;roman_datamodels.datamodels._datamodels.RampModel object at 0x12000a450&gt;,).&#39;, &#39;2025-05-28T19:55:51.171Z :: stpipe.ExposurePipeline.rampfit :: INFO :: Using READNOISE reference file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_readnoise_0024.asdf&#39;, &#39;2025-05-28T19:55:51.188Z :: stpipe.ExposurePipeline.rampfit :: INFO :: Using GAIN reference file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_gain_0022.asdf&#39;, &#39;2025-05-28T19:55:51.216Z :: stpipe.ExposurePipeline.rampfit :: INFO :: Jump detection as part of ramp fitting is enabled.&#39;, &#39;2025-05-28T19:56:03.915Z :: stpipe.ExposurePipeline.rampfit :: INFO :: Step rampfit done&#39;, &#39;2025-05-28T19:56:04.001Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: Step assign_wcs running with args (&lt;roman_datamodels.datamodels._datamodels.ImageModel object at 0x1203ac560&gt;,).&#39;, &#39;2025-05-28T19:56:04.002Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: reftype, distortion&#39;, &quot;2025-05-28T19:56:04.004Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: Using reference files: {&#39;distortion&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_distortion_0014.asdf&#39;} for assign_wcs&quot;, &#39;2025-05-28T19:56:04.061Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: Update S_REGION to POLYGON ICRS  270.934669729 -0.225719494 270.934611880 -0.102755788 270.809021784 -0.102451264 270.809744137 -0.225310330&#39;, &#39;2025-05-28T19:56:04.062Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: S_REGION VALUES: POLYGON ICRS  270.934669729 -0.225719494 270.934611880 -0.102755788 270.809021784 -0.102451264 270.809744137 -0.225310330&#39;, &#39;2025-05-28T19:56:04.062Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: Update S_REGION to POLYGON ICRS  270.934669729 -0.225719494 270.934611880 -0.102755788 270.809021784 -0.102451264 270.809744137 -0.225310330&#39;, &#39;2025-05-28T19:56:04.065Z :: stpipe.ExposurePipeline.assign_wcs :: INFO :: Step assign_wcs done&#39;, &#39;2025-05-28T19:56:04.158Z :: stpipe.ExposurePipeline.flatfield :: INFO :: Step flatfield running with args (&lt;roman_datamodels.datamodels._datamodels.ImageModel object at 0x1203ac560&gt;,).&#39;, &#39;2025-05-28T19:56:04.180Z :: stpipe.ExposurePipeline.flatfield :: DEBUG :: Using FLAT ref file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_flat_0175.asdf&#39;, &#39;2025-05-28T19:56:04.464Z :: stpipe.ExposurePipeline.flatfield :: INFO :: Step flatfield done&#39;, &#39;2025-05-28T19:56:04.546Z :: stpipe.ExposurePipeline.photom :: INFO :: Step photom running with args (&lt;roman_datamodels.datamodels._datamodels.ImageModel object at 0x1203ac560&gt;,).&#39;, &#39;2025-05-28T19:56:04.591Z :: stpipe.ExposurePipeline.photom :: DEBUG :: Using PHOTOM ref file: /Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_photom_0040.asdf&#39;, &#39;2025-05-28T19:56:04.591Z :: stpipe.ExposurePipeline.photom :: DEBUG :: pixel_area = 2.8083389953727505e-13&#39;, &#39;2025-05-28T19:56:04.591Z :: stpipe.ExposurePipeline.photom :: INFO :: photmjsr value: 0.741749&#39;, &#39;2025-05-28T19:56:04.591Z :: stpipe.ExposurePipeline.photom :: INFO :: uncertainty value: 0.0288573&#39;, &#39;2025-05-28T19:56:04.594Z :: stpipe.ExposurePipeline.photom :: INFO :: Step photom done&#39;, &#39;2025-05-28T19:56:04.680Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Step source_catalog running with args (&lt;roman_datamodels.datamodels._datamodels.ImageModel object at 0x1203ac560&gt;,).&#39;, &#39;2025-05-28T19:56:04.774Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Instrument: WFI&#39;, &#39;2025-05-28T19:56:04.774Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Detector: WFI01&#39;, &#39;2025-05-28T19:56:04.775Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Optical Element: F106&#39;, &#39;2025-05-28T19:56:04.775Z :: stpipe.ExposurePipeline.source_catalog :: WARNING :: Reference file data mapping aperture encircled energies to radii (in pixels), background annuli sizes, and aperture corrections are not yet available. Using placeholder values.&#39;, &#39;2025-05-28T19:56:12.264Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Detected 1461 sources&#39;, &#39;2025-05-28T19:56:13.432Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Constructing a gridded PSF model.&#39;, &quot;2025-05-28T19:56:13.574Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &quot;2025-05-28T19:56:13.575Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &quot;2025-05-28T19:56:13.576Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &quot;2025-05-28T19:56:13.576Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &#39;2025-05-28T19:56:13.577Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Calculating spectral weights using synphot, nlambda=10, source=None&#39;, &#39;2025-05-28T19:56:13.591Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: No source spectrum supplied, therefore defaulting to 5700 K blackbody&#39;, &quot;2025-05-28T19:56:13.592Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Computing spectral weights for source = SourceSpectrum at z=0.0\nModel: BlackBodyNorm1D\nInputs: (&#39;x&#39;,)\nOutputs: (&#39;y&#39;,)\nModel set size: 1\nParameters:\n    temperature\n    -----------\n         5700.0&quot;, &#39;2025-05-28T19:56:13.592Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Computing wavelength weights using synthetic photometry for F106...&#39;, &#39;2025-05-28T19:56:13.602Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Min, max wavelengths = 0.915000, 1.205000&#39;, &#39;2025-05-28T19:56:13.602Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 0.93 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.636Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 0.96 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.662Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 0.99 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.687Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.02 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.711Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.05 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.736Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.07 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.761Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.10 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.785Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.13 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.809Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.16 micron with width 0.03 micron&#39;, &#39;2025-05-28T19:56:13.834Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Integrating across band centered at 1.19 micron with width 0.03 micron&#39;, &quot;2025-05-28T19:56:13.858Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &#39;2025-05-28T19:56:13.858Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF calc using fov_pixels = 9, oversample = 11, number of wavelengths = 10&#39;, &#39;2025-05-28T19:56:13.859Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Creating optical system model:&#39;, &#39;2025-05-28T19:56:13.859Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Oversample: 11  11 &#39;, &#39;2025-05-28T19:56:13.859Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Initialized OpticalSystem: Roman+WFI&#39;, &#39;2025-05-28T19:56:13.863Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Trans: /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:13.863Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: OPD: /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:13.965Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded amplitude transmission from /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:14.252Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded OPD from /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:14.253Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Roman Entrance Pupil&#39;, &#39;2025-05-28T19:56:14.259Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added coordinate inversion plane: OTE exit pupil&#39;, &#39;2025-05-28T19:56:14.260Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:14.275Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Adding coronagraph/spectrograph optics...&#39;, &#39;2025-05-28T19:56:14.275Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::    No optics added for WFI&#39;, &#39;2025-05-28T19:56:14.276Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added detector with pixelscale=0.11 and oversampling=11: WFI detector&#39;, &#39;2025-05-28T19:56:14.277Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating PSF with 10 wavelengths&#39;, &#39;2025-05-28T19:56:14.277Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.295e-07 m&#39;, &#39;2025-05-28T19:56:14.281Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.295000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:14.281Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.292Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:14.305Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:14.305Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:14.305Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.310Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:14.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:14.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:14.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.477 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:14.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.476545175601293 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:14.463Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:14.465Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.585e-07 m&#39;, &#39;2025-05-28T19:56:14.468Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.585000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:14.468Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.480Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:14.493Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:14.493Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:14.493Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.499Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:14.596Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:14.596Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:14.596Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.596Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.099 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:14.596Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.596Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.099059719062497 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:14.629Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:14.631Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.875e-07 m&#39;, &#39;2025-05-28T19:56:14.634Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.875e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:14.634Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.646Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:14.659Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:14.659Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:14.659Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.664Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:14.752Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:14.752Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:14.752Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.752Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.744 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:14.752Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.752Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.743745560224207 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:14.784Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:14.786Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0165e-06 m&#39;, &#39;2025-05-28T19:56:14.789Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0165000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:14.789Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.800Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:14.814Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:14.814Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:14.814Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.819Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:14.907Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:14.907Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:14.907Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.907Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.409 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:14.907Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:14.907Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.408705106464735 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:14.939Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:14.940Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0455e-06 m&#39;, &#39;2025-05-28T19:56:14.943Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0455000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:14.944Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.955Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:14.968Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:14.968Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:14.968Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:14.973Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:15.060Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:15.060Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:15.060Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.060Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.092 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:15.060Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.060Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.092251306285416 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:15.094Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:15.095Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0745e-06 m&#39;, &#39;2025-05-28T19:56:15.098Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0745000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:15.098Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.110Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:15.123Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:15.123Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:15.123Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.128Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:15.216Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:15.216Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:15.216Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.216Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.793 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:15.216Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.216Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.792879237525737 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:15.249Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:15.251Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1035e-06 m&#39;, &#39;2025-05-28T19:56:15.254Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1035000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:15.254Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.265Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:15.278Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:15.278Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:15.278Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.284Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:15.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:15.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:15.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.509 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:15.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.509242175551794 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:15.403Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:15.405Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1325e-06 m&#39;, &#39;2025-05-28T19:56:15.407Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1325000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:15.408Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.419Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:15.432Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:15.432Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:15.432Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.437Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:15.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:15.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:15.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.240 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:15.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.525Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.240131338385346 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:15.558Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:15.559Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1615e-06 m&#39;, &#39;2025-05-28T19:56:15.562Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1615000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:15.562Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.574Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:15.587Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:15.587Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:15.587Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.592Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:15.679Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:15.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:15.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.984 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:15.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.98445866613982 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:15.712Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:15.713Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1905e-06 m&#39;, &#39;2025-05-28T19:56:15.717Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1905000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:15.717Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.729Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:15.742Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:15.742Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:15.742Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:15.747Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:15.834Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:15.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:15.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.741 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:15.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:15.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.741242117363631 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:15.867Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:15.869Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::   Calculation completed in 1.592 s&#39;, &#39;2025-05-28T19:56:15.870Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF Calculation completed.&#39;, &#39;2025-05-28T19:56:15.870Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating jitter using gaussian&#39;, &#39;2025-05-28T19:56:15.871Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Jitter: Convolving with Gaussian with sigma=0.012 arcsec&#39;, &#39;2025-05-28T19:56:15.872Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::         resulting image peak drops to 0.911 of its previous value&#39;, &#39;2025-05-28T19:56:15.873Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Returning only the oversampled data. Oversampled by 11&#39;, &#39;2025-05-28T19:56:15.875Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Calculating spectral weights using synphot, nlambda=10, source=None&#39;, &#39;2025-05-28T19:56:15.887Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: No source spectrum supplied, therefore defaulting to 5700 K blackbody&#39;, &quot;2025-05-28T19:56:15.888Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Computing spectral weights for source = SourceSpectrum at z=0.0\nModel: BlackBodyNorm1D\nInputs: (&#39;x&#39;,)\nOutputs: (&#39;y&#39;,)\nModel set size: 1\nParameters:\n    temperature\n    -----------\n         5700.0&quot;, &#39;2025-05-28T19:56:15.888Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Previously computed spectral weights found in cache, just reusing those&#39;, &quot;2025-05-28T19:56:15.888Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &#39;2025-05-28T19:56:15.888Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF calc using fov_pixels = 9, oversample = 11, number of wavelengths = 10&#39;, &#39;2025-05-28T19:56:15.889Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Creating optical system model:&#39;, &#39;2025-05-28T19:56:15.889Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Oversample: 11  11 &#39;, &#39;2025-05-28T19:56:15.889Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Initialized OpticalSystem: Roman+WFI&#39;, &#39;2025-05-28T19:56:15.889Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Trans: /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:15.889Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: OPD: /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:15.997Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded amplitude transmission from /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:16.008Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded OPD from /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:16.009Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Roman Entrance Pupil&#39;, &#39;2025-05-28T19:56:16.015Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added coordinate inversion plane: OTE exit pupil&#39;, &#39;2025-05-28T19:56:16.016Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Adding coronagraph/spectrograph optics...&#39;, &#39;2025-05-28T19:56:16.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::    No optics added for WFI&#39;, &#39;2025-05-28T19:56:16.031Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added detector with pixelscale=0.11 and oversampling=11: WFI detector&#39;, &#39;2025-05-28T19:56:16.033Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating PSF with 10 wavelengths&#39;, &#39;2025-05-28T19:56:16.033Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.295e-07 m&#39;, &#39;2025-05-28T19:56:16.036Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.295000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.036Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.049Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.061Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.061Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.061Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.067Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:16.160Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.160Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:16.160Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.160Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.477 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:16.160Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.160Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.476545175601293 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:16.193Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:16.195Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.585e-07 m&#39;, &#39;2025-05-28T19:56:16.199Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.585000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.199Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.210Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.224Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.224Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.224Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.230Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:16.312Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.312Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:16.312Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.312Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.099 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:16.312Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.312Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.099059719062497 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:16.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:16.346Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.875e-07 m&#39;, &#39;2025-05-28T19:56:16.349Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.875e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.349Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.360Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.371Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.376Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:16.461Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.461Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:16.462Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.462Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.744 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:16.462Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.462Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.743745560224207 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:16.494Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:16.496Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0165e-06 m&#39;, &#39;2025-05-28T19:56:16.499Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0165000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.499Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.511Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.524Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.530Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:16.617Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.618Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:16.618Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.618Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.409 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:16.618Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.618Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.408705106464735 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:16.650Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:16.652Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0455e-06 m&#39;, &#39;2025-05-28T19:56:16.655Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0455000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.667Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.686Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:16.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:16.774Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.774Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.092 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:16.774Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.774Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.092251306285416 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:16.806Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:16.808Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0745e-06 m&#39;, &#39;2025-05-28T19:56:16.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0745000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.822Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.836Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.836Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.836Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.841Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:16.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:16.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:16.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.793 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:16.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:16.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.792879237525737 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:16.962Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:16.964Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1035e-06 m&#39;, &#39;2025-05-28T19:56:16.967Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1035000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:16.967Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.978Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:16.991Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:16.991Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:16.991Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:16.997Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:17.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:17.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:17.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.085Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.509 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:17.085Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.085Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.509242175551794 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:17.118Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:17.120Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1325e-06 m&#39;, &#39;2025-05-28T19:56:17.123Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1325000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:17.123Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.134Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:17.148Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:17.148Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:17.148Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.153Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:17.240Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:17.241Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:17.241Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.241Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.240 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:17.241Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.241Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.240131338385346 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:17.273Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:17.274Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1615e-06 m&#39;, &#39;2025-05-28T19:56:17.277Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1615000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:17.278Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.289Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:17.302Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:17.302Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:17.302Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.307Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:17.395Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:17.396Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:17.396Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.396Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.984 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:17.396Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.396Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.98445866613982 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:17.429Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:17.431Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1905e-06 m&#39;, &#39;2025-05-28T19:56:17.434Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1905000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:17.434Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.445Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:17.458Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:17.458Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:17.459Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.464Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:17.551Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:17.552Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:17.552Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.552Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.741 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:17.552Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.552Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.741242117363631 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:17.584Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:17.585Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::   Calculation completed in 1.553 s&#39;, &#39;2025-05-28T19:56:17.587Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF Calculation completed.&#39;, &#39;2025-05-28T19:56:17.587Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating jitter using gaussian&#39;, &#39;2025-05-28T19:56:17.587Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Jitter: Convolving with Gaussian with sigma=0.012 arcsec&#39;, &#39;2025-05-28T19:56:17.588Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::         resulting image peak drops to 0.911 of its previous value&#39;, &#39;2025-05-28T19:56:17.589Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Returning only the oversampled data. Oversampled by 11&#39;, &#39;2025-05-28T19:56:17.591Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Calculating spectral weights using synphot, nlambda=10, source=None&#39;, &#39;2025-05-28T19:56:17.604Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: No source spectrum supplied, therefore defaulting to 5700 K blackbody&#39;, &quot;2025-05-28T19:56:17.605Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Computing spectral weights for source = SourceSpectrum at z=0.0\nModel: BlackBodyNorm1D\nInputs: (&#39;x&#39;,)\nOutputs: (&#39;y&#39;,)\nModel set size: 1\nParameters:\n    temperature\n    -----------\n         5700.0&quot;, &#39;2025-05-28T19:56:17.605Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Previously computed spectral weights found in cache, just reusing those&#39;, &quot;2025-05-28T19:56:17.605Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &#39;2025-05-28T19:56:17.605Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF calc using fov_pixels = 9, oversample = 11, number of wavelengths = 10&#39;, &#39;2025-05-28T19:56:17.605Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Creating optical system model:&#39;, &#39;2025-05-28T19:56:17.606Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Oversample: 11  11 &#39;, &#39;2025-05-28T19:56:17.606Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Initialized OpticalSystem: Roman+WFI&#39;, &#39;2025-05-28T19:56:17.607Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Trans: /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:17.607Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: OPD: /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:17.711Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded amplitude transmission from /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:17.722Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded OPD from /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:17.723Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Roman Entrance Pupil&#39;, &#39;2025-05-28T19:56:17.730Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added coordinate inversion plane: OTE exit pupil&#39;, &#39;2025-05-28T19:56:17.731Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:17.746Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Adding coronagraph/spectrograph optics...&#39;, &#39;2025-05-28T19:56:17.746Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::    No optics added for WFI&#39;, &#39;2025-05-28T19:56:17.746Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added detector with pixelscale=0.11 and oversampling=11: WFI detector&#39;, &#39;2025-05-28T19:56:17.748Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating PSF with 10 wavelengths&#39;, &#39;2025-05-28T19:56:17.748Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.295e-07 m&#39;, &#39;2025-05-28T19:56:17.751Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.295000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:17.751Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.762Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:17.775Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:17.775Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:17.775Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.781Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:17.874Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:17.875Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:17.875Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.875Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.477 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:17.875Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:17.875Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.476545175601293 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:17.908Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:17.910Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.585e-07 m&#39;, &#39;2025-05-28T19:56:17.914Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.585000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:17.914Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.926Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:17.939Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:17.939Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:17.939Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:17.945Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.030Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.099 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.031Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.099059719062497 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.065Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:18.066Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.875e-07 m&#39;, &#39;2025-05-28T19:56:18.070Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.875e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:18.071Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.082Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:18.095Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:18.095Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:18.095Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.100Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.189Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.189Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.189Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.189Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.744 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.189Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.189Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.743745560224207 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.222Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:18.224Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0165e-06 m&#39;, &#39;2025-05-28T19:56:18.227Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0165000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:18.227Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.238Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:18.252Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:18.252Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:18.252Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.257Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.409 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.345Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.408705106464735 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.378Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:18.380Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0455e-06 m&#39;, &#39;2025-05-28T19:56:18.384Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0455000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:18.384Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.395Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:18.409Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:18.409Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:18.409Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.414Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.501Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.502Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.502Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.502Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.092 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.502Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.502Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.092251306285416 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.536Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:18.537Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0745e-06 m&#39;, &#39;2025-05-28T19:56:18.541Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0745000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:18.541Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.552Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:18.565Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:18.565Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:18.565Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.570Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.793 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.656Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.792879237525737 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.689Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:18.691Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1035e-06 m&#39;, &#39;2025-05-28T19:56:18.694Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1035000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:18.694Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.705Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:18.718Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:18.718Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:18.718Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.723Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.509 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.811Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.509242175551794 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.843Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:18.845Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1325e-06 m&#39;, &#39;2025-05-28T19:56:18.848Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1325000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:18.848Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.859Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:18.872Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:18.873Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:18.873Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:18.878Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:18.965Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:18.965Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:18.965Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.965Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.240 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:18.965Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:18.965Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.240131338385346 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:18.998Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:19.000Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1615e-06 m&#39;, &#39;2025-05-28T19:56:19.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1615000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:19.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.014Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:19.028Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:19.028Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:19.028Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.033Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:19.120Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:19.120Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:19.121Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.121Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.984 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:19.121Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.121Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.98445866613982 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:19.153Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:19.155Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1905e-06 m&#39;, &#39;2025-05-28T19:56:19.158Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1905000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:19.158Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.169Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:19.183Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:19.183Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:19.183Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.188Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:19.275Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:19.275Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:19.276Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.276Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.741 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:19.276Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.276Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.741242117363631 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:19.309Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:19.310Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::   Calculation completed in 1.563 s&#39;, &#39;2025-05-28T19:56:19.311Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF Calculation completed.&#39;, &#39;2025-05-28T19:56:19.312Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating jitter using gaussian&#39;, &#39;2025-05-28T19:56:19.312Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Jitter: Convolving with Gaussian with sigma=0.012 arcsec&#39;, &#39;2025-05-28T19:56:19.313Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::         resulting image peak drops to 0.912 of its previous value&#39;, &#39;2025-05-28T19:56:19.314Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Returning only the oversampled data. Oversampled by 11&#39;, &#39;2025-05-28T19:56:19.316Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Calculating spectral weights using synphot, nlambda=10, source=None&#39;, &#39;2025-05-28T19:56:19.329Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: No source spectrum supplied, therefore defaulting to 5700 K blackbody&#39;, &quot;2025-05-28T19:56:19.330Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Computing spectral weights for source = SourceSpectrum at z=0.0\nModel: BlackBodyNorm1D\nInputs: (&#39;x&#39;,)\nOutputs: (&#39;y&#39;,)\nModel set size: 1\nParameters:\n    temperature\n    -----------\n         5700.0&quot;, &#39;2025-05-28T19:56:19.330Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Previously computed spectral weights found in cache, just reusing those&#39;, &quot;2025-05-28T19:56:19.330Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Using pupil mask &#39;SKINNY&#39; and detector &#39;SCA01&#39;.&quot;, &#39;2025-05-28T19:56:19.331Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF calc using fov_pixels = 9, oversample = 11, number of wavelengths = 10&#39;, &#39;2025-05-28T19:56:19.331Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Creating optical system model:&#39;, &#39;2025-05-28T19:56:19.331Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Oversample: 11  11 &#39;, &#39;2025-05-28T19:56:19.331Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Initialized OpticalSystem: Roman+WFI&#39;, &#39;2025-05-28T19:56:19.332Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Trans: /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:19.332Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: OPD: /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:19.438Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded amplitude transmission from /user/desjard/stpsf-data/WFI/pupils/RST_WIM_Filter_skinny_SCA_1.fits.gz&#39;, &#39;2025-05-28T19:56:19.451Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Roman Entrance Pupil: Loaded OPD from /user/desjard/stpsf-data/upscaled_HST_OPD.fits&#39;, &#39;2025-05-28T19:56:19.452Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Roman Entrance Pupil&#39;, &#39;2025-05-28T19:56:19.459Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added coordinate inversion plane: OTE exit pupil&#39;, &#39;2025-05-28T19:56:19.459Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:19.475Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Adding coronagraph/spectrograph optics...&#39;, &#39;2025-05-28T19:56:19.475Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::    No optics added for WFI&#39;, &#39;2025-05-28T19:56:19.475Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Added detector with pixelscale=0.11 and oversampling=11: WFI detector&#39;, &#39;2025-05-28T19:56:19.477Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating PSF with 10 wavelengths&#39;, &#39;2025-05-28T19:56:19.477Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.295e-07 m&#39;, &#39;2025-05-28T19:56:19.480Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.295000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:19.480Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.491Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:19.504Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:19.504Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:19.504Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.509Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:19.615Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:19.615Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:19.615Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.615Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.477 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:19.616Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.616Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.476545175601293 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:19.650Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:19.651Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.585e-07 m&#39;, &#39;2025-05-28T19:56:19.655Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.585000000000002e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:19.655Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.667Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:19.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:19.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:19.680Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.686Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:19.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:19.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:19.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=12.099 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:19.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.773Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 12.099059719062497 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:19.805Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:19.807Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 9.875e-07 m&#39;, &#39;2025-05-28T19:56:19.810Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=9.875e-07 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:19.810Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.822Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:19.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:19.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:19.835Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.841Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:19.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:19.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:19.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.744 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:19.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:19.929Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.743745560224207 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:19.962Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:19.964Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0165e-06 m&#39;, &#39;2025-05-28T19:56:19.967Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0165000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:19.967Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.978Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:19.992Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:19.992Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:19.992Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:19.997Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:20.083Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:20.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:20.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.409 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:20.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.084Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.408705106464735 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:20.116Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:20.118Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0455e-06 m&#39;, &#39;2025-05-28T19:56:20.122Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0455000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:20.122Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.133Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:20.147Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:20.147Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:20.147Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.152Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:20.239Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:20.240Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:20.240Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.240Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=11.092 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:20.240Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.240Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 11.092251306285416 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:20.271Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:20.273Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.0745e-06 m&#39;, &#39;2025-05-28T19:56:20.276Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.0745000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:20.276Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.287Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:20.300Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:20.300Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:20.300Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.306Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:20.392Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:20.393Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:20.393Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.393Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.793 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:20.393Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.393Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.792879237525737 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:20.426Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:20.427Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1035e-06 m&#39;, &#39;2025-05-28T19:56:20.430Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1035000000000001e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:20.431Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.442Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:20.456Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:20.456Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:20.456Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.461Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:20.547Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:20.548Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:20.548Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.548Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.509 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:20.548Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.548Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.509242175551794 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:20.581Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:20.583Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1325e-06 m&#39;, &#39;2025-05-28T19:56:20.586Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1325000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:20.586Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.597Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:20.611Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:20.611Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:20.611Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.616Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:20.703Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:20.703Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:20.703Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.703Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=10.240 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:20.703Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.703Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 10.240131338385346 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:20.737Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:20.738Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1615e-06 m&#39;, &#39;2025-05-28T19:56:20.741Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1615000000000002e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:20.742Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.753Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:20.766Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:20.766Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:20.766Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.771Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:20.858Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:20.858Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:20.859Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.859Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.984 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:20.859Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:20.859Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.98445866613982 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:20.892Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:20.893Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Propagating wavelength = 1.1905e-06 m&#39;, &#39;2025-05-28T19:56:20.896Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Input wavefront has wavelength=1.1905000000000003e-06 m, npix=2048, diam=2.42, pixel scale=0.00118 meters/pixel&#39;, &#39;2025-05-28T19:56:20.896Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Roman Entrance Pupil already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.908Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Roman Entrance Pupil &#39;, &#39;2025-05-28T19:56:20.921Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: normalizing at first plane (entrance pupil) to 1.0 total intensity&#39;, &#39;2025-05-28T19:56:20.921Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Coordinate Inversion in y axis. &#39;, &#39;2025-05-28T19:56:20.921Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Wavefront and optic Field Dependent Aberration (SCA01) already at same plane type, no propagation needed.&#39;, &#39;2025-05-28T19:56:20.926Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Omitting piston/tip/tilt&#39;, &#39;2025-05-28T19:56:21.002Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Multiplied WF by phasor for Pupil plane: Field Dependent Aberration (SCA01)&#39;, &#39;2025-05-28T19:56:21.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::   Propagating wavefront to Detector plane: WFI detector (9x9 pixels, 0.110 arcsec / pix). &#39;, &#39;2025-05-28T19:56:21.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: MatrixFourierTransform initialized using centering type = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:21.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::     Propagating w/ MFT: 0.0100 arcsec / pix     fov=9.741 lam/D    npix=99&#39;, &#39;2025-05-28T19:56:21.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::       MFT method = ADJUSTABLE&#39;, &#39;2025-05-28T19:56:21.003Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG :: Forward MatrixFourierTransform: array shape (2048, 2048), centering style ADJUSTABLE, output region size 9.741242117363631 in lambda / D units, output array size 99.0 pixels, offset None&#39;, &#39;2025-05-28T19:56:21.037Z :: stpipe.ExposurePipeline.source_catalog :: DEBUG ::      Result wavefront: at=after Field Dependent Aberration (SCA01) shape=(99, 99) &#39;, &#39;2025-05-28T19:56:21.038Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::   Calculation completed in 1.562 s&#39;, &#39;2025-05-28T19:56:21.039Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: PSF Calculation completed.&#39;, &#39;2025-05-28T19:56:21.040Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Calculating jitter using gaussian&#39;, &#39;2025-05-28T19:56:21.040Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Jitter: Convolving with Gaussian with sigma=0.012 arcsec&#39;, &#39;2025-05-28T19:56:21.041Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::         resulting image peak drops to 0.912 of its previous value&#39;, &#39;2025-05-28T19:56:21.042Z :: stpipe.ExposurePipeline.source_catalog :: INFO ::  Returning only the oversampled data. Oversampled by 11&#39;, &#39;2025-05-28T19:56:21.045Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Fitting a PSF model to sources for improved astrometric precision.&#39;, &#39;2025-05-28T19:56:31.611Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Saved model in r0003201001001001004_0001_wfi01_f106_segm.asdf&#39;, &#39;2025-05-28T19:56:31.701Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Saved model in r0003201001001001004_0001_wfi01_f106_cat.asdf&#39;, &#39;2025-05-28T19:56:31.711Z :: stpipe.ExposurePipeline.source_catalog :: INFO :: Step source_catalog done&#39;, &#39;2025-05-28T19:56:31.796Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Step tweakreg running with args (&lt;romancal.datamodels.library.ModelLibrary object at 0x11f2d7a70&gt;,).&#39;, &#39;2025-05-28T19:56:31.797Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Number of image groups to be aligned: 1.&#39;, &#39;2025-05-28T19:56:31.797Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Image groups:&#39;, &#39;2025-05-28T19:56:31.798Z :: stpipe.ExposurePipeline.tweakreg :: INFO ::   00032010010010010040001&#39;, &#39;2025-05-28T19:56:31.798Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: All source catalogs will be saved to: /System/Volumes/Data/grp/roman/desjardins/simulations/aas246&#39;, &#39;2025-05-28T19:56:31.864Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Detected 1461 sources in r0003201001001001004_0001_wfi01_f106_uncal.asdf.&#39;, &#39;2025-05-28T19:56:31.898Z :: stpipe.ExposurePipeline.tweakreg :: DEBUG :: Starting new HTTP connection (1): gsss.stsci.edu:80&#39;, &#39;2025-05-28T19:56:31.904Z :: stpipe.ExposurePipeline.tweakreg :: DEBUG :: http://gsss.stsci.edu:80 &quot;GET /webservices/vo/CatalogSearch.aspx?RA=270.8718609189007&amp;DEC=-0.16410054501957452&amp;EPOCH=2026.8301378056824&amp;SR=0.0880088462317565&amp;FORMAT=CSV&amp;CAT=GAIADR3&amp;MINDET=5 HTTP/1.1&quot; 301 185&#39;, &#39;2025-05-28T19:56:31.905Z :: stpipe.ExposurePipeline.tweakreg :: DEBUG :: Starting new HTTPS connection (1): gsss.stsci.edu:443&#39;, &#39;2025-05-28T19:56:32.741Z :: stpipe.ExposurePipeline.tweakreg :: DEBUG :: https://gsss.stsci.edu:443 &quot;GET /webservices/vo/CatalogSearch.aspx?RA=270.8718609189007&amp;DEC=-0.16410054501957452&amp;EPOCH=2026.8301378056824&amp;SR=0.0880088462317565&amp;FORMAT=CSV&amp;CAT=GAIADR3&amp;MINDET=5 HTTP/1.1&quot; 200 3610499&#39;, &#39;2025-05-28T19:56:37.654Z :: stpipe.ExposurePipeline.tweakreg :: INFO ::  &#39;, &#39;2025-05-28T19:56:37.655Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: ***** tweakwcs.imalign.align_wcs() started on 2025-05-28 15:56:37.654936&#39;, &#39;2025-05-28T19:56:37.656Z :: stpipe.ExposurePipeline.tweakreg :: INFO ::       Version 0.8.10&#39;, &#39;2025-05-28T19:56:37.656Z :: stpipe.ExposurePipeline.tweakreg :: INFO ::  &#39;, &quot;2025-05-28T19:56:37.815Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Aligning image catalog &#39;GROUP ID: 987654&#39; to the reference catalog.&quot;, &quot;2025-05-28T19:56:37.849Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Matching sources from &#39;r0003201001001001004_0001_wfi01_f106_uncal&#39; catalog with sources from the reference &#39;Unnamed&#39; catalog.&quot;, &#39;2025-05-28T19:56:37.850Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Computing initial guess for X and Y shifts...&#39;, &#39;2025-05-28T19:56:37.855Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Found initial X and Y shifts of 0.01183, 0.01183 (arcsec) with significance of 1334 and 1400 matches.&#39;, &quot;2025-05-28T19:56:37.857Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Found 1399 matches for &#39;GROUP ID: 987654&#39;...&quot;, &quot;2025-05-28T19:56:37.858Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Performing &#39;rshift&#39; fit&quot;, &quot;2025-05-28T19:56:37.877Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Computed &#39;rshift&#39; fit for GROUP ID: 987654:&quot;, &#39;2025-05-28T19:56:37.877Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: XSH: -0.000195681  YSH: -3.85974e-05    ROT: -3.85507e-06    SCALE: 1&#39;, &#39;2025-05-28T19:56:37.878Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: &#39;, &#39;2025-05-28T19:56:37.878Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: FIT RMSE: 0.00196715   FIT MAE: 0.00169605&#39;, &#39;2025-05-28T19:56:37.879Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Final solution based on 1385 objects.&#39;, &#39;2025-05-28T19:56:37.907Z :: stpipe.ExposurePipeline.tweakreg :: INFO ::  &#39;, &#39;2025-05-28T19:56:37.908Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: ***** tweakwcs.imalign.align_wcs() ended on 2025-05-28 15:56:37.907564&#39;, &#39;2025-05-28T19:56:37.908Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: ***** tweakwcs.imalign.align_wcs() TOTAL RUN TIME: 0:00:00.252628&#39;, &#39;2025-05-28T19:56:37.908Z :: stpipe.ExposurePipeline.tweakreg :: INFO ::  &#39;, &#39;2025-05-28T19:56:37.913Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Update S_REGION to POLYGON ICRS  270.934669679 -0.225719501 270.934611821 -0.102755795 270.809021726 -0.102451279 270.809744086 -0.225310345&#39;, &#39;2025-05-28T19:56:37.913Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: S_REGION VALUES: POLYGON ICRS  270.934669679 -0.225719501 270.934611821 -0.102755795 270.809021726 -0.102451279 270.809744086 -0.225310345&#39;, &#39;2025-05-28T19:56:37.914Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Update S_REGION to POLYGON ICRS  270.934669679 -0.225719501 270.934611821 -0.102755795 270.809021726 -0.102451279 270.809744086 -0.225310345&#39;, &#39;2025-05-28T19:56:37.925Z :: stpipe.ExposurePipeline.tweakreg :: INFO :: Step tweakreg done&#39;, &#39;2025-05-28T19:56:37.926Z :: stpipe.ExposurePipeline :: INFO :: Roman exposure calibration pipeline ending...&#39;], &#39;cal_step&#39;: {&#39;dq_init&#39;: &#39;COMPLETE&#39;, &#39;saturation&#39;: &#39;COMPLETE&#39;, &#39;refpix&#39;: &#39;COMPLETE&#39;, &#39;linearity&#39;: &#39;COMPLETE&#39;, &#39;dark&#39;: &#39;COMPLETE&#39;, &#39;ramp_fit&#39;: &#39;COMPLETE&#39;, &#39;assign_wcs&#39;: &#39;COMPLETE&#39;, &#39;flat_field&#39;: &#39;COMPLETE&#39;, &#39;photom&#39;: &#39;COMPLETE&#39;, &#39;source_catalog&#39;: &#39;COMPLETE&#39;, &#39;tweakreg&#39;: &#39;COMPLETE&#39;, &#39;flux&#39;: &#39;INCOMPLETE&#39;, &#39;skymatch&#39;: &#39;INCOMPLETE&#39;, &#39;outlier_detection&#39;: &#39;INCOMPLETE&#39;}, &#39;calibration_software_name&#39;: &#39;RomanCAL&#39;, &#39;calibration_software_version&#39;: &#39;0.18.0&#39;, &#39;coordinates&#39;: {&#39;reference_frame&#39;: &#39;ICRS&#39;}, &#39;ephemeris&#39;: {&#39;earth_angle&#39;: -999999, &#39;moon_angle&#39;: -999999, &#39;sun_angle&#39;: -999999, &#39;type&#39;: &#39;DEFINITIVE&#39;, &#39;time&#39;: 61344.0, &#39;ephemeris_reference_frame&#39;: &#39;?&#39;, &#39;spatial_x&#39;: 118149303.92300647, &#39;spatial_y&#39;: 81710865.93471536, &#39;spatial_z&#39;: 35433691.335827544, &#39;velocity_x&#39;: -18.474060504144184, &#39;velocity_y&#39;: 21.671509956074864, &#39;velocity_z&#39;: 9.394886442040915}, &#39;exposure&#39;: {&#39;type&#39;: &#39;WFI_IMAGE&#39;, &#39;start_time&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2026-10-31T00:00:00.000&gt;, &#39;mid_time&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2026-10-31T00:00:25.840&gt;, &#39;end_time&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2026-10-31T00:00:51.680&gt;, &#39;nresultants&#39;: 5, &#39;data_problem&#39;: False, &#39;frame_time&#39;: 3.04, &#39;exposure_time&#39;: 51.68, &#39;effective_exposure_time&#39;: 45.6, &#39;ma_table_name&#39;: &#39;?&#39;, &#39;ma_table_number&#39;: 3, &#39;read_pattern&#39;: [[2], [5], [10], [16], [17]], &#39;truncated&#39;: False}, &#39;exptype&#39;: &#39;SCIENCE&#39;, &#39;file_date&#39;: &lt;FileDate object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2020-01-01T00:00:00.000&gt;, &#39;filename&#39;: &#39;r0003201001001001004_0001_wfi01_f106_cal.asdf&#39;, &#39;group_id&#39;: &#39;00032010010010010040001&#39;, &#39;guide_star&#39;: {&#39;guide_window_id&#39;: &#39;?&#39;, &#39;guide_mode&#39;: &#39;WSM-ACQ-2&#39;, &#39;data_start&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2020-01-01T00:00:00.000&gt;, &#39;data_end&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2020-01-01T01:00:00.000&gt;, &#39;window_xstart&#39;: -999999, &#39;window_ystart&#39;: -999999, &#39;window_xstop&#39;: -999999, &#39;window_ystop&#39;: -999999, &#39;window_xsize&#39;: 16, &#39;window_ysize&#39;: 16, &#39;guide_star_id&#39;: &#39;?&#39;, &#39;gsc_version&#39;: &#39;?&#39;, &#39;ra&#39;: -999999, &#39;dec&#39;: -999999, &#39;ra_uncertainty&#39;: -999999, &#39;dec_uncertainty&#39;: -999999, &#39;fgs_magnitude&#39;: -999999, &#39;fgs_magnitude_uncertainty&#39;: -999999, &#39;centroid_x&#39;: -999999, &#39;centroid_y&#39;: -999999, &#39;centroid_x_uncertainty&#39;: -999999, &#39;centroid_y_uncertainty&#39;: -999999, &#39;epoch&#39;: &#39;?&#39;, &#39;proper_motion_ra&#39;: -999999, &#39;proper_motion_dec&#39;: -999999, &#39;parallax&#39;: -999999, &#39;centroid_rms&#39;: -999999}, &#39;instrument&#39;: {&#39;detector&#39;: &#39;WFI01&#39;, &#39;optical_element&#39;: &#39;F106&#39;, &#39;name&#39;: &#39;WFI&#39;}, &#39;model_type&#39;: &#39;ImageModel&#39;, &#39;observation&#39;: {&#39;observation_id&#39;: &#39;00032010010010010040001&#39;, &#39;visit_id&#39;: &#39;0003201001001001004&#39;, &#39;program&#39;: 32, &#39;execution_plan&#39;: 1, &#39;pass&#39;: 1, &#39;segment&#39;: 1, &#39;observation&#39;: 1, &#39;visit&#39;: 4, &#39;visit_file_group&#39;: 1, &#39;visit_file_sequence&#39;: 1, &#39;visit_file_activity&#39;: &#39;01&#39;, &#39;exposure&#39;: 1}, &#39;origin&#39;: &#39;STSCI/SOC&#39;, &#39;photometry&#39;: {&#39;conversion_megajanskys&#39;: 0.7417487930165987, &#39;conversion_megajanskys_uncertainty&#39;: 0.028857321159254122, &#39;pixel_area&#39;: 2.8083389953727505e-13}, &#39;pointing&#39;: {&#39;ra_v1&#39;: 270.93999195229344, &#39;dec_v1&#39;: 0.2959999999347126, &#39;pa_v3&#39;: 59.99907035922454, &#39;target_aperture&#39;: &#39;WFI_CEN&#39;, &#39;target_ra&#39;: 270.94, &#39;target_dec&#39;: -0.2}, &#39;prd_version&#39;: &#39;8.8.8&#39;, &#39;product_type&#39;: &#39;l2&#39;, &#39;program&#39;: {&#39;title&#39;: &#39;?&#39;, &#39;investigator_name&#39;: &#39;?&#39;, &#39;category&#39;: &#39;?&#39;, &#39;subcategory&#39;: &#39;None&#39;, &#39;science_category&#39;: &#39;?&#39;, &#39;continuation_id&#39;: -999999}, &#39;rcs&#39;: {&#39;active&#39;: False, &#39;electronics&#39;: &#39;A&#39;, &#39;bank&#39;: &#39;1&#39;, &#39;led&#39;: &#39;1&#39;, &#39;counts&#39;: -999999}, &#39;ref_file&#39;: {&#39;area&#39;: &#39;N/A&#39;, &#39;crds&#39;: {&#39;context&#39;: &#39;roman_0027.pmap&#39;, &#39;version&#39;: &#39;12.1.4&#39;}, &#39;dark&#39;: &#39;crds://roman_wfi_dark_0444.asdf&#39;, &#39;distortion&#39;: &#39;crds://roman_wfi_distortion_0014.asdf&#39;, &#39;flat&#39;: &#39;crds://roman_wfi_flat_0175.asdf&#39;, &#39;gain&#39;: &#39;crds://roman_wfi_gain_0022.asdf&#39;, &#39;inverse_linearity&#39;: &#39;N/A&#39;, &#39;linearity&#39;: &#39;crds://roman_wfi_linearity_0003.asdf&#39;, &#39;mask&#39;: &#39;crds://roman_wfi_mask_0030.asdf&#39;, &#39;photom&#39;: &#39;crds://roman_wfi_photom_0040.asdf&#39;, &#39;readnoise&#39;: &#39;crds://roman_wfi_readnoise_0024.asdf&#39;, &#39;refpix&#39;: &#39;crds://roman_wfi_refpix_0013.asdf&#39;, &#39;saturation&#39;: &#39;crds://roman_wfi_saturation_0031.asdf&#39;}, &#39;sdf_software_version&#39;: &#39;7.7.7&#39;, &#39;source_catalog&#39;: {&#39;tweakreg_catalog_name&#39;: &#39;r0003201001001001004_0001_wfi01_f106_cat.asdf&#39;}, &#39;telescope&#39;: &#39;ROMAN&#39;, &#39;velocity_aberration&#39;: {&#39;ra_reference&#39;: 270.8719766359773, &#39;dec_reference&#39;: -0.16439949970729792, &#39;scale_factor&#39;: 1.0}, &#39;visit&#39;: {&#39;dither&#39;: {&#39;executed_pattern&#39;: [1, 2, 3, 4, 5, 6, 7, 8, 9], &#39;primary_name&#39;: None, &#39;subpixel_name&#39;: None}, &#39;engineering_quality&#39;: &#39;OK&#39;, &#39;pointing_engineering_source&#39;: &#39;CALCULATED&#39;, &#39;type&#39;: &#39;PRIME_TARGETED_FIXED&#39;, &#39;start_time&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2020-01-01T00:00:00.000&gt;, &#39;end_time&#39;: &lt;Time object: scale=&#39;utc&#39; format=&#39;isot&#39; value=2020-01-01T00:00:00.000&gt;, &#39;status&#39;: &#39;SUCCESSFUL&#39;, &#39;nexposures&#39;: -999999, &#39;internal_target&#39;: False}, &#39;wcs&#39;: &lt;WCS(output_frame=world, input_frame=detector, forward_transform=Model: CompoundModel
Inputs: (&#39;x0&#39;, &#39;x1&#39;)
Outputs: (&#39;lon&#39;, &#39;lat&#39;)
Model set size: 1
Expression: [0] &amp; [1] | [2] &amp; [3] | [4] | [5] &amp; [6] | [7] | [8] &amp; [9] | [10] &amp; [11] | [12] | [13] &amp; [14] | [15] | [16] | [17] / [18] | [19] | [20] | [21] | [22] &amp; [23] | [24] | [25] | [26] &amp; [27] | [28] &amp; [29] | [30] | [31] | [32]
Components: 
    [0]: &lt;Shift(offset=1.)&gt;

    [1]: &lt;Shift(offset=1.)&gt;

    [2]: &lt;Shift(offset=-2044.5)&gt;

    [3]: &lt;Shift(offset=-2044.5)&gt;

    [4]: &lt;Mapping((0, 1, 0, 1))&gt;

    [5]: &lt;Polynomial2D(5, c0_0=0., c1_0=0.11034133, c2_0=-0.00000003, c3_0=-0., c4_0=0., c5_0=-0., c0_1=0.00034168, c0_2=-0.00000001, c0_3=-0., c0_4=-0., c0_5=0., c1_1=0.00000014, c1_2=-0., c1_3=0., c1_4=0., c2_1=0., c2_2=-0., c2_3=-0., c3_1=0., c3_2=-0., c4_1=-0.)&gt;

    [6]: &lt;Polynomial2D(5, c0_0=0., c1_0=0.00031436, c2_0=0.00000007, c3_0=0., c4_0=0., c5_0=-0., c0_1=0.10828278, c0_2=0.00000021, c0_3=-0., c0_4=0., c0_5=0., c1_1=-0.00000002, c1_2=-0., c1_3=-0., c1_4=0., c2_1=-0., c2_2=-0., c2_3=0., c3_1=-0., c3_2=-0., c4_1=-0.)&gt;

    [7]: &lt;Mapping((0, 1, 0, 1))&gt;

    [8]: &lt;Polynomial2D(1, c0_0=0., c1_0=-0.5, c0_1=-0.8660254)&gt;

    [9]: &lt;Polynomial2D(1, c0_0=0., c1_0=-0.8660254, c0_1=0.5)&gt;

    [10]: &lt;Shift(offset=1312.94914525)&gt;

    [11]: &lt;Shift(offset=-1040.78537268)&gt;

    [12]: &lt;Identity(2)&gt;

    [13]: &lt;Scale(factor=0.00027778, name=&#39;arcsec_to_deg_1D&#39;)&gt;

    [14]: &lt;Scale(factor=0.00027778, name=&#39;arcsec_to_deg_1D&#39;)&gt;

    [15]: &lt;SphericalToCartesian(name=&#39;s2c&#39;)&gt;

    [16]: &lt;RotationSequence3D(angles=[ 0.3647081 ,  0.28910705, 59.99991239], name=&#39;det_to_optic_axis&#39;)&gt;

    [17]: &lt;Mapping((0, 1, 2), name=&#39;xyz&#39;)&gt;

    [18]: &lt;Mapping((0, 0, 0), name=&#39;xxx&#39;)&gt;

    [19]: &lt;Mapping((1, 2), name=&#39;xtyt&#39;)&gt;

    [20]: &lt;AffineTransformation2D(matrix=[[ 1.        , -0.00000007], [ 0.00000007,  1.        ]], translation=[-0., -0.], name=&#39;tp_affine&#39;)&gt;

    [21]: &lt;Mapping((0, 0, 1), name=&#39;xtyt2xyz&#39;)&gt;

    [22]: &lt;Const1D(amplitude=1., name=&#39;one&#39;)&gt;

    [23]: &lt;Identity(2, name=&#39;I(2D)&#39;)&gt;

    [24]: &lt;RotationSequence3D(angles=[-59.99991239,  -0.28910705,  -0.3647081 ], name=&#39;optic_axis_to_det&#39;)&gt;

    [25]: &lt;CartesianToSpherical(name=&#39;c2s&#39;)&gt;

    [26]: &lt;Scale(factor=3600., name=&#39;deg_to_arcsec_1D&#39;)&gt;

    [27]: &lt;Scale(factor=3600., name=&#39;deg_to_arcsec_1D&#39;)&gt;

    [28]: &lt;Scale(factor=0.00027778)&gt;

    [29]: &lt;Scale(factor=0.00027778)&gt;

    [30]: &lt;SphericalToCartesian()&gt;

    [31]: &lt;RotationSequence3D(angles=[   0.3647081 ,    0.28910705,   59.99991239,   -0.1643995 , -270.87197664])&gt;

    [32]: &lt;CartesianToSpherical()&gt;
Parameters:
    offset_0 offset_1 ...                angles_31                
    -------- -------- ... ----------------------------------------
         1.0      1.0 ... 0.3647080959023555 .. -270.8719766359773)&gt;, &#39;wcs_fit_results&#39;: {&#39;&lt;rot&gt;&#39;: -3.8550664171942765e-06, &#39;&lt;scale&gt;&#39;: 1.0, &#39;center&#39;: [-12.801315068075494, -1.6980423663712585], &#39;fitgeom&#39;: &#39;rshift&#39;, &#39;mae&#39;: 0.0016960513501491892, &#39;matrix&#39;: [[0.9999999999999978, -6.728360186310142e-08], [6.728360186310142e-08, 0.9999999999999978]], &#39;nmatches&#39;: 1399, &#39;proper&#39;: True, &#39;proper_rot&#39;: -3.8550664171942765e-06, &#39;rmse&#39;: 0.001967154556791072, &#39;rot&#39;: [-3.8550664171942765e-06, -3.8550664171942765e-06], &#39;scale&#39;: [1.0, 1.0], &#39;shift&#39;: [-0.00019568088161466573, -3.859739322089624e-05], &#39;skew&#39;: 0.0, &#39;status&#39;: &#39;SUCCESS&#39;}, &#39;wcsinfo&#39;: {&#39;aperture_name&#39;: &#39;WFI01_FULL&#39;, &#39;pa_aperture&#39;: 0.0, &#39;v2_ref&#39;: 1312.9491452484797, &#39;v3_ref&#39;: -1040.7853726755036, &#39;vparity&#39;: -1, &#39;v3yangle&#39;: -60.0, &#39;ra_ref&#39;: 270.8719766359773, &#39;dec_ref&#39;: -0.16439949970729792, &#39;roll_ref&#39;: 59.99991238605934, &#39;s_region&#39;: &#39;POLYGON ICRS  270.934669679 -0.225719501 270.934611821 -0.102755795 270.809021726 -0.102451279 270.809744086 -0.225310345&#39;}}, &#39;data&#39;: array([[0.3828592 , 0.7190066 , 0.57954526, ..., 0.82491654, 0.54798466,
        0.7596621 ],
       [0.48790407, 0.5191181 , 0.68121314, ..., 0.8290943 , 0.7378703 ,
        0.31645823],
       [0.65960026, 0.62473404, 0.7867249 , ..., 0.63130987, 0.67372173,
        0.56940955],
       ...,
       [0.69034207, 1.0855403 , 0.6050965 , ..., 0.75234616, 0.7595161 ,
        0.77993363],
       [0.66153103, 0.7590605 , 0.6202591 , ..., 0.6739805 , 0.33642223,
        0.6299567 ],
       [0.6038647 , 0.9196994 , 0.8665242 , ..., 0.        , 0.        ,
        0.55580723]], shape=(4088, 4088), dtype=float32), &#39;dq&#39;: array([[       0,        0,        0, ...,        0,        0,        0],
       [       0,        0,        0, ...,        0,        0,        0],
       [       0,        0,        0, ...,        0,        0,        0],
       ...,
       [       0,        0,        0, ..., 34612225,        0, 34612225],
       [       0,        0,        0, ..., 34612225,        0, 34612225],
       [       0,        0,        0, ..., 34612227, 33555459, 34612225]],
      shape=(4088, 4088), dtype=uint32), &#39;err&#39;: array([[0.18076347, 0.1723664 , 0.14663745, ..., 0.16203614, 0.1724748 ,
        0.14682001],
       [0.15614437, 0.15004104, 0.15475114, ..., 0.17499089, 0.1855512 ,
        0.15914412],
       [0.1706995 , 0.16785465, 0.17753504, ..., 0.16119657, 0.17525539,
        0.16452532],
       ...,
       [0.15044011, 0.20136106, 0.14482673, ..., 0.12686564, 0.16732948,
        0.12818322],
       [0.14897132, 0.15294914, 0.15559031, ..., 0.12026194, 0.16308452,
        0.12932767],
       [0.14247444, 0.17256524, 0.15560353, ..., 0.        , 0.        ,
        0.11925368]], shape=(4088, 4088), dtype=float32), &#39;var_poisson&#39;: array([[0.00404828, 0.00799189, 0.00625471, ..., 0.00939666, 0.00616588,
        0.00793944],
       [0.00527975, 0.00576931, 0.00754714, ..., 0.00966951, 0.00859934,
        0.00348371],
       [0.00726608, 0.00734757, 0.00842474, ..., 0.00709256, 0.00783981,
        0.00593649],
       ...,
       [0.00724078, 0.01226308, 0.00626863, ..., 0.00946943, 0.00827379,
        0.00981667],
       [0.00740875, 0.00796843, 0.0065686 , ..., 0.00848308, 0.00356838,
        0.00792898],
       [0.00652799, 0.00961783, 0.00962937, ..., 0.        , 0.        ,
        0.00704528]], shape=(4088, 4088), dtype=float32), &#39;var_rnoise&#39;: array([[0.02862715, 0.02171828, 0.01524783, ..., 0.01685905, 0.02358168,
        0.01361668],
       [0.01910131, 0.01674301, 0.01640077, ..., 0.02095231, 0.0258299 ,
        0.02184314],
       [0.02187224, 0.02082762, 0.02309395, ..., 0.01889177, 0.02287464,
        0.02113209],
       ...,
       [0.01539145, 0.02828319, 0.01470615, ..., 0.00662545, 0.01972537,
        0.00661427],
       [0.01478371, 0.01542501, 0.01763974, ..., 0.00597985, 0.02302819,
        0.00879667],
       [0.01377098, 0.02016093, 0.01458309, ..., 0.        , 0.        ,
        0.00717616]], shape=(4088, 4088), dtype=float32), &#39;var_flat&#39;: array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]], shape=(4088, 4088), dtype=float32), &#39;amp33&#39;: array([[[0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]],

       [[0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]],

       [[0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]],

       [[0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]],

       [[0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]]], shape=(5, 4096, 128), dtype=uint16), &#39;border_ref_pix_left&#39;: array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]]], shape=(5, 4096, 4), dtype=float32), &#39;border_ref_pix_right&#39;: array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        ...,
        [0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]]], shape=(5, 4096, 4), dtype=float32), &#39;border_ref_pix_top&#39;: array([[[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]]], shape=(5, 4, 4096), dtype=float32), &#39;border_ref_pix_bottom&#39;: array([[[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]]], shape=(5, 4, 4096), dtype=float32), &#39;dq_border_ref_pix_left&#39;: array([[2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648],
       ...,
       [2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648]],
      shape=(4096, 4), dtype=uint32), &#39;dq_border_ref_pix_right&#39;: array([[2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648],
       ...,
       [2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648],
       [2147483648, 2147483648, 2147483648, 2147483648]],
      shape=(4096, 4), dtype=uint32), &#39;dq_border_ref_pix_top&#39;: array([[2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648],
       [2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648],
       [2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648],
       [2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648]], shape=(4, 4096), dtype=uint32), &#39;dq_border_ref_pix_bottom&#39;: array([[2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648],
       [2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648],
       [2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648],
       [2147483648, 2147483648, 2147483648, ..., 2147483648, 2147483648,
        2147483648]], shape=(4, 4096), dtype=uint32)}}
</pre></div>
</div>
</div>
</div>
<p>For WFI ASDF files, the three high-level blocks are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">asdf_library</span></code>: It contains information about the <code class="docutils literal notranslate"><span class="pre">asdf</span></code> library used to create the file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">history</span></code>: It contains metadata information about the extensions used to create the file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">roman</span></code>: This block contains Roman data and metadata.</p></li>
</ul>
<p>Within the <code class="docutils literal notranslate"><span class="pre">roman</span></code> block, the <code class="docutils literal notranslate"><span class="pre">data</span></code> block contains the data, which corresponds to an uncalibrated ramp in L1 products, a calibrated rate image in L2 products, and a mosaic image in L3 products.</p>
<p>Other interesting data blocks are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">meta</span></code>: metadata information</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">err</span></code>: estimated uncertainties</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dq</span></code>: data quality flags</p></li>
</ul>
<p>For more information about these data blocks and Level 2 data products, please visit the <a class="reference external" href="https://roman-docs.stsci.edu/data-handbook-home/wfi-data-format/data-levels-and-products#DataLevelsandProducts-level2">RDox pages on data levels and products</a>.</p>
<p>We further showcase the usage of the <code class="docutils literal notranslate"><span class="pre">asdf</span></code> basic library below using a L1 file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asdf_file_uri_l1</span> <span class="o">=</span> <span class="n">asdf_dir_uri</span> <span class="o">+</span> <span class="s1">&#39;r0003201001001001004_0001_wfi01_f106_uncal.asdf&#39;</span>

<span class="k">with</span> <span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">asdf_file_uri_l1</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">asdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>root (AsdfObject)
├─asdf_library (Software)
│ ├─author (str): The ASDF Developers
│ ├─homepage (str): http://github.com/asdf-format/asdf
│ ├─name (str): asdf
│ └─version (str): 4.1.0
├─history (dict)
│ └─extensions (list) ...
├─roman (WfiScienceRaw) # Level 1 (L1) Uncalibrated Roman Wide Field
Instrument (WFI) Ramp Cube

│ ├─meta (dict) ...
│ ├─data (ndarray) # Science Data (DN) ...
│ └─amp33 (ndarray) # Amplifier 33 Reference Pixel Data (DN) ...
└─romanisim (dict)
  ├─drop_extra_dq (bool): True
  ├─filename (str): r0003201001001001004_0001_wfi01_f106_uncal.asdf
  ├─level (int): 1
  ├─persistence (dict) ...
  ├─simcatobj (ndarray) ...
  ├─simulate_reffiles (dict) ...
  ├─stpsf (bool): True
  ├─usecrds (bool): True
  ├─version (str): 0.8.0
  └─wcs (WCS)
Some nodes not shown.
</pre></div>
</div>
</div>
</div>
<p>Loading the data follows exactly the same procedure as above. When working with L1 data, notice that the <code class="docutils literal notranslate"><span class="pre">data</span></code> block is now a cube of size (N, 4096, 4096), where N is the number of resultants up-the-ramp. A resultant is either a single read or the arithmetic mean of multiple reads of the WFI detectors. The L1 data array also contains the 4-pixel reference pixel border that is trimmed during processing from L1 to L2. As previously mentioned, the L1 <code class="docutils literal notranslate"><span class="pre">data</span></code> array is in units of DN.</p>
<p>Let’s plot the value of a single pixel up-the-ramp:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Up-the-ramp samples for pixel 1000, 1000&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="s1">&#39;roman&#39;</span><span class="p">][</span><span class="s1">&#39;data&#39;</span><span class="p">][:,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Resultant number&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixel value [DN]&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/716f584de10ca489dc53b7e3ef7c6ced6486ac314dd8ae352b088ed6ac5d20bf.png" src="../../_images/716f584de10ca489dc53b7e3ef7c6ced6486ac314dd8ae352b088ed6ac5d20bf.png" />
</div>
</div>
<p>The L1 data array contains all the uncalibrated resultants that, after processing, yield the L2 rate images.</p>
<p>The ASDF tree shows another section of the file called <code class="docutils literal notranslate"><span class="pre">romanisim</span></code> that contains information about the simulation that created the L1 file. This section is not part of the datamodel definition in <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code>, therefore it cannot be accessed with the dot notation. Instead, we can access it, and any other additional information not stored by the datamodel definition, using the ASDF tree and bracket notation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;romanisim&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;drop_extra_dq&#39;: True,
 &#39;filename&#39;: &#39;r0003201001001001004_0001_wfi01_f106_uncal.asdf&#39;,
 &#39;level&#39;: 1,
 &#39;persistence&#39;: {&#39;A&#39;: 0.017,
  &#39;alpha&#39;: 0.045,
  &#39;dx&#39;: 50000.0,
  &#39;gamma&#39;: 1,
  &#39;index&#39;: array([    5920,     6201,     6202, ..., 16702999, 16703000, 16706403],
        shape=(9855,)),
  &#39;t&#39;: array([61344.00059815, 61344.00059815, 61344.00059815, ...,
         61344.00059815, 61344.00059815, 61344.00059815], shape=(9855,)),
  &#39;x&#39;: array([3203., 5999., 9530., ..., 3330., 3233., 4257.], shape=(9855,)),
  &#39;x0&#39;: 60000.0},
 &#39;simcatobj&#39;: array([(3251.983 , 4040.971 ,  21785.023, 0.35568213),
        (1823.7552, 2680.9565, 177165.3  , 0.5802121 ),
        (3233.524 , 1925.616 ,  37155.234, 0.17799616), ...,
        (2157.5808, 1560.2335,  60534.867, 0.03560209),
        (3014.4307, 1141.291 ,  40358.457, 0.03438997),
        (1880.8948, 2002.2448,  91580.14 , 0.03474903)],
       shape=(1745,), dtype=[(&#39;x&#39;, &#39;&lt;f4&#39;), (&#39;y&#39;, &#39;&lt;f4&#39;), (&#39;counts&#39;, &#39;&lt;f4&#39;), (&#39;time&#39;, &#39;&lt;f4&#39;)]),
 &#39;simulate_reffiles&#39;: {&#39;dark&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_dark_0444.asdf&#39;,
  &#39;distortion&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_distortion_0014.asdf&#39;,
  &#39;flat&#39;: None,
  &#39;gain&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_gain_0022.asdf&#39;,
  &#39;inverselinearity&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_inverselinearity_0017.asdf&#39;,
  &#39;linearity&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_linearity_0003.asdf&#39;,
  &#39;readnoise&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_readnoise_0024.asdf&#39;,
  &#39;saturation&#39;: &#39;/Users/desjard/refdata/crds/references/roman/wfi/roman_wfi_saturation_0031.asdf&#39;},
 &#39;stpsf&#39;: True,
 &#39;usecrds&#39;: True,
 &#39;version&#39;: &#39;0.8.0&#39;,
 &#39;wcs&#39;: &lt;WCS(output_frame=world, input_frame=detector, forward_transform=Model: CompoundModel
 Inputs: (&#39;x0&#39;, &#39;x1&#39;)
 Outputs: (&#39;lon&#39;, &#39;lat&#39;)
 Model set size: 1
 Expression: [0] &amp; [1] | [2] &amp; [3] | [4] | [5] &amp; [6] | [7] | [8] &amp; [9] | [10] &amp; [11] | [12] | [13] &amp; [14] | [15] | [16] | [17]
 Components: 
     [0]: &lt;Shift(offset=1.)&gt;
 
     [1]: &lt;Shift(offset=1.)&gt;
 
     [2]: &lt;Shift(offset=-2044.5)&gt;
 
     [3]: &lt;Shift(offset=-2044.5)&gt;
 
     [4]: &lt;Mapping((0, 1, 0, 1))&gt;
 
     [5]: &lt;Polynomial2D(5, c0_0=0., c1_0=0.11034133, c2_0=-0.00000003, c3_0=-0., c4_0=0., c5_0=-0., c0_1=0.00034168, c0_2=-0.00000001, c0_3=-0., c0_4=-0., c0_5=0., c1_1=0.00000014, c1_2=-0., c1_3=0., c1_4=0., c2_1=0., c2_2=-0., c2_3=-0., c3_1=0., c3_2=-0., c4_1=-0.)&gt;
 
     [6]: &lt;Polynomial2D(5, c0_0=0., c1_0=0.00031436, c2_0=0.00000007, c3_0=0., c4_0=0., c5_0=-0., c0_1=0.10828278, c0_2=0.00000021, c0_3=-0., c0_4=0., c0_5=0., c1_1=-0.00000002, c1_2=-0., c1_3=-0., c1_4=0., c2_1=-0., c2_2=-0., c2_3=0., c3_1=-0., c3_2=-0., c4_1=-0.)&gt;
 
     [7]: &lt;Mapping((0, 1, 0, 1))&gt;
 
     [8]: &lt;Polynomial2D(1, c0_0=0., c1_0=-0.5, c0_1=-0.8660254)&gt;
 
     [9]: &lt;Polynomial2D(1, c0_0=0., c1_0=-0.8660254, c0_1=0.5)&gt;
 
     [10]: &lt;Shift(offset=1312.94914525)&gt;
 
     [11]: &lt;Shift(offset=-1040.78537268)&gt;
 
     [12]: &lt;Identity(2)&gt;
 
     [13]: &lt;Scale(factor=0.00027778)&gt;
 
     [14]: &lt;Scale(factor=0.00027778)&gt;
 
     [15]: &lt;SphericalToCartesian()&gt;
 
     [16]: &lt;RotationSequence3D(angles=[   0.42955128,    0.24799768,   60.        ,   -0.2       , -270.94      ])&gt;
 
     [17]: &lt;CartesianToSpherical()&gt;
 Parameters:
     offset_0 offset_1 ...       factor_14                 angles_16           
     -------- -------- ... --------------------- ------------------------------
          1.0      1.0 ... 0.0002777777777777778 0.42955128282521254 .. -270.94)&gt;}
</pre></div>
</div>
</div>
</div>
<p>Similarly, we can access the previously mentioned history section of the file using the ASDF tree and bracket notation to find some package version information that may be useful to us. This includes, for example, the <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code> version used to create the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span><span class="o">.</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;extensions&#39;: [{&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/core/extensions/core-1.6.0&#39;,
   &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_standard&#39;, &#39;version&#39;: &#39;1.1.1&#39;},
   &#39;software&#39;: {&#39;name&#39;: &#39;asdf&#39;, &#39;version&#39;: &#39;4.1.0&#39;}},
  {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/astronomy/gwcs/extensions/gwcs-1.3.0&#39;,
   &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_wcs_schemas&#39;, &#39;version&#39;: &#39;0.4.0&#39;},
   &#39;software&#39;: {&#39;name&#39;: &#39;gwcs&#39;, &#39;version&#39;: &#39;0.22.1&#39;}},
  {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://astropy.org/astropy/extensions/units-1.0.0&#39;,
   &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;, &#39;version&#39;: &#39;0.7.1&#39;}},
  {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://stsci.edu/datamodels/roman/extensions/datamodels-1.0&#39;,
   &#39;manifest_software&#39;: {&#39;name&#39;: &#39;rad&#39;, &#39;version&#39;: &#39;0.23.1&#39;},
   &#39;software&#39;: {&#39;name&#39;: &#39;roman_datamodels&#39;, &#39;version&#39;: &#39;0.23.1&#39;}},
  {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/astronomy/coordinates/extensions/coordinates-1.0.0&#39;,
   &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_coordinates_schemas&#39;,
    &#39;version&#39;: &#39;0.3.0&#39;},
   &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;, &#39;version&#39;: &#39;0.7.1&#39;}},
  {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/astronomy/extensions/astronomy-1.0.0&#39;,
   &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_standard&#39;, &#39;version&#39;: &#39;1.1.1&#39;},
   &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;, &#39;version&#39;: &#39;0.7.1&#39;}},
  {&#39;extension_class&#39;: &#39;asdf.extension._manifest.ManifestExtension&#39;,
   &#39;extension_uri&#39;: &#39;asdf://asdf-format.org/transform/extensions/transform-1.6.0&#39;,
   &#39;manifest_software&#39;: {&#39;name&#39;: &#39;asdf_transform_schemas&#39;, &#39;version&#39;: &#39;0.5.0&#39;},
   &#39;software&#39;: {&#39;name&#39;: &#39;asdf-astropy&#39;, &#39;version&#39;: &#39;0.7.1&#39;}}]}
</pre></div>
</div>
</div>
</div>
<p>During Roman development, you may have an outdated version of a file that does not conform to the installed version of <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code>, but you may want to open the file anyway. This may be to just get something out of the file that you need, or you may want to try manually fixing the file to conform to the latest schema. In any case, you can still open the file with <code class="docutils literal notranslate"><span class="pre">asdf.open()</span></code> if you disable the schema validation like so:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">asdf_file_uri_l1</span> <span class="o">=</span> <span class="n">asdf_dir_uri</span> <span class="o">+</span> <span class="s1">&#39;r0003201001001001004_0001_wfi01_f106_uncal.asdf&#39;</span>

<span class="k">with</span> <span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">asdf_file_uri_l1</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fb</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">asdf</span><span class="o">.</span><span class="n">config_context</span><span class="p">()</span> <span class="k">as</span> <span class="n">cfg</span><span class="p">:</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">validate_on_read</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">af</span> <span class="o">=</span> <span class="n">asdf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fb</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that if your file does not conform to the installed version of <code class="docutils literal notranslate"><span class="pre">roman_datamodels</span></code>, then you will need to leave it as an <code class="docutils literal notranslate"><span class="pre">AsdfFile</span></code> object and not try to pass it to <code class="docutils literal notranslate"><span class="pre">roman_datamodels.open()</span></code>.</p>
</section>
<section id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Link to this heading">#</a></h2>
<p>For more information about Roman data products and additional resources please consider visiting the links below:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://roman-docs.stsci.edu/">Roman User Documentation – RDox</a></p></li>
<li><p><a class="reference external" href="https://archive.stsci.edu">MAST</a></p></li>
<li><p><a class="reference external" href="https://asdf.readthedocs.io/en/latest/">ASDF python API</a></p></li>
<li><p><a class="reference external" href="https://asdf-standard.readthedocs.io/">ASDF standard</a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Link to this heading">#</a></h2>
<p><strong>Author:</strong> Javier Sánchez, William Schultz, Tyler Desjardins</p>
<p><strong>Updated On:</strong> 2025-05-26</p>
<table width="100%" style="border:none; border-collapse:collapse;">
  <tr style="border:none;">
    <td style="border:none; width:180px; white-space:nowrap;">
       <a href="#top" style="text-decoration:none; color:#0066cc;">↑ Top of page</a> 
    </td>
    <td style="border:none; text-align:center;">
       <img src="../../roman_logo.png" width="50">
    </td>
    <td style="border:none; text-align:right;">
       <img src="../../stsci_logo2.png" width="90">
    </td>
  </tr>
</table></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "spacetelescope/roman_notebooks",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "roman-cal"
        },
        kernelOptions: {
            name: "roman-cal",
            path: "./notebooks/working_with_asdf"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'roman-cal'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../synphot/synphot.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Roman WFI Synthetic Photometry with synphot</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kernel-information-and-read-only-status">Kernel Information and Read-Only Status</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-start">Quick start</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exploring-metadata">Exploring metadata</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#taking-advantage-of-astropy-time-time-objects-in-the-metadata">Taking advantage of <code class="docutils literal notranslate"><span class="pre">astropy.time.Time</span></code> objects in the metadata</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-wcs-information">Accessing WCS Information</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-roman-data-using-the-asdf-library">Reading Roman data using the ASDF library</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-resources">Additional Resources</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#about-this-notebook">About this Notebook</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By STScI
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>